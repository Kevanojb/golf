function ig(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(s,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function ag(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gm={exports:{}},rc={},xm={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wo=Symbol.for("react.element"),og=Symbol.for("react.portal"),lg=Symbol.for("react.fragment"),cg=Symbol.for("react.strict_mode"),ug=Symbol.for("react.profiler"),dg=Symbol.for("react.provider"),hg=Symbol.for("react.context"),fg=Symbol.for("react.forward_ref"),mg=Symbol.for("react.suspense"),pg=Symbol.for("react.memo"),gg=Symbol.for("react.lazy"),Nh=Symbol.iterator;function xg(e){return e===null||typeof e!="object"?null:(e=Nh&&e[Nh]||e["@@iterator"],typeof e=="function"?e:null)}var bm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ym=Object.assign,vm={};function ua(e,t,r){this.props=e,this.context=t,this.refs=vm,this.updater=r||bm}ua.prototype.isReactComponent={};ua.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ua.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function wm(){}wm.prototype=ua.prototype;function bd(e,t,r){this.props=e,this.context=t,this.refs=vm,this.updater=r||bm}var yd=bd.prototype=new wm;yd.constructor=bd;ym(yd,ua.prototype);yd.isPureReactComponent=!0;var jh=Array.isArray,Nm=Object.prototype.hasOwnProperty,vd={current:null},jm={key:!0,ref:!0,__self:!0,__source:!0};function _m(e,t,r){var s,i={},a=null,o=null;if(t!=null)for(s in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Nm.call(t,s)&&!jm.hasOwnProperty(s)&&(i[s]=t[s]);var c=arguments.length-2;if(c===1)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(s in c=e.defaultProps,c)i[s]===void 0&&(i[s]=c[s]);return{$$typeof:wo,type:e,key:a,ref:o,props:i,_owner:vd.current}}function bg(e,t){return{$$typeof:wo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function wd(e){return typeof e=="object"&&e!==null&&e.$$typeof===wo}function yg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _h=/\/+/g;function kc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yg(""+e.key):t.toString(36)}function hl(e,t,r,s,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case wo:case og:o=!0}}if(o)return o=e,i=i(o),e=s===""?"."+kc(o,0):s,jh(i)?(r="",e!=null&&(r=e.replace(_h,"$&/")+"/"),hl(i,t,r,"",function(u){return u})):i!=null&&(wd(i)&&(i=bg(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(_h,"$&/")+"/")+e)),t.push(i)),1;if(o=0,s=s===""?".":s+":",jh(e))for(var c=0;c<e.length;c++){a=e[c];var l=s+kc(a,c);o+=hl(a,t,r,l,i)}else if(l=xg(e),typeof l=="function")for(e=l.call(e),c=0;!(a=e.next()).done;)a=a.value,l=s+kc(a,c++),o+=hl(a,t,r,l,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Bo(e,t,r){if(e==null)return e;var s=[],i=0;return hl(e,s,"","",function(a){return t.call(r,a,i++)}),s}function vg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rr={current:null},fl={transition:null},wg={ReactCurrentDispatcher:Rr,ReactCurrentBatchConfig:fl,ReactCurrentOwner:vd};function Sm(){throw Error("act(...) is not supported in production builds of React.")}Qe.Children={map:Bo,forEach:function(e,t,r){Bo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Bo(e,function(){t++}),t},toArray:function(e){return Bo(e,function(t){return t})||[]},only:function(e){if(!wd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Qe.Component=ua;Qe.Fragment=lg;Qe.Profiler=ug;Qe.PureComponent=bd;Qe.StrictMode=cg;Qe.Suspense=mg;Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wg;Qe.act=Sm;Qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=ym({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=vd.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)Nm.call(t,l)&&!jm.hasOwnProperty(l)&&(s[l]=t[l]===void 0&&c!==void 0?c[l]:t[l])}var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}return{$$typeof:wo,type:e.type,key:i,ref:a,props:s,_owner:o}};Qe.createContext=function(e){return e={$$typeof:hg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:dg,_context:e},e.Consumer=e};Qe.createElement=_m;Qe.createFactory=function(e){var t=_m.bind(null,e);return t.type=e,t};Qe.createRef=function(){return{current:null}};Qe.forwardRef=function(e){return{$$typeof:fg,render:e}};Qe.isValidElement=wd;Qe.lazy=function(e){return{$$typeof:gg,_payload:{_status:-1,_result:e},_init:vg}};Qe.memo=function(e,t){return{$$typeof:pg,type:e,compare:t===void 0?null:t}};Qe.startTransition=function(e){var t=fl.transition;fl.transition={};try{e()}finally{fl.transition=t}};Qe.unstable_act=Sm;Qe.useCallback=function(e,t){return Rr.current.useCallback(e,t)};Qe.useContext=function(e){return Rr.current.useContext(e)};Qe.useDebugValue=function(){};Qe.useDeferredValue=function(e){return Rr.current.useDeferredValue(e)};Qe.useEffect=function(e,t){return Rr.current.useEffect(e,t)};Qe.useId=function(){return Rr.current.useId()};Qe.useImperativeHandle=function(e,t,r){return Rr.current.useImperativeHandle(e,t,r)};Qe.useInsertionEffect=function(e,t){return Rr.current.useInsertionEffect(e,t)};Qe.useLayoutEffect=function(e,t){return Rr.current.useLayoutEffect(e,t)};Qe.useMemo=function(e,t){return Rr.current.useMemo(e,t)};Qe.useReducer=function(e,t,r){return Rr.current.useReducer(e,t,r)};Qe.useRef=function(e){return Rr.current.useRef(e)};Qe.useState=function(e){return Rr.current.useState(e)};Qe.useSyncExternalStore=function(e,t,r){return Rr.current.useSyncExternalStore(e,t,r)};Qe.useTransition=function(){return Rr.current.useTransition()};Qe.version="18.3.1";xm.exports=Qe;var Q=xm.exports;const ue=ag(Q),Ng=ig({__proto__:null,default:ue},[Q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jg=Q,_g=Symbol.for("react.element"),Sg=Symbol.for("react.fragment"),kg=Object.prototype.hasOwnProperty,Eg=jg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Pg={key:!0,ref:!0,__self:!0,__source:!0};function km(e,t,r){var s,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)kg.call(t,s)&&!Pg.hasOwnProperty(s)&&(i[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)i[s]===void 0&&(i[s]=t[s]);return{$$typeof:_g,type:e,key:a,ref:o,props:i,_owner:Eg.current}}rc.Fragment=Sg;rc.jsx=km;rc.jsxs=km;gm.exports=rc;var n=gm.exports,cu={},Em={exports:{}},rs={},Pm={exports:{}},Cm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,U){var D=R.length;R.push(U);e:for(;0<D;){var A=D-1>>>1,W=R[A];if(0<i(W,U))R[A]=U,R[D]=W,D=A;else break e}}function r(R){return R.length===0?null:R[0]}function s(R){if(R.length===0)return null;var U=R[0],D=R.pop();if(D!==U){R[0]=D;e:for(var A=0,W=R.length,Fe=W>>>1;A<Fe;){var de=2*(A+1)-1,oe=R[de],xe=de+1,Ye=R[xe];if(0>i(oe,D))xe<W&&0>i(Ye,oe)?(R[A]=Ye,R[xe]=D,A=xe):(R[A]=oe,R[de]=D,A=de);else if(xe<W&&0>i(Ye,D))R[A]=Ye,R[xe]=D,A=xe;else break e}}return U}function i(R,U){var D=R.sortIndex-U.sortIndex;return D!==0?D:R.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var l=[],u=[],d=1,x=null,h=3,p=!1,y=!1,w=!1,N=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(R){for(var U=r(u);U!==null;){if(U.callback===null)s(u);else if(U.startTime<=R)s(u),U.sortIndex=U.expirationTime,t(l,U);else break;U=r(u)}}function E(R){if(w=!1,v(R),!y)if(r(l)!==null)y=!0,ce(C);else{var U=r(u);U!==null&&$(E,U.startTime-R)}}function C(R,U){y=!1,w&&(w=!1,f(Y),Y=-1),p=!0;var D=h;try{for(v(U),x=r(l);x!==null&&(!(x.expirationTime>U)||R&&!De());){var A=x.callback;if(typeof A=="function"){x.callback=null,h=x.priorityLevel;var W=A(x.expirationTime<=U);U=e.unstable_now(),typeof W=="function"?x.callback=W:x===r(l)&&s(l),v(U)}else s(l);x=r(l)}if(x!==null)var Fe=!0;else{var de=r(u);de!==null&&$(E,de.startTime-U),Fe=!1}return Fe}finally{x=null,h=D,p=!1}}var T=!1,B=null,Y=-1,le=5,J=-1;function De(){return!(e.unstable_now()-J<le)}function nt(){if(B!==null){var R=e.unstable_now();J=R;var U=!0;try{U=B(!0,R)}finally{U?Ke():(T=!1,B=null)}}else T=!1}var Ke;if(typeof m=="function")Ke=function(){m(nt)};else if(typeof MessageChannel<"u"){var He=new MessageChannel,Ze=He.port2;He.port1.onmessage=nt,Ke=function(){Ze.postMessage(null)}}else Ke=function(){N(nt,0)};function ce(R){B=R,T||(T=!0,Ke())}function $(R,U){Y=N(function(){R(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){y||p||(y=!0,ce(C))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(R){switch(h){case 1:case 2:case 3:var U=3;break;default:U=h}var D=h;h=U;try{return R()}finally{h=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,U){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var D=h;h=R;try{return U()}finally{h=D}},e.unstable_scheduleCallback=function(R,U,D){var A=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?A+D:A):D=A,R){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=D+W,R={id:d++,callback:U,priorityLevel:R,startTime:D,expirationTime:W,sortIndex:-1},D>A?(R.sortIndex=D,t(u,R),r(l)===null&&R===r(u)&&(w?(f(Y),Y=-1):w=!0,$(E,D-A))):(R.sortIndex=W,t(l,R),y||p||(y=!0,ce(C))),R},e.unstable_shouldYield=De,e.unstable_wrapCallback=function(R){var U=h;return function(){var D=h;h=U;try{return R.apply(this,arguments)}finally{h=D}}}})(Cm);Pm.exports=Cm;var Cg=Pm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ag=Q,ts=Cg;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Am=new Set,Qa={};function ui(e,t){ta(e,t),ta(e+"Capture",t)}function ta(e,t){for(Qa[e]=t,e=0;e<t.length;e++)Am.add(t[e])}var rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uu=Object.prototype.hasOwnProperty,Rg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sh={},kh={};function Tg(e){return uu.call(kh,e)?!0:uu.call(Sh,e)?!1:Rg.test(e)?kh[e]=!0:(Sh[e]=!0,!1)}function Fg(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ig(e,t,r,s){if(t===null||typeof t>"u"||Fg(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Tr(e,t,r,s,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){br[e]=new Tr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];br[t]=new Tr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){br[e]=new Tr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){br[e]=new Tr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){br[e]=new Tr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){br[e]=new Tr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){br[e]=new Tr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){br[e]=new Tr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){br[e]=new Tr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Nd=/[\-:]([a-z])/g;function jd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Nd,jd);br[t]=new Tr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Nd,jd);br[t]=new Tr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Nd,jd);br[t]=new Tr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){br[e]=new Tr(e,1,!1,e.toLowerCase(),null,!1,!1)});br.xlinkHref=new Tr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){br[e]=new Tr(e,1,!1,e.toLowerCase(),null,!0,!0)});function _d(e,t,r,s){var i=br.hasOwnProperty(t)?br[t]:null;(i!==null?i.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ig(t,r,i,s)&&(r=null),s||i===null?Tg(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,s=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var ln=Ag.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ho=Symbol.for("react.element"),Fi=Symbol.for("react.portal"),Ii=Symbol.for("react.fragment"),Sd=Symbol.for("react.strict_mode"),du=Symbol.for("react.profiler"),Rm=Symbol.for("react.provider"),Tm=Symbol.for("react.context"),kd=Symbol.for("react.forward_ref"),hu=Symbol.for("react.suspense"),fu=Symbol.for("react.suspense_list"),Ed=Symbol.for("react.memo"),gn=Symbol.for("react.lazy"),Fm=Symbol.for("react.offscreen"),Eh=Symbol.iterator;function Ea(e){return e===null||typeof e!="object"?null:(e=Eh&&e[Eh]||e["@@iterator"],typeof e=="function"?e:null)}var Lt=Object.assign,Ec;function Oa(e){if(Ec===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ec=t&&t[1]||""}return`
`+Ec+e}var Pc=!1;function Cc(e,t){if(!e||Pc)return"";Pc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=s.stack.split(`
`),o=i.length-1,c=a.length-1;1<=o&&0<=c&&i[o]!==a[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==a[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==a[c]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=c);break}}}finally{Pc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Oa(e):""}function Og(e){switch(e.tag){case 5:return Oa(e.type);case 16:return Oa("Lazy");case 13:return Oa("Suspense");case 19:return Oa("SuspenseList");case 0:case 2:case 15:return e=Cc(e.type,!1),e;case 11:return e=Cc(e.type.render,!1),e;case 1:return e=Cc(e.type,!0),e;default:return""}}function mu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ii:return"Fragment";case Fi:return"Portal";case du:return"Profiler";case Sd:return"StrictMode";case hu:return"Suspense";case fu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Tm:return(e.displayName||"Context")+".Consumer";case Rm:return(e._context.displayName||"Context")+".Provider";case kd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ed:return t=e.displayName||null,t!==null?t:mu(e.type)||"Memo";case gn:t=e._payload,e=e._init;try{return mu(e(t))}catch{}}return null}function Dg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mu(t);case 8:return t===Sd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Tn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Im(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $g(e){var t=Im(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){s=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function zo(e){e._valueTracker||(e._valueTracker=$g(e))}function Om(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=Im(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function Sl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pu(e,t){var r=t.checked;return Lt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Ph(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=Tn(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Dm(e,t){t=t.checked,t!=null&&_d(e,"checked",t,!1)}function gu(e,t){Dm(e,t);var r=Tn(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xu(e,t.type,r):t.hasOwnProperty("defaultValue")&&xu(e,t.type,Tn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ch(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function xu(e,t,r){(t!=="number"||Sl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Da=Array.isArray;function Vi(e,t,r,s){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&s&&(e[r].defaultSelected=!0)}else{for(r=""+Tn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,s&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function bu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return Lt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ah(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(te(92));if(Da(r)){if(1<r.length)throw Error(te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Tn(r)}}function $m(e,t){var r=Tn(t.value),s=Tn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function Rh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Mm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Mm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qo,Lm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qo=qo||document.createElement("div"),qo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xa(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ua={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mg=["Webkit","ms","Moz","O"];Object.keys(Ua).forEach(function(e){Mg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ua[t]=Ua[e]})});function Um(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ua.hasOwnProperty(e)&&Ua[e]?(""+t).trim():t+"px"}function Bm(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,i=Um(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,i):e[r]=i}}var Lg=Lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vu(e,t){if(t){if(Lg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function wu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nu=null;function Pd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ju=null,Ki=null,Yi=null;function Th(e){if(e=_o(e)){if(typeof ju!="function")throw Error(te(280));var t=e.stateNode;t&&(t=oc(t),ju(e.stateNode,e.type,t))}}function Hm(e){Ki?Yi?Yi.push(e):Yi=[e]:Ki=e}function zm(){if(Ki){var e=Ki,t=Yi;if(Yi=Ki=null,Th(e),t)for(e=0;e<t.length;e++)Th(t[e])}}function qm(e,t){return e(t)}function Gm(){}var Ac=!1;function Wm(e,t,r){if(Ac)return e(t,r);Ac=!0;try{return qm(e,t,r)}finally{Ac=!1,(Ki!==null||Yi!==null)&&(Gm(),zm())}}function Za(e,t){var r=e.stateNode;if(r===null)return null;var s=oc(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,t,typeof r));return r}var _u=!1;if(rn)try{var Pa={};Object.defineProperty(Pa,"passive",{get:function(){_u=!0}}),window.addEventListener("test",Pa,Pa),window.removeEventListener("test",Pa,Pa)}catch{_u=!1}function Ug(e,t,r,s,i,a,o,c,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ba=!1,kl=null,El=!1,Su=null,Bg={onError:function(e){Ba=!0,kl=e}};function Hg(e,t,r,s,i,a,o,c,l){Ba=!1,kl=null,Ug.apply(Bg,arguments)}function zg(e,t,r,s,i,a,o,c,l){if(Hg.apply(this,arguments),Ba){if(Ba){var u=kl;Ba=!1,kl=null}else throw Error(te(198));El||(El=!0,Su=u)}}function di(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Vm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Fh(e){if(di(e)!==e)throw Error(te(188))}function qg(e){var t=e.alternate;if(!t){if(t=di(e),t===null)throw Error(te(188));return t!==e?null:e}for(var r=e,s=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(s=i.return,s!==null){r=s;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Fh(i),e;if(a===s)return Fh(i),t;a=a.sibling}throw Error(te(188))}if(r.return!==s.return)r=i,s=a;else{for(var o=!1,c=i.child;c;){if(c===r){o=!0,r=i,s=a;break}if(c===s){o=!0,s=i,r=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===r){o=!0,r=a,s=i;break}if(c===s){o=!0,s=a,r=i;break}c=c.sibling}if(!o)throw Error(te(189))}}if(r.alternate!==s)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:t}function Km(e){return e=qg(e),e!==null?Ym(e):null}function Ym(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ym(e);if(t!==null)return t;e=e.sibling}return null}var Jm=ts.unstable_scheduleCallback,Ih=ts.unstable_cancelCallback,Gg=ts.unstable_shouldYield,Wg=ts.unstable_requestPaint,qt=ts.unstable_now,Vg=ts.unstable_getCurrentPriorityLevel,Cd=ts.unstable_ImmediatePriority,Qm=ts.unstable_UserBlockingPriority,Pl=ts.unstable_NormalPriority,Kg=ts.unstable_LowPriority,Xm=ts.unstable_IdlePriority,sc=null,Bs=null;function Yg(e){if(Bs&&typeof Bs.onCommitFiberRoot=="function")try{Bs.onCommitFiberRoot(sc,e,void 0,(e.current.flags&128)===128)}catch{}}var As=Math.clz32?Math.clz32:Xg,Jg=Math.log,Qg=Math.LN2;function Xg(e){return e>>>=0,e===0?32:31-(Jg(e)/Qg|0)|0}var Go=64,Wo=4194304;function $a(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cl(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var c=o&~i;c!==0?s=$a(c):(a&=o,a!==0&&(s=$a(a)))}else o=r&~i,o!==0?s=$a(o):a!==0&&(s=$a(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&i)&&(i=s&-s,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-As(t),i=1<<r,s|=e[r],t&=~i;return s}function Zg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ex(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-As(a),c=1<<o,l=i[o];l===-1?(!(c&r)||c&s)&&(i[o]=Zg(c,t)):l<=t&&(e.expiredLanes|=c),a&=~c}}function ku(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Zm(){var e=Go;return Go<<=1,!(Go&4194240)&&(Go=64),e}function Rc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function No(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-As(t),e[t]=r}function tx(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-As(r),a=1<<i;t[i]=0,s[i]=-1,e[i]=-1,r&=~a}}function Ad(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-As(r),i=1<<s;i&t|e[s]&t&&(e[s]|=t),r&=~i}}var yt=0;function ep(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var tp,Rd,rp,sp,np,Eu=!1,Vo=[],_n=null,Sn=null,kn=null,eo=new Map,to=new Map,yn=[],rx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Oh(e,t){switch(e){case"focusin":case"focusout":_n=null;break;case"dragenter":case"dragleave":Sn=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":eo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":to.delete(t.pointerId)}}function Ca(e,t,r,s,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[i]},t!==null&&(t=_o(t),t!==null&&Rd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function sx(e,t,r,s,i){switch(t){case"focusin":return _n=Ca(_n,e,t,r,s,i),!0;case"dragenter":return Sn=Ca(Sn,e,t,r,s,i),!0;case"mouseover":return kn=Ca(kn,e,t,r,s,i),!0;case"pointerover":var a=i.pointerId;return eo.set(a,Ca(eo.get(a)||null,e,t,r,s,i)),!0;case"gotpointercapture":return a=i.pointerId,to.set(a,Ca(to.get(a)||null,e,t,r,s,i)),!0}return!1}function ip(e){var t=Xn(e.target);if(t!==null){var r=di(t);if(r!==null){if(t=r.tag,t===13){if(t=Vm(r),t!==null){e.blockedOn=t,np(e.priority,function(){rp(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ml(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Pu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);Nu=s,r.target.dispatchEvent(s),Nu=null}else return t=_o(r),t!==null&&Rd(t),e.blockedOn=r,!1;t.shift()}return!0}function Dh(e,t,r){ml(e)&&r.delete(t)}function nx(){Eu=!1,_n!==null&&ml(_n)&&(_n=null),Sn!==null&&ml(Sn)&&(Sn=null),kn!==null&&ml(kn)&&(kn=null),eo.forEach(Dh),to.forEach(Dh)}function Aa(e,t){e.blockedOn===t&&(e.blockedOn=null,Eu||(Eu=!0,ts.unstable_scheduleCallback(ts.unstable_NormalPriority,nx)))}function ro(e){function t(i){return Aa(i,e)}if(0<Vo.length){Aa(Vo[0],e);for(var r=1;r<Vo.length;r++){var s=Vo[r];s.blockedOn===e&&(s.blockedOn=null)}}for(_n!==null&&Aa(_n,e),Sn!==null&&Aa(Sn,e),kn!==null&&Aa(kn,e),eo.forEach(t),to.forEach(t),r=0;r<yn.length;r++)s=yn[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<yn.length&&(r=yn[0],r.blockedOn===null);)ip(r),r.blockedOn===null&&yn.shift()}var Ji=ln.ReactCurrentBatchConfig,Al=!0;function ix(e,t,r,s){var i=yt,a=Ji.transition;Ji.transition=null;try{yt=1,Td(e,t,r,s)}finally{yt=i,Ji.transition=a}}function ax(e,t,r,s){var i=yt,a=Ji.transition;Ji.transition=null;try{yt=4,Td(e,t,r,s)}finally{yt=i,Ji.transition=a}}function Td(e,t,r,s){if(Al){var i=Pu(e,t,r,s);if(i===null)Bc(e,t,s,Rl,r),Oh(e,s);else if(sx(i,e,t,r,s))s.stopPropagation();else if(Oh(e,s),t&4&&-1<rx.indexOf(e)){for(;i!==null;){var a=_o(i);if(a!==null&&tp(a),a=Pu(e,t,r,s),a===null&&Bc(e,t,s,Rl,r),a===i)break;i=a}i!==null&&s.stopPropagation()}else Bc(e,t,s,null,r)}}var Rl=null;function Pu(e,t,r,s){if(Rl=null,e=Pd(s),e=Xn(e),e!==null)if(t=di(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Vm(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Rl=e,null}function ap(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vg()){case Cd:return 1;case Qm:return 4;case Pl:case Kg:return 16;case Xm:return 536870912;default:return 16}default:return 16}}var Nn=null,Fd=null,pl=null;function op(){if(pl)return pl;var e,t=Fd,r=t.length,s,i="value"in Nn?Nn.value:Nn.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(s=1;s<=o&&t[r-s]===i[a-s];s++);return pl=i.slice(e,1<s?1-s:void 0)}function gl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ko(){return!0}function $h(){return!1}function ss(e){function t(r,s,i,a,o){this._reactName=r,this._targetInst=i,this.type=s,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(a):a[c]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ko:$h,this.isPropagationStopped=$h,this}return Lt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ko)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ko)},persist:function(){},isPersistent:Ko}),t}var da={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Id=ss(da),jo=Lt({},da,{view:0,detail:0}),ox=ss(jo),Tc,Fc,Ra,nc=Lt({},jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Od,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ra&&(Ra&&e.type==="mousemove"?(Tc=e.screenX-Ra.screenX,Fc=e.screenY-Ra.screenY):Fc=Tc=0,Ra=e),Tc)},movementY:function(e){return"movementY"in e?e.movementY:Fc}}),Mh=ss(nc),lx=Lt({},nc,{dataTransfer:0}),cx=ss(lx),ux=Lt({},jo,{relatedTarget:0}),Ic=ss(ux),dx=Lt({},da,{animationName:0,elapsedTime:0,pseudoElement:0}),hx=ss(dx),fx=Lt({},da,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),mx=ss(fx),px=Lt({},da,{data:0}),Lh=ss(px),gx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bx[e])?!!t[e]:!1}function Od(){return yx}var vx=Lt({},jo,{key:function(e){if(e.key){var t=gx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=gl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Od,charCode:function(e){return e.type==="keypress"?gl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?gl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wx=ss(vx),Nx=Lt({},nc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uh=ss(Nx),jx=Lt({},jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Od}),_x=ss(jx),Sx=Lt({},da,{propertyName:0,elapsedTime:0,pseudoElement:0}),kx=ss(Sx),Ex=Lt({},nc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Px=ss(Ex),Cx=[9,13,27,32],Dd=rn&&"CompositionEvent"in window,Ha=null;rn&&"documentMode"in document&&(Ha=document.documentMode);var Ax=rn&&"TextEvent"in window&&!Ha,lp=rn&&(!Dd||Ha&&8<Ha&&11>=Ha),Bh=" ",Hh=!1;function cp(e,t){switch(e){case"keyup":return Cx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function up(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Oi=!1;function Rx(e,t){switch(e){case"compositionend":return up(t);case"keypress":return t.which!==32?null:(Hh=!0,Bh);case"textInput":return e=t.data,e===Bh&&Hh?null:e;default:return null}}function Tx(e,t){if(Oi)return e==="compositionend"||!Dd&&cp(e,t)?(e=op(),pl=Fd=Nn=null,Oi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return lp&&t.locale!=="ko"?null:t.data;default:return null}}var Fx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Fx[e.type]:t==="textarea"}function dp(e,t,r,s){Hm(s),t=Tl(t,"onChange"),0<t.length&&(r=new Id("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var za=null,so=null;function Ix(e){Np(e,0)}function ic(e){var t=Mi(e);if(Om(t))return e}function Ox(e,t){if(e==="change")return t}var hp=!1;if(rn){var Oc;if(rn){var Dc="oninput"in document;if(!Dc){var qh=document.createElement("div");qh.setAttribute("oninput","return;"),Dc=typeof qh.oninput=="function"}Oc=Dc}else Oc=!1;hp=Oc&&(!document.documentMode||9<document.documentMode)}function Gh(){za&&(za.detachEvent("onpropertychange",fp),so=za=null)}function fp(e){if(e.propertyName==="value"&&ic(so)){var t=[];dp(t,so,e,Pd(e)),Wm(Ix,t)}}function Dx(e,t,r){e==="focusin"?(Gh(),za=t,so=r,za.attachEvent("onpropertychange",fp)):e==="focusout"&&Gh()}function $x(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ic(so)}function Mx(e,t){if(e==="click")return ic(t)}function Lx(e,t){if(e==="input"||e==="change")return ic(t)}function Ux(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ts=typeof Object.is=="function"?Object.is:Ux;function no(e,t){if(Ts(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var i=r[s];if(!uu.call(t,i)||!Ts(e[i],t[i]))return!1}return!0}function Wh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Vh(e,t){var r=Wh(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Wh(r)}}function mp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?mp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pp(){for(var e=window,t=Sl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Sl(e.document)}return t}function $d(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Bx(e){var t=pp(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&mp(r.ownerDocument.documentElement,r)){if(s!==null&&$d(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(s.start,i);s=s.end===void 0?a:Math.min(s.end,i),!e.extend&&a>s&&(i=s,s=a,a=i),i=Vh(r,a);var o=Vh(r,s);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Hx=rn&&"documentMode"in document&&11>=document.documentMode,Di=null,Cu=null,qa=null,Au=!1;function Kh(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Au||Di==null||Di!==Sl(s)||(s=Di,"selectionStart"in s&&$d(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),qa&&no(qa,s)||(qa=s,s=Tl(Cu,"onSelect"),0<s.length&&(t=new Id("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=Di)))}function Yo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var $i={animationend:Yo("Animation","AnimationEnd"),animationiteration:Yo("Animation","AnimationIteration"),animationstart:Yo("Animation","AnimationStart"),transitionend:Yo("Transition","TransitionEnd")},$c={},gp={};rn&&(gp=document.createElement("div").style,"AnimationEvent"in window||(delete $i.animationend.animation,delete $i.animationiteration.animation,delete $i.animationstart.animation),"TransitionEvent"in window||delete $i.transitionend.transition);function ac(e){if($c[e])return $c[e];if(!$i[e])return e;var t=$i[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in gp)return $c[e]=t[r];return e}var xp=ac("animationend"),bp=ac("animationiteration"),yp=ac("animationstart"),vp=ac("transitionend"),wp=new Map,Yh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(e,t){wp.set(e,t),ui(t,[e])}for(var Mc=0;Mc<Yh.length;Mc++){var Lc=Yh[Mc],zx=Lc.toLowerCase(),qx=Lc[0].toUpperCase()+Lc.slice(1);In(zx,"on"+qx)}In(xp,"onAnimationEnd");In(bp,"onAnimationIteration");In(yp,"onAnimationStart");In("dblclick","onDoubleClick");In("focusin","onFocus");In("focusout","onBlur");In(vp,"onTransitionEnd");ta("onMouseEnter",["mouseout","mouseover"]);ta("onMouseLeave",["mouseout","mouseover"]);ta("onPointerEnter",["pointerout","pointerover"]);ta("onPointerLeave",["pointerout","pointerover"]);ui("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ui("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ui("onBeforeInput",["compositionend","keypress","textInput","paste"]);ui("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ma));function Jh(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,zg(s,t,void 0,e),e.currentTarget=null}function Np(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],i=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var o=s.length-1;0<=o;o--){var c=s[o],l=c.instance,u=c.currentTarget;if(c=c.listener,l!==a&&i.isPropagationStopped())break e;Jh(i,c,u),a=l}else for(o=0;o<s.length;o++){if(c=s[o],l=c.instance,u=c.currentTarget,c=c.listener,l!==a&&i.isPropagationStopped())break e;Jh(i,c,u),a=l}}}if(El)throw e=Su,El=!1,Su=null,e}function Ct(e,t){var r=t[Ou];r===void 0&&(r=t[Ou]=new Set);var s=e+"__bubble";r.has(s)||(jp(t,e,2,!1),r.add(s))}function Uc(e,t,r){var s=0;t&&(s|=4),jp(r,e,s,t)}var Jo="_reactListening"+Math.random().toString(36).slice(2);function io(e){if(!e[Jo]){e[Jo]=!0,Am.forEach(function(r){r!=="selectionchange"&&(Gx.has(r)||Uc(r,!1,e),Uc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jo]||(t[Jo]=!0,Uc("selectionchange",!1,t))}}function jp(e,t,r,s){switch(ap(t)){case 1:var i=ix;break;case 4:i=ax;break;default:i=Td}r=i.bind(null,t,r,e),i=void 0,!_u||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),s?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Bc(e,t,r,s,i){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var c=s.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;c!==null;){if(o=Xn(c),o===null)return;if(l=o.tag,l===5||l===6){s=a=o;continue e}c=c.parentNode}}s=s.return}Wm(function(){var u=a,d=Pd(r),x=[];e:{var h=wp.get(e);if(h!==void 0){var p=Id,y=e;switch(e){case"keypress":if(gl(r)===0)break e;case"keydown":case"keyup":p=wx;break;case"focusin":y="focus",p=Ic;break;case"focusout":y="blur",p=Ic;break;case"beforeblur":case"afterblur":p=Ic;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Mh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=cx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=_x;break;case xp:case bp:case yp:p=hx;break;case vp:p=kx;break;case"scroll":p=ox;break;case"wheel":p=Px;break;case"copy":case"cut":case"paste":p=mx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Uh}var w=(t&4)!==0,N=!w&&e==="scroll",f=w?h!==null?h+"Capture":null:h;w=[];for(var m=u,v;m!==null;){v=m;var E=v.stateNode;if(v.tag===5&&E!==null&&(v=E,f!==null&&(E=Za(m,f),E!=null&&w.push(ao(m,E,v)))),N)break;m=m.return}0<w.length&&(h=new p(h,y,null,r,d),x.push({event:h,listeners:w}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Nu&&(y=r.relatedTarget||r.fromElement)&&(Xn(y)||y[sn]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(y=r.relatedTarget||r.toElement,p=u,y=y?Xn(y):null,y!==null&&(N=di(y),y!==N||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(w=Mh,E="onMouseLeave",f="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(w=Uh,E="onPointerLeave",f="onPointerEnter",m="pointer"),N=p==null?h:Mi(p),v=y==null?h:Mi(y),h=new w(E,m+"leave",p,r,d),h.target=N,h.relatedTarget=v,E=null,Xn(d)===u&&(w=new w(f,m+"enter",y,r,d),w.target=v,w.relatedTarget=N,E=w),N=E,p&&y)t:{for(w=p,f=y,m=0,v=w;v;v=wi(v))m++;for(v=0,E=f;E;E=wi(E))v++;for(;0<m-v;)w=wi(w),m--;for(;0<v-m;)f=wi(f),v--;for(;m--;){if(w===f||f!==null&&w===f.alternate)break t;w=wi(w),f=wi(f)}w=null}else w=null;p!==null&&Qh(x,h,p,w,!1),y!==null&&N!==null&&Qh(x,N,y,w,!0)}}e:{if(h=u?Mi(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var C=Ox;else if(zh(h))if(hp)C=Lx;else{C=$x;var T=Dx}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=Mx);if(C&&(C=C(e,u))){dp(x,C,r,d);break e}T&&T(e,h,u),e==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&xu(h,"number",h.value)}switch(T=u?Mi(u):window,e){case"focusin":(zh(T)||T.contentEditable==="true")&&(Di=T,Cu=u,qa=null);break;case"focusout":qa=Cu=Di=null;break;case"mousedown":Au=!0;break;case"contextmenu":case"mouseup":case"dragend":Au=!1,Kh(x,r,d);break;case"selectionchange":if(Hx)break;case"keydown":case"keyup":Kh(x,r,d)}var B;if(Dd)e:{switch(e){case"compositionstart":var Y="onCompositionStart";break e;case"compositionend":Y="onCompositionEnd";break e;case"compositionupdate":Y="onCompositionUpdate";break e}Y=void 0}else Oi?cp(e,r)&&(Y="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Y="onCompositionStart");Y&&(lp&&r.locale!=="ko"&&(Oi||Y!=="onCompositionStart"?Y==="onCompositionEnd"&&Oi&&(B=op()):(Nn=d,Fd="value"in Nn?Nn.value:Nn.textContent,Oi=!0)),T=Tl(u,Y),0<T.length&&(Y=new Lh(Y,e,null,r,d),x.push({event:Y,listeners:T}),B?Y.data=B:(B=up(r),B!==null&&(Y.data=B)))),(B=Ax?Rx(e,r):Tx(e,r))&&(u=Tl(u,"onBeforeInput"),0<u.length&&(d=new Lh("onBeforeInput","beforeinput",null,r,d),x.push({event:d,listeners:u}),d.data=B))}Np(x,t)})}function ao(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Tl(e,t){for(var r=t+"Capture",s=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Za(e,r),a!=null&&s.unshift(ao(e,a,i)),a=Za(e,t),a!=null&&s.push(ao(e,a,i))),e=e.return}return s}function wi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Qh(e,t,r,s,i){for(var a=t._reactName,o=[];r!==null&&r!==s;){var c=r,l=c.alternate,u=c.stateNode;if(l!==null&&l===s)break;c.tag===5&&u!==null&&(c=u,i?(l=Za(r,a),l!=null&&o.unshift(ao(r,l,c))):i||(l=Za(r,a),l!=null&&o.push(ao(r,l,c)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var Wx=/\r\n?/g,Vx=/\u0000|\uFFFD/g;function Xh(e){return(typeof e=="string"?e:""+e).replace(Wx,`
`).replace(Vx,"")}function Qo(e,t,r){if(t=Xh(t),Xh(e)!==t&&r)throw Error(te(425))}function Fl(){}var Ru=null,Tu=null;function Fu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Iu=typeof setTimeout=="function"?setTimeout:void 0,Kx=typeof clearTimeout=="function"?clearTimeout:void 0,Zh=typeof Promise=="function"?Promise:void 0,Yx=typeof queueMicrotask=="function"?queueMicrotask:typeof Zh<"u"?function(e){return Zh.resolve(null).then(e).catch(Jx)}:Iu;function Jx(e){setTimeout(function(){throw e})}function Hc(e,t){var r=t,s=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(s===0){e.removeChild(i),ro(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=i}while(r);ro(t)}function En(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ef(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),Ls="__reactFiber$"+ha,oo="__reactProps$"+ha,sn="__reactContainer$"+ha,Ou="__reactEvents$"+ha,Qx="__reactListeners$"+ha,Xx="__reactHandles$"+ha;function Xn(e){var t=e[Ls];if(t)return t;for(var r=e.parentNode;r;){if(t=r[sn]||r[Ls]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=ef(e);e!==null;){if(r=e[Ls])return r;e=ef(e)}return t}e=r,r=e.parentNode}return null}function _o(e){return e=e[Ls]||e[sn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Mi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function oc(e){return e[oo]||null}var Du=[],Li=-1;function On(e){return{current:e}}function At(e){0>Li||(e.current=Du[Li],Du[Li]=null,Li--)}function St(e,t){Li++,Du[Li]=e.current,e.current=t}var Fn={},Sr=On(Fn),Br=On(!1),ii=Fn;function ra(e,t){var r=e.type.contextTypes;if(!r)return Fn;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Hr(e){return e=e.childContextTypes,e!=null}function Il(){At(Br),At(Sr)}function tf(e,t,r){if(Sr.current!==Fn)throw Error(te(168));St(Sr,t),St(Br,r)}function _p(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var i in s)if(!(i in t))throw Error(te(108,Dg(e)||"Unknown",i));return Lt({},r,s)}function Ol(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fn,ii=Sr.current,St(Sr,e),St(Br,Br.current),!0}function rf(e,t,r){var s=e.stateNode;if(!s)throw Error(te(169));r?(e=_p(e,t,ii),s.__reactInternalMemoizedMergedChildContext=e,At(Br),At(Sr),St(Sr,e)):At(Br),St(Br,r)}var Js=null,lc=!1,zc=!1;function Sp(e){Js===null?Js=[e]:Js.push(e)}function Zx(e){lc=!0,Sp(e)}function Dn(){if(!zc&&Js!==null){zc=!0;var e=0,t=yt;try{var r=Js;for(yt=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}Js=null,lc=!1}catch(i){throw Js!==null&&(Js=Js.slice(e+1)),Jm(Cd,Dn),i}finally{yt=t,zc=!1}}return null}var Ui=[],Bi=0,Dl=null,$l=0,us=[],ds=0,ai=null,Xs=1,Zs="";function Vn(e,t){Ui[Bi++]=$l,Ui[Bi++]=Dl,Dl=e,$l=t}function kp(e,t,r){us[ds++]=Xs,us[ds++]=Zs,us[ds++]=ai,ai=e;var s=Xs;e=Zs;var i=32-As(s)-1;s&=~(1<<i),r+=1;var a=32-As(t)+i;if(30<a){var o=i-i%5;a=(s&(1<<o)-1).toString(32),s>>=o,i-=o,Xs=1<<32-As(t)+i|r<<i|s,Zs=a+e}else Xs=1<<a|r<<i|s,Zs=e}function Md(e){e.return!==null&&(Vn(e,1),kp(e,1,0))}function Ld(e){for(;e===Dl;)Dl=Ui[--Bi],Ui[Bi]=null,$l=Ui[--Bi],Ui[Bi]=null;for(;e===ai;)ai=us[--ds],us[ds]=null,Zs=us[--ds],us[ds]=null,Xs=us[--ds],us[ds]=null}var es=null,Zr=null,Ft=!1,Cs=null;function Ep(e,t){var r=hs(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function sf(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,es=e,Zr=En(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,es=e,Zr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ai!==null?{id:Xs,overflow:Zs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=hs(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,es=e,Zr=null,!0):!1;default:return!1}}function $u(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mu(e){if(Ft){var t=Zr;if(t){var r=t;if(!sf(e,t)){if($u(e))throw Error(te(418));t=En(r.nextSibling);var s=es;t&&sf(e,t)?Ep(s,r):(e.flags=e.flags&-4097|2,Ft=!1,es=e)}}else{if($u(e))throw Error(te(418));e.flags=e.flags&-4097|2,Ft=!1,es=e}}}function nf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;es=e}function Xo(e){if(e!==es)return!1;if(!Ft)return nf(e),Ft=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Fu(e.type,e.memoizedProps)),t&&(t=Zr)){if($u(e))throw Pp(),Error(te(418));for(;t;)Ep(e,t),t=En(t.nextSibling)}if(nf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Zr=En(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Zr=null}}else Zr=es?En(e.stateNode.nextSibling):null;return!0}function Pp(){for(var e=Zr;e;)e=En(e.nextSibling)}function sa(){Zr=es=null,Ft=!1}function Ud(e){Cs===null?Cs=[e]:Cs.push(e)}var eb=ln.ReactCurrentBatchConfig;function Ta(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var s=r.stateNode}if(!s)throw Error(te(147,e));var i=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var c=i.refs;o===null?delete c[a]:c[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function Zo(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function af(e){var t=e._init;return t(e._payload)}function Cp(e){function t(f,m){if(e){var v=f.deletions;v===null?(f.deletions=[m],f.flags|=16):v.push(m)}}function r(f,m){if(!e)return null;for(;m!==null;)t(f,m),m=m.sibling;return null}function s(f,m){for(f=new Map;m!==null;)m.key!==null?f.set(m.key,m):f.set(m.index,m),m=m.sibling;return f}function i(f,m){return f=Rn(f,m),f.index=0,f.sibling=null,f}function a(f,m,v){return f.index=v,e?(v=f.alternate,v!==null?(v=v.index,v<m?(f.flags|=2,m):v):(f.flags|=2,m)):(f.flags|=1048576,m)}function o(f){return e&&f.alternate===null&&(f.flags|=2),f}function c(f,m,v,E){return m===null||m.tag!==6?(m=Jc(v,f.mode,E),m.return=f,m):(m=i(m,v),m.return=f,m)}function l(f,m,v,E){var C=v.type;return C===Ii?d(f,m,v.props.children,E,v.key):m!==null&&(m.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===gn&&af(C)===m.type)?(E=i(m,v.props),E.ref=Ta(f,m,v),E.return=f,E):(E=jl(v.type,v.key,v.props,null,f.mode,E),E.ref=Ta(f,m,v),E.return=f,E)}function u(f,m,v,E){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=Qc(v,f.mode,E),m.return=f,m):(m=i(m,v.children||[]),m.return=f,m)}function d(f,m,v,E,C){return m===null||m.tag!==7?(m=ni(v,f.mode,E,C),m.return=f,m):(m=i(m,v),m.return=f,m)}function x(f,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Jc(""+m,f.mode,v),m.return=f,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ho:return v=jl(m.type,m.key,m.props,null,f.mode,v),v.ref=Ta(f,null,m),v.return=f,v;case Fi:return m=Qc(m,f.mode,v),m.return=f,m;case gn:var E=m._init;return x(f,E(m._payload),v)}if(Da(m)||Ea(m))return m=ni(m,f.mode,v,null),m.return=f,m;Zo(f,m)}return null}function h(f,m,v,E){var C=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return C!==null?null:c(f,m,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ho:return v.key===C?l(f,m,v,E):null;case Fi:return v.key===C?u(f,m,v,E):null;case gn:return C=v._init,h(f,m,C(v._payload),E)}if(Da(v)||Ea(v))return C!==null?null:d(f,m,v,E,null);Zo(f,v)}return null}function p(f,m,v,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return f=f.get(v)||null,c(m,f,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ho:return f=f.get(E.key===null?v:E.key)||null,l(m,f,E,C);case Fi:return f=f.get(E.key===null?v:E.key)||null,u(m,f,E,C);case gn:var T=E._init;return p(f,m,v,T(E._payload),C)}if(Da(E)||Ea(E))return f=f.get(v)||null,d(m,f,E,C,null);Zo(m,E)}return null}function y(f,m,v,E){for(var C=null,T=null,B=m,Y=m=0,le=null;B!==null&&Y<v.length;Y++){B.index>Y?(le=B,B=null):le=B.sibling;var J=h(f,B,v[Y],E);if(J===null){B===null&&(B=le);break}e&&B&&J.alternate===null&&t(f,B),m=a(J,m,Y),T===null?C=J:T.sibling=J,T=J,B=le}if(Y===v.length)return r(f,B),Ft&&Vn(f,Y),C;if(B===null){for(;Y<v.length;Y++)B=x(f,v[Y],E),B!==null&&(m=a(B,m,Y),T===null?C=B:T.sibling=B,T=B);return Ft&&Vn(f,Y),C}for(B=s(f,B);Y<v.length;Y++)le=p(B,f,Y,v[Y],E),le!==null&&(e&&le.alternate!==null&&B.delete(le.key===null?Y:le.key),m=a(le,m,Y),T===null?C=le:T.sibling=le,T=le);return e&&B.forEach(function(De){return t(f,De)}),Ft&&Vn(f,Y),C}function w(f,m,v,E){var C=Ea(v);if(typeof C!="function")throw Error(te(150));if(v=C.call(v),v==null)throw Error(te(151));for(var T=C=null,B=m,Y=m=0,le=null,J=v.next();B!==null&&!J.done;Y++,J=v.next()){B.index>Y?(le=B,B=null):le=B.sibling;var De=h(f,B,J.value,E);if(De===null){B===null&&(B=le);break}e&&B&&De.alternate===null&&t(f,B),m=a(De,m,Y),T===null?C=De:T.sibling=De,T=De,B=le}if(J.done)return r(f,B),Ft&&Vn(f,Y),C;if(B===null){for(;!J.done;Y++,J=v.next())J=x(f,J.value,E),J!==null&&(m=a(J,m,Y),T===null?C=J:T.sibling=J,T=J);return Ft&&Vn(f,Y),C}for(B=s(f,B);!J.done;Y++,J=v.next())J=p(B,f,Y,J.value,E),J!==null&&(e&&J.alternate!==null&&B.delete(J.key===null?Y:J.key),m=a(J,m,Y),T===null?C=J:T.sibling=J,T=J);return e&&B.forEach(function(nt){return t(f,nt)}),Ft&&Vn(f,Y),C}function N(f,m,v,E){if(typeof v=="object"&&v!==null&&v.type===Ii&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Ho:e:{for(var C=v.key,T=m;T!==null;){if(T.key===C){if(C=v.type,C===Ii){if(T.tag===7){r(f,T.sibling),m=i(T,v.props.children),m.return=f,f=m;break e}}else if(T.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===gn&&af(C)===T.type){r(f,T.sibling),m=i(T,v.props),m.ref=Ta(f,T,v),m.return=f,f=m;break e}r(f,T);break}else t(f,T);T=T.sibling}v.type===Ii?(m=ni(v.props.children,f.mode,E,v.key),m.return=f,f=m):(E=jl(v.type,v.key,v.props,null,f.mode,E),E.ref=Ta(f,m,v),E.return=f,f=E)}return o(f);case Fi:e:{for(T=v.key;m!==null;){if(m.key===T)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){r(f,m.sibling),m=i(m,v.children||[]),m.return=f,f=m;break e}else{r(f,m);break}else t(f,m);m=m.sibling}m=Qc(v,f.mode,E),m.return=f,f=m}return o(f);case gn:return T=v._init,N(f,m,T(v._payload),E)}if(Da(v))return y(f,m,v,E);if(Ea(v))return w(f,m,v,E);Zo(f,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(r(f,m.sibling),m=i(m,v),m.return=f,f=m):(r(f,m),m=Jc(v,f.mode,E),m.return=f,f=m),o(f)):r(f,m)}return N}var na=Cp(!0),Ap=Cp(!1),Ml=On(null),Ll=null,Hi=null,Bd=null;function Hd(){Bd=Hi=Ll=null}function zd(e){var t=Ml.current;At(Ml),e._currentValue=t}function Lu(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Qi(e,t){Ll=e,Bd=Hi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ur=!0),e.firstContext=null)}function ms(e){var t=e._currentValue;if(Bd!==e)if(e={context:e,memoizedValue:t,next:null},Hi===null){if(Ll===null)throw Error(te(308));Hi=e,Ll.dependencies={lanes:0,firstContext:e}}else Hi=Hi.next=e;return t}var Zn=null;function qd(e){Zn===null?Zn=[e]:Zn.push(e)}function Rp(e,t,r,s){var i=t.interleaved;return i===null?(r.next=r,qd(t)):(r.next=i.next,i.next=r),t.interleaved=r,nn(e,s)}function nn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var xn=!1;function Gd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function tn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Pn(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,st&2){var i=s.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),s.pending=t,nn(e,r)}return i=s.interleaved,i===null?(t.next=t,qd(s)):(t.next=i.next,i.next=t),s.interleaved=t,nn(e,r)}function xl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Ad(e,r)}}function of(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ul(e,t,r,s){var i=e.updateQueue;xn=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var l=c,u=l.next;l.next=null,o===null?a=u:o.next=u,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,c=d.lastBaseUpdate,c!==o&&(c===null?d.firstBaseUpdate=u:c.next=u,d.lastBaseUpdate=l))}if(a!==null){var x=i.baseState;o=0,d=u=l=null,c=a;do{var h=c.lane,p=c.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var y=e,w=c;switch(h=t,p=r,w.tag){case 1:if(y=w.payload,typeof y=="function"){x=y.call(p,x,h);break e}x=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,h=typeof y=="function"?y.call(p,x,h):y,h==null)break e;x=Lt({},x,h);break e;case 2:xn=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[c]:h.push(c))}else p={eventTime:p,lane:h,tag:c.tag,payload:c.payload,callback:c.callback,next:null},d===null?(u=d=p,l=x):d=d.next=p,o|=h;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;h=c,c=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(l=x),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);li|=o,e.lanes=o,e.memoizedState=x}}function lf(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],i=s.callback;if(i!==null){if(s.callback=null,s=r,typeof i!="function")throw Error(te(191,i));i.call(s)}}}var So={},Hs=On(So),lo=On(So),co=On(So);function ei(e){if(e===So)throw Error(te(174));return e}function Wd(e,t){switch(St(co,t),St(lo,e),St(Hs,So),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:yu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=yu(t,e)}At(Hs),St(Hs,t)}function ia(){At(Hs),At(lo),At(co)}function Fp(e){ei(co.current);var t=ei(Hs.current),r=yu(t,e.type);t!==r&&(St(lo,e),St(Hs,r))}function Vd(e){lo.current===e&&(At(Hs),At(lo))}var $t=On(0);function Bl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qc=[];function Kd(){for(var e=0;e<qc.length;e++)qc[e]._workInProgressVersionPrimary=null;qc.length=0}var bl=ln.ReactCurrentDispatcher,Gc=ln.ReactCurrentBatchConfig,oi=0,Mt=null,er=null,or=null,Hl=!1,Ga=!1,uo=0,tb=0;function Nr(){throw Error(te(321))}function Yd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ts(e[r],t[r]))return!1;return!0}function Jd(e,t,r,s,i,a){if(oi=a,Mt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bl.current=e===null||e.memoizedState===null?ib:ab,e=r(s,i),Ga){a=0;do{if(Ga=!1,uo=0,25<=a)throw Error(te(301));a+=1,or=er=null,t.updateQueue=null,bl.current=ob,e=r(s,i)}while(Ga)}if(bl.current=zl,t=er!==null&&er.next!==null,oi=0,or=er=Mt=null,Hl=!1,t)throw Error(te(300));return e}function Qd(){var e=uo!==0;return uo=0,e}function $s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?Mt.memoizedState=or=e:or=or.next=e,or}function ps(){if(er===null){var e=Mt.alternate;e=e!==null?e.memoizedState:null}else e=er.next;var t=or===null?Mt.memoizedState:or.next;if(t!==null)or=t,er=e;else{if(e===null)throw Error(te(310));er=e,e={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},or===null?Mt.memoizedState=or=e:or=or.next=e}return or}function ho(e,t){return typeof t=="function"?t(e):t}function Wc(e){var t=ps(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var s=er,i=s.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}s.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,s=s.baseState;var c=o=null,l=null,u=a;do{var d=u.lane;if((oi&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var x={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(c=l=x,o=s):l=l.next=x,Mt.lanes|=d,li|=d}u=u.next}while(u!==null&&u!==a);l===null?o=s:l.next=c,Ts(s,t.memoizedState)||(Ur=!0),t.memoizedState=s,t.baseState=o,t.baseQueue=l,r.lastRenderedState=s}if(e=r.interleaved,e!==null){i=e;do a=i.lane,Mt.lanes|=a,li|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vc(e){var t=ps(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var s=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Ts(a,t.memoizedState)||(Ur=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,s]}function Ip(){}function Op(e,t){var r=Mt,s=ps(),i=t(),a=!Ts(s.memoizedState,i);if(a&&(s.memoizedState=i,Ur=!0),s=s.queue,Xd(Mp.bind(null,r,s,e),[e]),s.getSnapshot!==t||a||or!==null&&or.memoizedState.tag&1){if(r.flags|=2048,fo(9,$p.bind(null,r,s,i,t),void 0,null),lr===null)throw Error(te(349));oi&30||Dp(r,t,i)}return i}function Dp(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function $p(e,t,r,s){t.value=r,t.getSnapshot=s,Lp(t)&&Up(e)}function Mp(e,t,r){return r(function(){Lp(t)&&Up(e)})}function Lp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ts(e,r)}catch{return!0}}function Up(e){var t=nn(e,1);t!==null&&Rs(t,e,1,-1)}function cf(e){var t=$s();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:e},t.queue=e,e=e.dispatch=nb.bind(null,Mt,e),[t.memoizedState,e]}function fo(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function Bp(){return ps().memoizedState}function yl(e,t,r,s){var i=$s();Mt.flags|=e,i.memoizedState=fo(1|t,r,void 0,s===void 0?null:s)}function cc(e,t,r,s){var i=ps();s=s===void 0?null:s;var a=void 0;if(er!==null){var o=er.memoizedState;if(a=o.destroy,s!==null&&Yd(s,o.deps)){i.memoizedState=fo(t,r,a,s);return}}Mt.flags|=e,i.memoizedState=fo(1|t,r,a,s)}function uf(e,t){return yl(8390656,8,e,t)}function Xd(e,t){return cc(2048,8,e,t)}function Hp(e,t){return cc(4,2,e,t)}function zp(e,t){return cc(4,4,e,t)}function qp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Gp(e,t,r){return r=r!=null?r.concat([e]):null,cc(4,4,qp.bind(null,t,e),r)}function Zd(){}function Wp(e,t){var r=ps();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&Yd(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function Vp(e,t){var r=ps();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&Yd(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function Kp(e,t,r){return oi&21?(Ts(r,t)||(r=Zm(),Mt.lanes|=r,li|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ur=!0),e.memoizedState=r)}function rb(e,t){var r=yt;yt=r!==0&&4>r?r:4,e(!0);var s=Gc.transition;Gc.transition={};try{e(!1),t()}finally{yt=r,Gc.transition=s}}function Yp(){return ps().memoizedState}function sb(e,t,r){var s=An(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},Jp(e))Qp(t,r);else if(r=Rp(e,t,r,s),r!==null){var i=Ar();Rs(r,e,s,i),Xp(r,t,s)}}function nb(e,t,r){var s=An(e),i={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(Jp(e))Qp(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,c=a(o,r);if(i.hasEagerState=!0,i.eagerState=c,Ts(c,o)){var l=t.interleaved;l===null?(i.next=i,qd(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=Rp(e,t,i,s),r!==null&&(i=Ar(),Rs(r,e,s,i),Xp(r,t,s))}}function Jp(e){var t=e.alternate;return e===Mt||t!==null&&t===Mt}function Qp(e,t){Ga=Hl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Xp(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Ad(e,r)}}var zl={readContext:ms,useCallback:Nr,useContext:Nr,useEffect:Nr,useImperativeHandle:Nr,useInsertionEffect:Nr,useLayoutEffect:Nr,useMemo:Nr,useReducer:Nr,useRef:Nr,useState:Nr,useDebugValue:Nr,useDeferredValue:Nr,useTransition:Nr,useMutableSource:Nr,useSyncExternalStore:Nr,useId:Nr,unstable_isNewReconciler:!1},ib={readContext:ms,useCallback:function(e,t){return $s().memoizedState=[e,t===void 0?null:t],e},useContext:ms,useEffect:uf,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,yl(4194308,4,qp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return yl(4194308,4,e,t)},useInsertionEffect:function(e,t){return yl(4,2,e,t)},useMemo:function(e,t){var r=$s();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=$s();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=sb.bind(null,Mt,e),[s.memoizedState,e]},useRef:function(e){var t=$s();return e={current:e},t.memoizedState=e},useState:cf,useDebugValue:Zd,useDeferredValue:function(e){return $s().memoizedState=e},useTransition:function(){var e=cf(!1),t=e[0];return e=rb.bind(null,e[1]),$s().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=Mt,i=$s();if(Ft){if(r===void 0)throw Error(te(407));r=r()}else{if(r=t(),lr===null)throw Error(te(349));oi&30||Dp(s,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,uf(Mp.bind(null,s,a,e),[e]),s.flags|=2048,fo(9,$p.bind(null,s,a,r,t),void 0,null),r},useId:function(){var e=$s(),t=lr.identifierPrefix;if(Ft){var r=Zs,s=Xs;r=(s&~(1<<32-As(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=uo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=tb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ab={readContext:ms,useCallback:Wp,useContext:ms,useEffect:Xd,useImperativeHandle:Gp,useInsertionEffect:Hp,useLayoutEffect:zp,useMemo:Vp,useReducer:Wc,useRef:Bp,useState:function(){return Wc(ho)},useDebugValue:Zd,useDeferredValue:function(e){var t=ps();return Kp(t,er.memoizedState,e)},useTransition:function(){var e=Wc(ho)[0],t=ps().memoizedState;return[e,t]},useMutableSource:Ip,useSyncExternalStore:Op,useId:Yp,unstable_isNewReconciler:!1},ob={readContext:ms,useCallback:Wp,useContext:ms,useEffect:Xd,useImperativeHandle:Gp,useInsertionEffect:Hp,useLayoutEffect:zp,useMemo:Vp,useReducer:Vc,useRef:Bp,useState:function(){return Vc(ho)},useDebugValue:Zd,useDeferredValue:function(e){var t=ps();return er===null?t.memoizedState=e:Kp(t,er.memoizedState,e)},useTransition:function(){var e=Vc(ho)[0],t=ps().memoizedState;return[e,t]},useMutableSource:Ip,useSyncExternalStore:Op,useId:Yp,unstable_isNewReconciler:!1};function Ss(e,t){if(e&&e.defaultProps){t=Lt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Uu(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Lt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var uc={isMounted:function(e){return(e=e._reactInternals)?di(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Ar(),i=An(e),a=tn(s,i);a.payload=t,r!=null&&(a.callback=r),t=Pn(e,a,i),t!==null&&(Rs(t,e,i,s),xl(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Ar(),i=An(e),a=tn(s,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Pn(e,a,i),t!==null&&(Rs(t,e,i,s),xl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ar(),s=An(e),i=tn(r,s);i.tag=2,t!=null&&(i.callback=t),t=Pn(e,i,s),t!==null&&(Rs(t,e,s,r),xl(t,e,s))}};function df(e,t,r,s,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,o):t.prototype&&t.prototype.isPureReactComponent?!no(r,s)||!no(i,a):!0}function Zp(e,t,r){var s=!1,i=Fn,a=t.contextType;return typeof a=="object"&&a!==null?a=ms(a):(i=Hr(t)?ii:Sr.current,s=t.contextTypes,a=(s=s!=null)?ra(e,i):Fn),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=uc,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function hf(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&uc.enqueueReplaceState(t,t.state,null)}function Bu(e,t,r,s){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Gd(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=ms(a):(a=Hr(t)?ii:Sr.current,i.context=ra(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Uu(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&uc.enqueueReplaceState(i,i.state,null),Ul(e,r,i,s),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function aa(e,t){try{var r="",s=t;do r+=Og(s),s=s.return;while(s);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Kc(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Hu(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var lb=typeof WeakMap=="function"?WeakMap:Map;function e0(e,t,r){r=tn(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){Gl||(Gl=!0,Xu=s),Hu(e,t)},r}function t0(e,t,r){r=tn(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var i=t.value;r.payload=function(){return s(i)},r.callback=function(){Hu(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Hu(e,t),typeof s!="function"&&(Cn===null?Cn=new Set([this]):Cn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function ff(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new lb;var i=new Set;s.set(t,i)}else i=s.get(t),i===void 0&&(i=new Set,s.set(t,i));i.has(r)||(i.add(r),e=Nb.bind(null,e,t,r),t.then(e,e))}function mf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function pf(e,t,r,s,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=tn(-1,1),t.tag=2,Pn(r,t,1))),r.lanes|=1),e)}var cb=ln.ReactCurrentOwner,Ur=!1;function Cr(e,t,r,s){t.child=e===null?Ap(t,null,r,s):na(t,e.child,r,s)}function gf(e,t,r,s,i){r=r.render;var a=t.ref;return Qi(t,i),s=Jd(e,t,r,s,a,i),r=Qd(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,an(e,t,i)):(Ft&&r&&Md(t),t.flags|=1,Cr(e,t,s,i),t.child)}function xf(e,t,r,s,i){if(e===null){var a=r.type;return typeof a=="function"&&!oh(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,r0(e,t,a,s,i)):(e=jl(r.type,null,s,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:no,r(o,s)&&e.ref===t.ref)return an(e,t,i)}return t.flags|=1,e=Rn(a,s),e.ref=t.ref,e.return=t,t.child=e}function r0(e,t,r,s,i){if(e!==null){var a=e.memoizedProps;if(no(a,s)&&e.ref===t.ref)if(Ur=!1,t.pendingProps=s=a,(e.lanes&i)!==0)e.flags&131072&&(Ur=!0);else return t.lanes=e.lanes,an(e,t,i)}return zu(e,t,r,s,i)}function s0(e,t,r){var s=t.pendingProps,i=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(qi,Jr),Jr|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,St(qi,Jr),Jr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,St(qi,Jr),Jr|=s}else a!==null?(s=a.baseLanes|r,t.memoizedState=null):s=r,St(qi,Jr),Jr|=s;return Cr(e,t,i,r),t.child}function n0(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function zu(e,t,r,s,i){var a=Hr(r)?ii:Sr.current;return a=ra(t,a),Qi(t,i),r=Jd(e,t,r,s,a,i),s=Qd(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,an(e,t,i)):(Ft&&s&&Md(t),t.flags|=1,Cr(e,t,r,i),t.child)}function bf(e,t,r,s,i){if(Hr(r)){var a=!0;Ol(t)}else a=!1;if(Qi(t,i),t.stateNode===null)vl(e,t),Zp(t,r,s),Bu(t,r,s,i),s=!0;else if(e===null){var o=t.stateNode,c=t.memoizedProps;o.props=c;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=ms(u):(u=Hr(r)?ii:Sr.current,u=ra(t,u));var d=r.getDerivedStateFromProps,x=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";x||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==s||l!==u)&&hf(t,o,s,u),xn=!1;var h=t.memoizedState;o.state=h,Ul(t,s,o,i),l=t.memoizedState,c!==s||h!==l||Br.current||xn?(typeof d=="function"&&(Uu(t,r,d,s),l=t.memoizedState),(c=xn||df(t,r,c,s,h,l,u))?(x||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=l),o.props=s,o.state=l,o.context=u,s=c):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,Tp(e,t),c=t.memoizedProps,u=t.type===t.elementType?c:Ss(t.type,c),o.props=u,x=t.pendingProps,h=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=ms(l):(l=Hr(r)?ii:Sr.current,l=ra(t,l));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==x||h!==l)&&hf(t,o,s,l),xn=!1,h=t.memoizedState,o.state=h,Ul(t,s,o,i);var y=t.memoizedState;c!==x||h!==y||Br.current||xn?(typeof p=="function"&&(Uu(t,r,p,s),y=t.memoizedState),(u=xn||df(t,r,u,s,h,y,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,y,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=y),o.props=s,o.state=y,o.context=l,s=u):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return qu(e,t,r,s,a,i)}function qu(e,t,r,s,i,a){n0(e,t);var o=(t.flags&128)!==0;if(!s&&!o)return i&&rf(t,r,!1),an(e,t,a);s=t.stateNode,cb.current=t;var c=o&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&o?(t.child=na(t,e.child,null,a),t.child=na(t,null,c,a)):Cr(e,t,c,a),t.memoizedState=s.state,i&&rf(t,r,!0),t.child}function i0(e){var t=e.stateNode;t.pendingContext?tf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tf(e,t.context,!1),Wd(e,t.containerInfo)}function yf(e,t,r,s,i){return sa(),Ud(i),t.flags|=256,Cr(e,t,r,s),t.child}var Gu={dehydrated:null,treeContext:null,retryLane:0};function Wu(e){return{baseLanes:e,cachePool:null,transitions:null}}function a0(e,t,r){var s=t.pendingProps,i=$t.current,a=!1,o=(t.flags&128)!==0,c;if((c=o)||(c=e!==null&&e.memoizedState===null?!1:(i&2)!==0),c?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),St($t,i&1),e===null)return Mu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=s.children,e=s.fallback,a?(s=t.mode,a=t.child,o={mode:"hidden",children:o},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=fc(o,s,0,null),e=ni(e,s,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Wu(r),t.memoizedState=Gu,e):eh(t,o));if(i=e.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return ub(e,t,o,s,c,i,r);if(a){a=s.fallback,o=t.mode,i=e.child,c=i.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&t.child!==i?(s=t.child,s.childLanes=0,s.pendingProps=l,t.deletions=null):(s=Rn(i,l),s.subtreeFlags=i.subtreeFlags&14680064),c!==null?a=Rn(c,a):(a=ni(a,o,r,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,o=e.child.memoizedState,o=o===null?Wu(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=Gu,s}return a=e.child,e=a.sibling,s=Rn(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function eh(e,t){return t=fc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function el(e,t,r,s){return s!==null&&Ud(s),na(t,e.child,null,r),e=eh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ub(e,t,r,s,i,a,o){if(r)return t.flags&256?(t.flags&=-257,s=Kc(Error(te(422))),el(e,t,o,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,i=t.mode,s=fc({mode:"visible",children:s.children},i,0,null),a=ni(a,i,o,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&na(t,e.child,null,o),t.child.memoizedState=Wu(o),t.memoizedState=Gu,a);if(!(t.mode&1))return el(e,t,o,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var c=s.dgst;return s=c,a=Error(te(419)),s=Kc(a,s,void 0),el(e,t,o,s)}if(c=(o&e.childLanes)!==0,Ur||c){if(s=lr,s!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,nn(e,i),Rs(s,e,i,-1))}return ah(),s=Kc(Error(te(421))),el(e,t,o,s)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=jb.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Zr=En(i.nextSibling),es=t,Ft=!0,Cs=null,e!==null&&(us[ds++]=Xs,us[ds++]=Zs,us[ds++]=ai,Xs=e.id,Zs=e.overflow,ai=t),t=eh(t,s.children),t.flags|=4096,t)}function vf(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Lu(e.return,t,r)}function Yc(e,t,r,s,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=i)}function o0(e,t,r){var s=t.pendingProps,i=s.revealOrder,a=s.tail;if(Cr(e,t,s.children,r),s=$t.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vf(e,r,t);else if(e.tag===19)vf(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(St($t,s),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Bl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Yc(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Bl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Yc(t,!0,r,null,a);break;case"together":Yc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function an(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),li|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,r=Rn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Rn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function db(e,t,r){switch(t.tag){case 3:i0(t),sa();break;case 5:Fp(t);break;case 1:Hr(t.type)&&Ol(t);break;case 4:Wd(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,i=t.memoizedProps.value;St(Ml,s._currentValue),s._currentValue=i;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(St($t,$t.current&1),t.flags|=128,null):r&t.child.childLanes?a0(e,t,r):(St($t,$t.current&1),e=an(e,t,r),e!==null?e.sibling:null);St($t,$t.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return o0(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),St($t,$t.current),s)break;return null;case 22:case 23:return t.lanes=0,s0(e,t,r)}return an(e,t,r)}var l0,Vu,c0,u0;l0=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Vu=function(){};c0=function(e,t,r,s){var i=e.memoizedProps;if(i!==s){e=t.stateNode,ei(Hs.current);var a=null;switch(r){case"input":i=pu(e,i),s=pu(e,s),a=[];break;case"select":i=Lt({},i,{value:void 0}),s=Lt({},s,{value:void 0}),a=[];break;case"textarea":i=bu(e,i),s=bu(e,s),a=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Fl)}vu(r,s);var o;r=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var c=i[u];for(o in c)c.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Qa.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in s){var l=s[u];if(c=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&l!==c&&(l!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,c=c?c.__html:void 0,l!=null&&c!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Qa.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ct("scroll",e),a||c===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};u0=function(e,t,r,s){r!==s&&(t.flags|=4)};function Fa(e,t){if(!Ft)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function jr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function hb(e,t,r){var s=t.pendingProps;switch(Ld(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jr(t),null;case 1:return Hr(t.type)&&Il(),jr(t),null;case 3:return s=t.stateNode,ia(),At(Br),At(Sr),Kd(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Xo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cs!==null&&(td(Cs),Cs=null))),Vu(e,t),jr(t),null;case 5:Vd(t);var i=ei(co.current);if(r=t.type,e!==null&&t.stateNode!=null)c0(e,t,r,s,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(te(166));return jr(t),null}if(e=ei(Hs.current),Xo(t)){s=t.stateNode,r=t.type;var a=t.memoizedProps;switch(s[Ls]=t,s[oo]=a,e=(t.mode&1)!==0,r){case"dialog":Ct("cancel",s),Ct("close",s);break;case"iframe":case"object":case"embed":Ct("load",s);break;case"video":case"audio":for(i=0;i<Ma.length;i++)Ct(Ma[i],s);break;case"source":Ct("error",s);break;case"img":case"image":case"link":Ct("error",s),Ct("load",s);break;case"details":Ct("toggle",s);break;case"input":Ph(s,a),Ct("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},Ct("invalid",s);break;case"textarea":Ah(s,a),Ct("invalid",s)}vu(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="children"?typeof c=="string"?s.textContent!==c&&(a.suppressHydrationWarning!==!0&&Qo(s.textContent,c,e),i=["children",c]):typeof c=="number"&&s.textContent!==""+c&&(a.suppressHydrationWarning!==!0&&Qo(s.textContent,c,e),i=["children",""+c]):Qa.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Ct("scroll",s)}switch(r){case"input":zo(s),Ch(s,a,!0);break;case"textarea":zo(s),Rh(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=Fl)}s=i,t.updateQueue=s,s!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Mm(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=o.createElement(r,{is:s.is}):(e=o.createElement(r),r==="select"&&(o=e,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):e=o.createElementNS(e,r),e[Ls]=t,e[oo]=s,l0(e,t,!1,!1),t.stateNode=e;e:{switch(o=wu(r,s),r){case"dialog":Ct("cancel",e),Ct("close",e),i=s;break;case"iframe":case"object":case"embed":Ct("load",e),i=s;break;case"video":case"audio":for(i=0;i<Ma.length;i++)Ct(Ma[i],e);i=s;break;case"source":Ct("error",e),i=s;break;case"img":case"image":case"link":Ct("error",e),Ct("load",e),i=s;break;case"details":Ct("toggle",e),i=s;break;case"input":Ph(e,s),i=pu(e,s),Ct("invalid",e);break;case"option":i=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},i=Lt({},s,{value:void 0}),Ct("invalid",e);break;case"textarea":Ah(e,s),i=bu(e,s),Ct("invalid",e);break;default:i=s}vu(r,i),c=i;for(a in c)if(c.hasOwnProperty(a)){var l=c[a];a==="style"?Bm(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Lm(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Xa(e,l):typeof l=="number"&&Xa(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Qa.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Ct("scroll",e):l!=null&&_d(e,a,l,o))}switch(r){case"input":zo(e),Ch(e,s,!1);break;case"textarea":zo(e),Rh(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Tn(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?Vi(e,!!s.multiple,a,!1):s.defaultValue!=null&&Vi(e,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Fl)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jr(t),null;case 6:if(e&&t.stateNode!=null)u0(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(te(166));if(r=ei(co.current),ei(Hs.current),Xo(t)){if(s=t.stateNode,r=t.memoizedProps,s[Ls]=t,(a=s.nodeValue!==r)&&(e=es,e!==null))switch(e.tag){case 3:Qo(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qo(s.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Ls]=t,t.stateNode=s}return jr(t),null;case 13:if(At($t),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ft&&Zr!==null&&t.mode&1&&!(t.flags&128))Pp(),sa(),t.flags|=98560,a=!1;else if(a=Xo(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(te(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(te(317));a[Ls]=t}else sa(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jr(t),a=!1}else Cs!==null&&(td(Cs),Cs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||$t.current&1?tr===0&&(tr=3):ah())),t.updateQueue!==null&&(t.flags|=4),jr(t),null);case 4:return ia(),Vu(e,t),e===null&&io(t.stateNode.containerInfo),jr(t),null;case 10:return zd(t.type._context),jr(t),null;case 17:return Hr(t.type)&&Il(),jr(t),null;case 19:if(At($t),a=t.memoizedState,a===null)return jr(t),null;if(s=(t.flags&128)!==0,o=a.rendering,o===null)if(s)Fa(a,!1);else{if(tr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Bl(e),o!==null){for(t.flags|=128,Fa(a,!1),s=o.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)a=r,e=s,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return St($t,$t.current&1|2),t.child}e=e.sibling}a.tail!==null&&qt()>oa&&(t.flags|=128,s=!0,Fa(a,!1),t.lanes=4194304)}else{if(!s)if(e=Bl(o),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Fa(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Ft)return jr(t),null}else 2*qt()-a.renderingStartTime>oa&&r!==1073741824&&(t.flags|=128,s=!0,Fa(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=qt(),t.sibling=null,r=$t.current,St($t,s?r&1|2:r&1),t):(jr(t),null);case 22:case 23:return ih(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Jr&1073741824&&(jr(t),t.subtreeFlags&6&&(t.flags|=8192)):jr(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function fb(e,t){switch(Ld(t),t.tag){case 1:return Hr(t.type)&&Il(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ia(),At(Br),At(Sr),Kd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Vd(t),null;case 13:if(At($t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));sa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return At($t),null;case 4:return ia(),null;case 10:return zd(t.type._context),null;case 22:case 23:return ih(),null;case 24:return null;default:return null}}var tl=!1,_r=!1,mb=typeof WeakSet=="function"?WeakSet:Set,_e=null;function zi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Ht(e,t,s)}else r.current=null}function Ku(e,t,r){try{r()}catch(s){Ht(e,t,s)}}var wf=!1;function pb(e,t){if(Ru=Al,e=pp(),$d(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var i=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,c=-1,l=-1,u=0,d=0,x=e,h=null;t:for(;;){for(var p;x!==r||i!==0&&x.nodeType!==3||(c=o+i),x!==a||s!==0&&x.nodeType!==3||(l=o+s),x.nodeType===3&&(o+=x.nodeValue.length),(p=x.firstChild)!==null;)h=x,x=p;for(;;){if(x===e)break t;if(h===r&&++u===i&&(c=o),h===a&&++d===s&&(l=o),(p=x.nextSibling)!==null)break;x=h,h=x.parentNode}x=p}r=c===-1||l===-1?null:{start:c,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Tu={focusedElem:e,selectionRange:r},Al=!1,_e=t;_e!==null;)if(t=_e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,_e=e;else for(;_e!==null;){t=_e;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,N=y.memoizedState,f=t.stateNode,m=f.getSnapshotBeforeUpdate(t.elementType===t.type?w:Ss(t.type,w),N);f.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(E){Ht(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,_e=e;break}_e=t.return}return y=wf,wf=!1,y}function Wa(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Ku(t,r,a)}i=i.next}while(i!==s)}}function dc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Yu(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function d0(e){var t=e.alternate;t!==null&&(e.alternate=null,d0(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ls],delete t[oo],delete t[Ou],delete t[Qx],delete t[Xx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function h0(e){return e.tag===5||e.tag===3||e.tag===4}function Nf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||h0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ju(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Fl));else if(s!==4&&(e=e.child,e!==null))for(Ju(e,t,r),e=e.sibling;e!==null;)Ju(e,t,r),e=e.sibling}function Qu(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Qu(e,t,r),e=e.sibling;e!==null;)Qu(e,t,r),e=e.sibling}var gr=null,Es=!1;function pn(e,t,r){for(r=r.child;r!==null;)f0(e,t,r),r=r.sibling}function f0(e,t,r){if(Bs&&typeof Bs.onCommitFiberUnmount=="function")try{Bs.onCommitFiberUnmount(sc,r)}catch{}switch(r.tag){case 5:_r||zi(r,t);case 6:var s=gr,i=Es;gr=null,pn(e,t,r),gr=s,Es=i,gr!==null&&(Es?(e=gr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):gr.removeChild(r.stateNode));break;case 18:gr!==null&&(Es?(e=gr,r=r.stateNode,e.nodeType===8?Hc(e.parentNode,r):e.nodeType===1&&Hc(e,r),ro(e)):Hc(gr,r.stateNode));break;case 4:s=gr,i=Es,gr=r.stateNode.containerInfo,Es=!0,pn(e,t,r),gr=s,Es=i;break;case 0:case 11:case 14:case 15:if(!_r&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Ku(r,t,o),i=i.next}while(i!==s)}pn(e,t,r);break;case 1:if(!_r&&(zi(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(c){Ht(r,t,c)}pn(e,t,r);break;case 21:pn(e,t,r);break;case 22:r.mode&1?(_r=(s=_r)||r.memoizedState!==null,pn(e,t,r),_r=s):pn(e,t,r);break;default:pn(e,t,r)}}function jf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new mb),t.forEach(function(s){var i=_b.bind(null,e,s);r.has(s)||(r.add(s),s.then(i,i))})}}function js(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var i=r[s];try{var a=e,o=t,c=o;e:for(;c!==null;){switch(c.tag){case 5:gr=c.stateNode,Es=!1;break e;case 3:gr=c.stateNode.containerInfo,Es=!0;break e;case 4:gr=c.stateNode.containerInfo,Es=!0;break e}c=c.return}if(gr===null)throw Error(te(160));f0(a,o,i),gr=null,Es=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Ht(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)m0(t,e),t=t.sibling}function m0(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(js(t,e),Ds(e),s&4){try{Wa(3,e,e.return),dc(3,e)}catch(w){Ht(e,e.return,w)}try{Wa(5,e,e.return)}catch(w){Ht(e,e.return,w)}}break;case 1:js(t,e),Ds(e),s&512&&r!==null&&zi(r,r.return);break;case 5:if(js(t,e),Ds(e),s&512&&r!==null&&zi(r,r.return),e.flags&32){var i=e.stateNode;try{Xa(i,"")}catch(w){Ht(e,e.return,w)}}if(s&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,c=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{c==="input"&&a.type==="radio"&&a.name!=null&&Dm(i,a),wu(c,o);var u=wu(c,a);for(o=0;o<l.length;o+=2){var d=l[o],x=l[o+1];d==="style"?Bm(i,x):d==="dangerouslySetInnerHTML"?Lm(i,x):d==="children"?Xa(i,x):_d(i,d,x,u)}switch(c){case"input":gu(i,a);break;case"textarea":$m(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Vi(i,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?Vi(i,!!a.multiple,a.defaultValue,!0):Vi(i,!!a.multiple,a.multiple?[]:"",!1))}i[oo]=a}catch(w){Ht(e,e.return,w)}}break;case 6:if(js(t,e),Ds(e),s&4){if(e.stateNode===null)throw Error(te(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(w){Ht(e,e.return,w)}}break;case 3:if(js(t,e),Ds(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{ro(t.containerInfo)}catch(w){Ht(e,e.return,w)}break;case 4:js(t,e),Ds(e);break;case 13:js(t,e),Ds(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(sh=qt())),s&4&&jf(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(_r=(u=_r)||d,js(t,e),_r=u):js(t,e),Ds(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(_e=e,d=e.child;d!==null;){for(x=_e=d;_e!==null;){switch(h=_e,p=h.child,h.tag){case 0:case 11:case 14:case 15:Wa(4,h,h.return);break;case 1:zi(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){s=h,r=h.return;try{t=s,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(w){Ht(s,r,w)}}break;case 5:zi(h,h.return);break;case 22:if(h.memoizedState!==null){Sf(x);continue}}p!==null?(p.return=h,_e=p):Sf(x)}d=d.sibling}e:for(d=null,x=e;;){if(x.tag===5){if(d===null){d=x;try{i=x.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(c=x.stateNode,l=x.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,c.style.display=Um("display",o))}catch(w){Ht(e,e.return,w)}}}else if(x.tag===6){if(d===null)try{x.stateNode.nodeValue=u?"":x.memoizedProps}catch(w){Ht(e,e.return,w)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===e)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===e)break e;for(;x.sibling===null;){if(x.return===null||x.return===e)break e;d===x&&(d=null),x=x.return}d===x&&(d=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:js(t,e),Ds(e),s&4&&jf(e);break;case 21:break;default:js(t,e),Ds(e)}}function Ds(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(h0(r)){var s=r;break e}r=r.return}throw Error(te(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(Xa(i,""),s.flags&=-33);var a=Nf(e);Qu(e,a,i);break;case 3:case 4:var o=s.stateNode.containerInfo,c=Nf(e);Ju(e,c,o);break;default:throw Error(te(161))}}catch(l){Ht(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function gb(e,t,r){_e=e,p0(e)}function p0(e,t,r){for(var s=(e.mode&1)!==0;_e!==null;){var i=_e,a=i.child;if(i.tag===22&&s){var o=i.memoizedState!==null||tl;if(!o){var c=i.alternate,l=c!==null&&c.memoizedState!==null||_r;c=tl;var u=_r;if(tl=o,(_r=l)&&!u)for(_e=i;_e!==null;)o=_e,l=o.child,o.tag===22&&o.memoizedState!==null?kf(i):l!==null?(l.return=o,_e=l):kf(i);for(;a!==null;)_e=a,p0(a),a=a.sibling;_e=i,tl=c,_r=u}_f(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,_e=a):_f(e)}}function _f(e){for(;_e!==null;){var t=_e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_r||dc(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!_r)if(r===null)s.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ss(t.type,r.memoizedProps);s.componentDidUpdate(i,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&lf(t,a,s);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}lf(t,o,r)}break;case 5:var c=t.stateNode;if(r===null&&t.flags&4){r=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var x=d.dehydrated;x!==null&&ro(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}_r||t.flags&512&&Yu(t)}catch(h){Ht(t,t.return,h)}}if(t===e){_e=null;break}if(r=t.sibling,r!==null){r.return=t.return,_e=r;break}_e=t.return}}function Sf(e){for(;_e!==null;){var t=_e;if(t===e){_e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,_e=r;break}_e=t.return}}function kf(e){for(;_e!==null;){var t=_e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{dc(4,t)}catch(l){Ht(t,r,l)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var i=t.return;try{s.componentDidMount()}catch(l){Ht(t,i,l)}}var a=t.return;try{Yu(t)}catch(l){Ht(t,a,l)}break;case 5:var o=t.return;try{Yu(t)}catch(l){Ht(t,o,l)}}}catch(l){Ht(t,t.return,l)}if(t===e){_e=null;break}var c=t.sibling;if(c!==null){c.return=t.return,_e=c;break}_e=t.return}}var xb=Math.ceil,ql=ln.ReactCurrentDispatcher,th=ln.ReactCurrentOwner,fs=ln.ReactCurrentBatchConfig,st=0,lr=null,Jt=null,xr=0,Jr=0,qi=On(0),tr=0,mo=null,li=0,hc=0,rh=0,Va=null,Lr=null,sh=0,oa=1/0,Ks=null,Gl=!1,Xu=null,Cn=null,rl=!1,jn=null,Wl=0,Ka=0,Zu=null,wl=-1,Nl=0;function Ar(){return st&6?qt():wl!==-1?wl:wl=qt()}function An(e){return e.mode&1?st&2&&xr!==0?xr&-xr:eb.transition!==null?(Nl===0&&(Nl=Zm()),Nl):(e=yt,e!==0||(e=window.event,e=e===void 0?16:ap(e.type)),e):1}function Rs(e,t,r,s){if(50<Ka)throw Ka=0,Zu=null,Error(te(185));No(e,r,s),(!(st&2)||e!==lr)&&(e===lr&&(!(st&2)&&(hc|=r),tr===4&&vn(e,xr)),zr(e,s),r===1&&st===0&&!(t.mode&1)&&(oa=qt()+500,lc&&Dn()))}function zr(e,t){var r=e.callbackNode;ex(e,t);var s=Cl(e,e===lr?xr:0);if(s===0)r!==null&&Ih(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&Ih(r),t===1)e.tag===0?Zx(Ef.bind(null,e)):Sp(Ef.bind(null,e)),Yx(function(){!(st&6)&&Dn()}),r=null;else{switch(ep(s)){case 1:r=Cd;break;case 4:r=Qm;break;case 16:r=Pl;break;case 536870912:r=Xm;break;default:r=Pl}r=j0(r,g0.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function g0(e,t){if(wl=-1,Nl=0,st&6)throw Error(te(327));var r=e.callbackNode;if(Xi()&&e.callbackNode!==r)return null;var s=Cl(e,e===lr?xr:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Vl(e,s);else{t=s;var i=st;st|=2;var a=b0();(lr!==e||xr!==t)&&(Ks=null,oa=qt()+500,si(e,t));do try{vb();break}catch(c){x0(e,c)}while(!0);Hd(),ql.current=a,st=i,Jt!==null?t=0:(lr=null,xr=0,t=tr)}if(t!==0){if(t===2&&(i=ku(e),i!==0&&(s=i,t=ed(e,i))),t===1)throw r=mo,si(e,0),vn(e,s),zr(e,qt()),r;if(t===6)vn(e,s);else{if(i=e.current.alternate,!(s&30)&&!bb(i)&&(t=Vl(e,s),t===2&&(a=ku(e),a!==0&&(s=a,t=ed(e,a))),t===1))throw r=mo,si(e,0),vn(e,s),zr(e,qt()),r;switch(e.finishedWork=i,e.finishedLanes=s,t){case 0:case 1:throw Error(te(345));case 2:Kn(e,Lr,Ks);break;case 3:if(vn(e,s),(s&130023424)===s&&(t=sh+500-qt(),10<t)){if(Cl(e,0)!==0)break;if(i=e.suspendedLanes,(i&s)!==s){Ar(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Iu(Kn.bind(null,e,Lr,Ks),t);break}Kn(e,Lr,Ks);break;case 4:if(vn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,i=-1;0<s;){var o=31-As(s);a=1<<o,o=t[o],o>i&&(i=o),s&=~a}if(s=i,s=qt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*xb(s/1960))-s,10<s){e.timeoutHandle=Iu(Kn.bind(null,e,Lr,Ks),s);break}Kn(e,Lr,Ks);break;case 5:Kn(e,Lr,Ks);break;default:throw Error(te(329))}}}return zr(e,qt()),e.callbackNode===r?g0.bind(null,e):null}function ed(e,t){var r=Va;return e.current.memoizedState.isDehydrated&&(si(e,t).flags|=256),e=Vl(e,t),e!==2&&(t=Lr,Lr=r,t!==null&&td(t)),e}function td(e){Lr===null?Lr=e:Lr.push.apply(Lr,e)}function bb(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var i=r[s],a=i.getSnapshot;i=i.value;try{if(!Ts(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function vn(e,t){for(t&=~rh,t&=~hc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-As(t),s=1<<r;e[r]=-1,t&=~s}}function Ef(e){if(st&6)throw Error(te(327));Xi();var t=Cl(e,0);if(!(t&1))return zr(e,qt()),null;var r=Vl(e,t);if(e.tag!==0&&r===2){var s=ku(e);s!==0&&(t=s,r=ed(e,s))}if(r===1)throw r=mo,si(e,0),vn(e,t),zr(e,qt()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Kn(e,Lr,Ks),zr(e,qt()),null}function nh(e,t){var r=st;st|=1;try{return e(t)}finally{st=r,st===0&&(oa=qt()+500,lc&&Dn())}}function ci(e){jn!==null&&jn.tag===0&&!(st&6)&&Xi();var t=st;st|=1;var r=fs.transition,s=yt;try{if(fs.transition=null,yt=1,e)return e()}finally{yt=s,fs.transition=r,st=t,!(st&6)&&Dn()}}function ih(){Jr=qi.current,At(qi)}function si(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Kx(r)),Jt!==null)for(r=Jt.return;r!==null;){var s=r;switch(Ld(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Il();break;case 3:ia(),At(Br),At(Sr),Kd();break;case 5:Vd(s);break;case 4:ia();break;case 13:At($t);break;case 19:At($t);break;case 10:zd(s.type._context);break;case 22:case 23:ih()}r=r.return}if(lr=e,Jt=e=Rn(e.current,null),xr=Jr=t,tr=0,mo=null,rh=hc=li=0,Lr=Va=null,Zn!==null){for(t=0;t<Zn.length;t++)if(r=Zn[t],s=r.interleaved,s!==null){r.interleaved=null;var i=s.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,s.next=o}r.pending=s}Zn=null}return e}function x0(e,t){do{var r=Jt;try{if(Hd(),bl.current=zl,Hl){for(var s=Mt.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Hl=!1}if(oi=0,or=er=Mt=null,Ga=!1,uo=0,th.current=null,r===null||r.return===null){tr=1,mo=t,Jt=null;break}e:{var a=e,o=r.return,c=r,l=t;if(t=xr,c.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=c,x=d.tag;if(!(d.mode&1)&&(x===0||x===11||x===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=mf(o);if(p!==null){p.flags&=-257,pf(p,o,c,a,t),p.mode&1&&ff(a,u,t),t=p,l=u;var y=t.updateQueue;if(y===null){var w=new Set;w.add(l),t.updateQueue=w}else y.add(l);break e}else{if(!(t&1)){ff(a,u,t),ah();break e}l=Error(te(426))}}else if(Ft&&c.mode&1){var N=mf(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),pf(N,o,c,a,t),Ud(aa(l,c));break e}}a=l=aa(l,c),tr!==4&&(tr=2),Va===null?Va=[a]:Va.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var f=e0(a,l,t);of(a,f);break e;case 1:c=l;var m=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Cn===null||!Cn.has(v)))){a.flags|=65536,t&=-t,a.lanes|=t;var E=t0(a,c,t);of(a,E);break e}}a=a.return}while(a!==null)}v0(r)}catch(C){t=C,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function b0(){var e=ql.current;return ql.current=zl,e===null?zl:e}function ah(){(tr===0||tr===3||tr===2)&&(tr=4),lr===null||!(li&268435455)&&!(hc&268435455)||vn(lr,xr)}function Vl(e,t){var r=st;st|=2;var s=b0();(lr!==e||xr!==t)&&(Ks=null,si(e,t));do try{yb();break}catch(i){x0(e,i)}while(!0);if(Hd(),st=r,ql.current=s,Jt!==null)throw Error(te(261));return lr=null,xr=0,tr}function yb(){for(;Jt!==null;)y0(Jt)}function vb(){for(;Jt!==null&&!Gg();)y0(Jt)}function y0(e){var t=N0(e.alternate,e,Jr);e.memoizedProps=e.pendingProps,t===null?v0(e):Jt=t,th.current=null}function v0(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fb(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tr=6,Jt=null;return}}else if(r=hb(r,t,Jr),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);tr===0&&(tr=5)}function Kn(e,t,r){var s=yt,i=fs.transition;try{fs.transition=null,yt=1,wb(e,t,r,s)}finally{fs.transition=i,yt=s}return null}function wb(e,t,r,s){do Xi();while(jn!==null);if(st&6)throw Error(te(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(tx(e,a),e===lr&&(Jt=lr=null,xr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||rl||(rl=!0,j0(Pl,function(){return Xi(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=fs.transition,fs.transition=null;var o=yt;yt=1;var c=st;st|=4,th.current=null,pb(e,r),m0(r,e),Bx(Tu),Al=!!Ru,Tu=Ru=null,e.current=r,gb(r),Wg(),st=c,yt=o,fs.transition=a}else e.current=r;if(rl&&(rl=!1,jn=e,Wl=i),a=e.pendingLanes,a===0&&(Cn=null),Yg(r.stateNode),zr(e,qt()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],s(i.value,{componentStack:i.stack,digest:i.digest});if(Gl)throw Gl=!1,e=Xu,Xu=null,e;return Wl&1&&e.tag!==0&&Xi(),a=e.pendingLanes,a&1?e===Zu?Ka++:(Ka=0,Zu=e):Ka=0,Dn(),null}function Xi(){if(jn!==null){var e=ep(Wl),t=fs.transition,r=yt;try{if(fs.transition=null,yt=16>e?16:e,jn===null)var s=!1;else{if(e=jn,jn=null,Wl=0,st&6)throw Error(te(331));var i=st;for(st|=4,_e=e.current;_e!==null;){var a=_e,o=a.child;if(_e.flags&16){var c=a.deletions;if(c!==null){for(var l=0;l<c.length;l++){var u=c[l];for(_e=u;_e!==null;){var d=_e;switch(d.tag){case 0:case 11:case 15:Wa(8,d,a)}var x=d.child;if(x!==null)x.return=d,_e=x;else for(;_e!==null;){d=_e;var h=d.sibling,p=d.return;if(d0(d),d===u){_e=null;break}if(h!==null){h.return=p,_e=h;break}_e=p}}}var y=a.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var N=w.sibling;w.sibling=null,w=N}while(w!==null)}}_e=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,_e=o;else e:for(;_e!==null;){if(a=_e,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Wa(9,a,a.return)}var f=a.sibling;if(f!==null){f.return=a.return,_e=f;break e}_e=a.return}}var m=e.current;for(_e=m;_e!==null;){o=_e;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,_e=v;else e:for(o=m;_e!==null;){if(c=_e,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:dc(9,c)}}catch(C){Ht(c,c.return,C)}if(c===o){_e=null;break e}var E=c.sibling;if(E!==null){E.return=c.return,_e=E;break e}_e=c.return}}if(st=i,Dn(),Bs&&typeof Bs.onPostCommitFiberRoot=="function")try{Bs.onPostCommitFiberRoot(sc,e)}catch{}s=!0}return s}finally{yt=r,fs.transition=t}}return!1}function Pf(e,t,r){t=aa(r,t),t=e0(e,t,1),e=Pn(e,t,1),t=Ar(),e!==null&&(No(e,1,t),zr(e,t))}function Ht(e,t,r){if(e.tag===3)Pf(e,e,r);else for(;t!==null;){if(t.tag===3){Pf(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Cn===null||!Cn.has(s))){e=aa(r,e),e=t0(t,e,1),t=Pn(t,e,1),e=Ar(),t!==null&&(No(t,1,e),zr(t,e));break}}t=t.return}}function Nb(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Ar(),e.pingedLanes|=e.suspendedLanes&r,lr===e&&(xr&r)===r&&(tr===4||tr===3&&(xr&130023424)===xr&&500>qt()-sh?si(e,0):rh|=r),zr(e,t)}function w0(e,t){t===0&&(e.mode&1?(t=Wo,Wo<<=1,!(Wo&130023424)&&(Wo=4194304)):t=1);var r=Ar();e=nn(e,t),e!==null&&(No(e,t,r),zr(e,r))}function jb(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),w0(e,r)}function _b(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(te(314))}s!==null&&s.delete(t),w0(e,r)}var N0;N0=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Br.current)Ur=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ur=!1,db(e,t,r);Ur=!!(e.flags&131072)}else Ur=!1,Ft&&t.flags&1048576&&kp(t,$l,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;vl(e,t),e=t.pendingProps;var i=ra(t,Sr.current);Qi(t,r),i=Jd(null,t,s,e,i,r);var a=Qd();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Hr(s)?(a=!0,Ol(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Gd(t),i.updater=uc,t.stateNode=i,i._reactInternals=t,Bu(t,s,e,r),t=qu(null,t,s,!0,a,r)):(t.tag=0,Ft&&a&&Md(t),Cr(null,t,i,r),t=t.child),t;case 16:s=t.elementType;e:{switch(vl(e,t),e=t.pendingProps,i=s._init,s=i(s._payload),t.type=s,i=t.tag=kb(s),e=Ss(s,e),i){case 0:t=zu(null,t,s,e,r);break e;case 1:t=bf(null,t,s,e,r);break e;case 11:t=gf(null,t,s,e,r);break e;case 14:t=xf(null,t,s,Ss(s.type,e),r);break e}throw Error(te(306,s,""))}return t;case 0:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Ss(s,i),zu(e,t,s,i,r);case 1:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Ss(s,i),bf(e,t,s,i,r);case 3:e:{if(i0(t),e===null)throw Error(te(387));s=t.pendingProps,a=t.memoizedState,i=a.element,Tp(e,t),Ul(t,s,null,r);var o=t.memoizedState;if(s=o.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=aa(Error(te(423)),t),t=yf(e,t,s,r,i);break e}else if(s!==i){i=aa(Error(te(424)),t),t=yf(e,t,s,r,i);break e}else for(Zr=En(t.stateNode.containerInfo.firstChild),es=t,Ft=!0,Cs=null,r=Ap(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(sa(),s===i){t=an(e,t,r);break e}Cr(e,t,s,r)}t=t.child}return t;case 5:return Fp(t),e===null&&Mu(t),s=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Fu(s,i)?o=null:a!==null&&Fu(s,a)&&(t.flags|=32),n0(e,t),Cr(e,t,o,r),t.child;case 6:return e===null&&Mu(t),null;case 13:return a0(e,t,r);case 4:return Wd(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=na(t,null,s,r):Cr(e,t,s,r),t.child;case 11:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Ss(s,i),gf(e,t,s,i,r);case 7:return Cr(e,t,t.pendingProps,r),t.child;case 8:return Cr(e,t,t.pendingProps.children,r),t.child;case 12:return Cr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,St(Ml,s._currentValue),s._currentValue=o,a!==null)if(Ts(a.value,o)){if(a.children===i.children&&!Br.current){t=an(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var c=a.dependencies;if(c!==null){o=a.child;for(var l=c.firstContext;l!==null;){if(l.context===s){if(a.tag===1){l=tn(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Lu(a.return,r,t),c.lanes|=r;break}l=l.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(te(341));o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),Lu(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Cr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,s=t.pendingProps.children,Qi(t,r),i=ms(i),s=s(i),t.flags|=1,Cr(e,t,s,r),t.child;case 14:return s=t.type,i=Ss(s,t.pendingProps),i=Ss(s.type,i),xf(e,t,s,i,r);case 15:return r0(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Ss(s,i),vl(e,t),t.tag=1,Hr(s)?(e=!0,Ol(t)):e=!1,Qi(t,r),Zp(t,s,i),Bu(t,s,i,r),qu(null,t,s,!0,e,r);case 19:return o0(e,t,r);case 22:return s0(e,t,r)}throw Error(te(156,t.tag))};function j0(e,t){return Jm(e,t)}function Sb(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hs(e,t,r,s){return new Sb(e,t,r,s)}function oh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kb(e){if(typeof e=="function")return oh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===kd)return 11;if(e===Ed)return 14}return 2}function Rn(e,t){var r=e.alternate;return r===null?(r=hs(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function jl(e,t,r,s,i,a){var o=2;if(s=e,typeof e=="function")oh(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ii:return ni(r.children,i,a,t);case Sd:o=8,i|=8;break;case du:return e=hs(12,r,t,i|2),e.elementType=du,e.lanes=a,e;case hu:return e=hs(13,r,t,i),e.elementType=hu,e.lanes=a,e;case fu:return e=hs(19,r,t,i),e.elementType=fu,e.lanes=a,e;case Fm:return fc(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Rm:o=10;break e;case Tm:o=9;break e;case kd:o=11;break e;case Ed:o=14;break e;case gn:o=16,s=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=hs(o,r,t,i),t.elementType=e,t.type=s,t.lanes=a,t}function ni(e,t,r,s){return e=hs(7,e,s,t),e.lanes=r,e}function fc(e,t,r,s){return e=hs(22,e,s,t),e.elementType=Fm,e.lanes=r,e.stateNode={isHidden:!1},e}function Jc(e,t,r){return e=hs(6,e,null,t),e.lanes=r,e}function Qc(e,t,r){return t=hs(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Eb(e,t,r,s,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rc(0),this.expirationTimes=Rc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rc(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function lh(e,t,r,s,i,a,o,c,l){return e=new Eb(e,t,r,c,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=hs(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gd(a),e}function Pb(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fi,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function _0(e){if(!e)return Fn;e=e._reactInternals;e:{if(di(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Hr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(Hr(r))return _p(e,r,t)}return t}function S0(e,t,r,s,i,a,o,c,l){return e=lh(r,s,!0,e,i,a,o,c,l),e.context=_0(null),r=e.current,s=Ar(),i=An(r),a=tn(s,i),a.callback=t??null,Pn(r,a,i),e.current.lanes=i,No(e,i,s),zr(e,s),e}function mc(e,t,r,s){var i=t.current,a=Ar(),o=An(i);return r=_0(r),t.context===null?t.context=r:t.pendingContext=r,t=tn(a,o),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Pn(i,t,o),e!==null&&(Rs(e,i,o,a),xl(e,i,o)),o}function Kl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Cf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function ch(e,t){Cf(e,t),(e=e.alternate)&&Cf(e,t)}function Cb(){return null}var k0=typeof reportError=="function"?reportError:function(e){console.error(e)};function uh(e){this._internalRoot=e}pc.prototype.render=uh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));mc(e,t,null,null)};pc.prototype.unmount=uh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ci(function(){mc(null,e,null,null)}),t[sn]=null}};function pc(e){this._internalRoot=e}pc.prototype.unstable_scheduleHydration=function(e){if(e){var t=sp();e={blockedOn:null,target:e,priority:t};for(var r=0;r<yn.length&&t!==0&&t<yn[r].priority;r++);yn.splice(r,0,e),r===0&&ip(e)}};function dh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function gc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Af(){}function Ab(e,t,r,s,i){if(i){if(typeof s=="function"){var a=s;s=function(){var u=Kl(o);a.call(u)}}var o=S0(t,s,e,0,null,!1,!1,"",Af);return e._reactRootContainer=o,e[sn]=o.current,io(e.nodeType===8?e.parentNode:e),ci(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof s=="function"){var c=s;s=function(){var u=Kl(l);c.call(u)}}var l=lh(e,0,!1,null,null,!1,!1,"",Af);return e._reactRootContainer=l,e[sn]=l.current,io(e.nodeType===8?e.parentNode:e),ci(function(){mc(t,l,r,s)}),l}function xc(e,t,r,s,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var c=i;i=function(){var l=Kl(o);c.call(l)}}mc(t,o,e,i)}else o=Ab(r,t,e,i,s);return Kl(o)}tp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=$a(t.pendingLanes);r!==0&&(Ad(t,r|1),zr(t,qt()),!(st&6)&&(oa=qt()+500,Dn()))}break;case 13:ci(function(){var s=nn(e,1);if(s!==null){var i=Ar();Rs(s,e,1,i)}}),ch(e,1)}};Rd=function(e){if(e.tag===13){var t=nn(e,134217728);if(t!==null){var r=Ar();Rs(t,e,134217728,r)}ch(e,134217728)}};rp=function(e){if(e.tag===13){var t=An(e),r=nn(e,t);if(r!==null){var s=Ar();Rs(r,e,t,s)}ch(e,t)}};sp=function(){return yt};np=function(e,t){var r=yt;try{return yt=e,t()}finally{yt=r}};ju=function(e,t,r){switch(t){case"input":if(gu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var i=oc(s);if(!i)throw Error(te(90));Om(s),gu(s,i)}}}break;case"textarea":$m(e,r);break;case"select":t=r.value,t!=null&&Vi(e,!!r.multiple,t,!1)}};qm=nh;Gm=ci;var Rb={usingClientEntryPoint:!1,Events:[_o,Mi,oc,Hm,zm,nh]},Ia={findFiberByHostInstance:Xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tb={bundleType:Ia.bundleType,version:Ia.version,rendererPackageName:Ia.rendererPackageName,rendererConfig:Ia.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ln.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Km(e),e===null?null:e.stateNode},findFiberByHostInstance:Ia.findFiberByHostInstance||Cb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sl.isDisabled&&sl.supportsFiber)try{sc=sl.inject(Tb),Bs=sl}catch{}}rs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rb;rs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dh(t))throw Error(te(200));return Pb(e,t,null,r)};rs.createRoot=function(e,t){if(!dh(e))throw Error(te(299));var r=!1,s="",i=k0;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=lh(e,1,!1,null,null,r,!1,s,i),e[sn]=t.current,io(e.nodeType===8?e.parentNode:e),new uh(t)};rs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=Km(t),e=e===null?null:e.stateNode,e};rs.flushSync=function(e){return ci(e)};rs.hydrate=function(e,t,r){if(!gc(t))throw Error(te(200));return xc(null,e,t,!0,r)};rs.hydrateRoot=function(e,t,r){if(!dh(e))throw Error(te(405));var s=r!=null&&r.hydratedSources||null,i=!1,a="",o=k0;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=S0(t,null,e,1,r??null,i,!1,a,o),e[sn]=t.current,io(e),s)for(e=0;e<s.length;e++)r=s[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new pc(t)};rs.render=function(e,t,r){if(!gc(t))throw Error(te(200));return xc(null,e,t,!1,r)};rs.unmountComponentAtNode=function(e){if(!gc(e))throw Error(te(40));return e._reactRootContainer?(ci(function(){xc(null,null,e,!1,function(){e._reactRootContainer=null,e[sn]=null})}),!0):!1};rs.unstable_batchedUpdates=nh;rs.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!gc(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return xc(e,t,r,!1,s)};rs.version="18.3.1-next-f1338f8080-20240426";function E0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E0)}catch(e){console.error(e)}}E0(),Em.exports=rs;var Fb=Em.exports,Rf=Fb;cu.createRoot=Rf.createRoot,cu.hydrateRoot=Rf.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yl(){return Yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yl.apply(this,arguments)}var ti;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ti||(ti={}));const Tf="popstate";function Ib(e){e===void 0&&(e={});function t(s,i){let{pathname:a,search:o,hash:c}=s.location;return rd("",{pathname:a,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(s,i){return typeof i=="string"?i:C0(i)}return Db(t,r,null,e)}function P0(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ob(){return Math.random().toString(36).substr(2,8)}function Ff(e,t){return{usr:e.state,key:e.key,idx:t}}function rd(e,t,r,s){return r===void 0&&(r=null),Yl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?A0(t):t,{state:r,key:t&&t.key||s||Ob()})}function C0(e){let{pathname:t="/",search:r="",hash:s=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function A0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function Db(e,t,r,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:a=!1}=s,o=i.history,c=ti.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Yl({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function x(){c=ti.Pop;let N=d(),f=N==null?null:N-u;u=N,l&&l({action:c,location:w.location,delta:f})}function h(N,f){c=ti.Push;let m=rd(w.location,N,f);u=d()+1;let v=Ff(m,u),E=w.createHref(m);try{o.pushState(v,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(E)}a&&l&&l({action:c,location:w.location,delta:1})}function p(N,f){c=ti.Replace;let m=rd(w.location,N,f);u=d();let v=Ff(m,u),E=w.createHref(m);o.replaceState(v,"",E),a&&l&&l({action:c,location:w.location,delta:0})}function y(N){let f=i.location.origin!=="null"?i.location.origin:i.location.href,m=typeof N=="string"?N:C0(N);return m=m.replace(/ $/,"%20"),P0(f,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,f)}let w={get action(){return c},get location(){return e(i,o)},listen(N){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Tf,x),l=N,()=>{i.removeEventListener(Tf,x),l=null}},createHref(N){return t(i,N)},createURL:y,encodeLocation(N){let f=y(N);return{pathname:f.pathname,search:f.search,hash:f.hash}},push:h,replace:p,go(N){return o.go(N)}};return w}var If;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(If||(If={}));function $b(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}const R0=["post","put","patch","delete"];new Set(R0);const Mb=["get",...R0];new Set(Mb);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sd(){return sd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},sd.apply(this,arguments)}const Lb=Q.createContext(null),T0=Q.createContext(null);function Ub(){return Q.useContext(T0)!=null}function Bb(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Hb(e){let{basename:t="/",children:r=null,location:s,navigationType:i=ti.Pop,navigator:a,static:o=!1,future:c}=e;Ub()&&P0(!1);let l=t.replace(/^\/*/,"/"),u=Q.useMemo(()=>({basename:l,navigator:a,static:o,future:sd({v7_relativeSplatPath:!1},c)}),[l,c,a,o]);typeof s=="string"&&(s=A0(s));let{pathname:d="/",search:x="",hash:h="",state:p=null,key:y="default"}=s,w=Q.useMemo(()=>{let N=$b(d,l);return N==null?null:{location:{pathname:N,search:x,hash:h,state:p,key:y},navigationType:i}},[l,d,x,h,p,y,i]);return w==null?null:Q.createElement(Lb.Provider,{value:u},Q.createElement(T0.Provider,{children:r,value:w}))}new Promise(()=>{});/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const zb="6";try{window.__reactRouterVersion=zb}catch{}const qb="startTransition",Of=Ng[qb];function Gb(e){let{basename:t,children:r,future:s,window:i}=e,a=Q.useRef();a.current==null&&(a.current=Ib({window:i,v5Compat:!0}));let o=a.current,[c,l]=Q.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},d=Q.useCallback(x=>{u&&Of?Of(()=>l(x)):l(x)},[l,u]);return Q.useLayoutEffect(()=>o.listen(d),[o,d]),Q.useEffect(()=>Bb(s),[s]),Q.createElement(Hb,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:o,future:s})}var Df;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Df||(Df={}));var $f;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})($f||($f={}));function bc(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]]);return r}function Wb(e,t,r,s){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(d){try{u(s.next(d))}catch(x){o(x)}}function l(d){try{u(s.throw(d))}catch(x){o(x)}}function u(d){d.done?a(d.value):i(d.value).then(c,l)}u((s=s.apply(e,t||[])).next())})}const Vb=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class hh extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class Kb extends hh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Mf extends hh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Lf extends hh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var nd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(nd||(nd={}));class Yb{constructor(t,{headers:r={},customFetch:s,region:i=nd.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=Vb(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Wb(this,arguments,void 0,function*(r,s={}){var i;let a,o;try{const{headers:c,method:l,body:u,signal:d,timeout:x}=s;let h={},{region:p}=s;p||(p=this.region);const y=new URL(`${this.url}/${r}`);p&&p!=="any"&&(h["x-region"]=p,y.searchParams.set("forceFunctionRegion",p));let w;u&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",w=u):typeof u=="string"?(h["Content-Type"]="text/plain",w=u):typeof FormData<"u"&&u instanceof FormData?w=u:(h["Content-Type"]="application/json",w=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?w=JSON.stringify(u):w=u;let N=d;x&&(o=new AbortController,a=setTimeout(()=>o.abort(),x),d?(N=o.signal,d.addEventListener("abort",()=>o.abort())):N=o.signal);const f=yield this.fetch(y.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),c),body:w,signal:N}).catch(C=>{throw new Kb(C)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new Mf(f);if(!f.ok)throw new Lf(f);let v=((i=f.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),E;return v==="application/json"?E=yield f.json():v==="application/octet-stream"||v==="application/pdf"?E=yield f.blob():v==="text/event-stream"?E=f:v==="multipart/form-data"?E=yield f.formData():E=yield f.text(),{data:E,error:null,response:f}}catch(c){return{data:null,error:c,response:c instanceof Lf||c instanceof Mf?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var Jb=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Qb=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let o=null,c=null,l=null,u=a.status,d=a.statusText;if(a.ok){var x,h;if(r.method!=="HEAD"){var p;const f=await a.text();f===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((p=r.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?c=f:c=JSON.parse(f))}const w=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),N=(h=a.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");w&&N&&N.length>1&&(l=parseInt(N[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,l=null,u=406,d="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var y;const w=await a.text();try{o=JSON.parse(w),Array.isArray(o)&&a.status===404&&(c=[],o=null,u=200,d="OK")}catch{a.status===404&&w===""?(u=204,d="No Content"):o={message:w}}if(o&&r.isMaybeSingle&&(!(o==null||(y=o.details)===null||y===void 0)&&y.includes("0 rows"))&&(o=null,u=200,d="OK"),o&&r.shouldThrowOnError)throw new Jb(o)}return{error:o,data:c,count:l,status:u,statusText:d}});return this.shouldThrowOnError||(i=i.catch(a=>{var o;let c="";const l=a==null?void 0:a.cause;if(l){var u,d,x,h;const y=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",w=(d=l==null?void 0:l.code)!==null&&d!==void 0?d:"";c=`${(x=a==null?void 0:a.name)!==null&&x!==void 0?x:"FetchError"}: ${a==null?void 0:a.message}`,c+=`

Caused by: ${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"Error"}: ${y}`,w&&(c+=` (${w})`),l!=null&&l.stack&&(c+=`
${l.stack}`)}else{var p;c=(p=a==null?void 0:a.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},Xb=class extends Qb{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var o;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${l}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Uf=new RegExp("[,()]");var Ai=class extends Xb{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&Uf.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&Uf.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Zb=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:s}=t??{},i=r?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join(""),{url:c,headers:l}=this.cloneRequestState();return c.searchParams.set("select",o),s&&l.append("Prefer",`count=${s}`),new Ai({method:i,url:c,headers:l,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const i="POST",{url:a,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(c.length>0){const l=[...new Set(c)].map(u=>`"${u}"`);a.searchParams.set("columns",l.join(","))}}return new Ai({method:i,url:a,headers:o,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){var a;const o="POST",{url:c,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&c.searchParams.set("on_conflict",t),s&&l.append("Prefer",`count=${s}`),i||l.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((d,x)=>d.concat(Object.keys(x)),[]);if(u.length>0){const d=[...new Set(u)].map(x=>`"${x}"`);c.searchParams.set("columns",d.join(","))}}return new Ai({method:o,url:c,headers:l,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var r;const s="PATCH",{url:i,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new Ai({method:s,url:i,headers:a,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:s,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Ai({method:r,url:s,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},ey=class F0{constructor(t,{headers:r={},schema:s,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Zb(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new F0(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:i=!1,count:a}={}){var o;let c;const l=new URL(`${this.url}/rpc/${t}`);let u;const d=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(d)),x=s&&Object.values(r).some(d);x?(c="POST",u=r):s||i?(c=s?"HEAD":"GET",Object.entries(r).filter(([p,y])=>y!==void 0).map(([p,y])=>[p,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([p,y])=>{l.searchParams.append(p,y)})):(c="POST",u=r);const h=new Headers(this.headers);return x?h.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&h.set("Prefer",`count=${a}`),new Ai({method:c,url:l,headers:h,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class ty{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const i=s.node,a=parseInt(i.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const ry="2.91.0",sy=`realtime-js/${ry}`,ny="1.0.0",I0="2.0.0",Bf=I0,id=1e4,iy=1e3,ay=100;var bn;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(bn||(bn={}));var Zt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Zt||(Zt={}));var Ps;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ps||(Ps={}));var ad;(function(e){e.websocket="websocket"})(ad||(ad={}));var Jn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Jn||(Jn={}));class oy{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s;const i=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,s;const i=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,s){var i,a;const o=t.topic,c=(i=t.ref)!==null&&i!==void 0?i:"",l=(a=t.join_ref)!==null&&a!==void 0?a:"",u=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+c.length+o.length+u.length+x.length,p=new ArrayBuffer(this.HEADER_LENGTH+h);let y=new DataView(p),w=0;y.setUint8(w++,this.KINDS.userBroadcastPush),y.setUint8(w++,l.length),y.setUint8(w++,c.length),y.setUint8(w++,o.length),y.setUint8(w++,u.length),y.setUint8(w++,x.length),y.setUint8(w++,r),Array.from(l,f=>y.setUint8(w++,f.charCodeAt(0))),Array.from(c,f=>y.setUint8(w++,f.charCodeAt(0))),Array.from(o,f=>y.setUint8(w++,f.charCodeAt(0))),Array.from(u,f=>y.setUint8(w++,f.charCodeAt(0))),Array.from(x,f=>y.setUint8(w++,f.charCodeAt(0)));var N=new Uint8Array(p.byteLength+s.byteLength);return N.set(new Uint8Array(p),0),N.set(new Uint8Array(s),p.byteLength),N.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[i,a,o,c,l]=s;return r({join_ref:i,ref:a,topic:o,event:c,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),i=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,s){const i=r.getUint8(1),a=r.getUint8(2),o=r.getUint8(3),c=r.getUint8(4);let l=this.HEADER_LENGTH+4;const u=s.decode(t.slice(l,l+i));l=l+i;const d=s.decode(t.slice(l,l+a));l=l+a;const x=s.decode(t.slice(l,l+o));l=l+o;const h=t.slice(l,t.byteLength),p=c===this.JSON_ENCODING?JSON.parse(s.decode(h)):h,y={type:this.BROADCAST_EVENT,event:d,payload:p};return o>0&&(y.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>r.includes(s)))}}class O0{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _t;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(_t||(_t={}));const Hf=(e,t,r={})=>{var s;const i=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=ly(o,e,t,i),a),{}):{}},ly=(e,t,r,s)=>{const i=t.find(c=>c.name===e),a=i==null?void 0:i.type,o=r[e];return a&&!s.includes(a)?D0(a,o):od(o)},D0=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return hy(t,r)}switch(e){case _t.bool:return cy(t);case _t.float4:case _t.float8:case _t.int2:case _t.int4:case _t.int8:case _t.numeric:case _t.oid:return uy(t);case _t.json:case _t.jsonb:return dy(t);case _t.timestamp:return fy(t);case _t.abstime:case _t.date:case _t.daterange:case _t.int4range:case _t.int8range:case _t.money:case _t.reltime:case _t.text:case _t.time:case _t.timestamptz:case _t.timetz:case _t.tsrange:case _t.tstzrange:return od(t);default:return od(t)}},od=e=>e,cy=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},uy=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},dy=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},hy=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(c=>D0(t,c))}return e},fy=e=>typeof e=="string"?e.replace(" ","T"):e,$0=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Xc{constructor(t,r,s={},i=id){this.channel=t,this.event=r,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var zf;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(zf||(zf={}));class Ya{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ya.syncState(this.state,i,a,o),this.pendingDiffs.forEach(l=>{this.state=Ya.syncDiff(this.state,l,a,o)}),this.pendingDiffs=[],c()}),this.channel._on(s.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ya.syncDiff(this.state,i,a,o),c())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,i){const a=this.cloneDeep(t),o=this.transformState(r),c={},l={};return this.map(a,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const x=a[u];if(x){const h=d.map(N=>N.presence_ref),p=x.map(N=>N.presence_ref),y=d.filter(N=>p.indexOf(N.presence_ref)<0),w=x.filter(N=>h.indexOf(N.presence_ref)<0);y.length>0&&(c[u]=y),w.length>0&&(l[u]=w)}else c[u]=d}),this.syncDiff(a,{joins:c,leaves:l},s,i)}static syncDiff(t,r,s,i){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(a,(c,l)=>{var u;const d=(u=t[c])!==null&&u!==void 0?u:[];if(t[c]=this.cloneDeep(l),d.length>0){const x=t[c].map(p=>p.presence_ref),h=d.filter(p=>x.indexOf(p.presence_ref)<0);t[c].unshift(...h)}s(c,d,l)}),this.map(o,(c,l)=>{let u=t[c];if(!u)return;const d=l.map(x=>x.presence_ref);u=u.filter(x=>d.indexOf(x.presence_ref)<0),t[c]=u,i(c,u,l),u.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const i=t[s];return"metas"in i?r[s]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qf;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(qf||(qf={}));var Ja;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ja||(Ja={}));var Ys;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ys||(Ys={}));class Gi{constructor(t,r={config:{}},s){var i,a;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xc(this,Ps.join,this.params,this.timeout),this.rejoinTimer=new O0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Zt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ps.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new Ya(this),this.broadcastEndpointURL=$0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Zt.closed){const{config:{broadcast:o,presence:c,private:l}}=this.params,u=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[Ja.PRESENCE]&&this.bindings[Ja.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,x={},h={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Ys.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Ys.CLOSED)),this.updateJoinPayload(Object.assign({config:h},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){t==null||t(Ys.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,N=(y=w==null?void 0:w.length)!==null&&y!==void 0?y:0,f=[];for(let m=0;m<N;m++){const v=w[m],{filter:{event:E,schema:C,table:T,filter:B}}=v,Y=p&&p[m];if(Y&&Y.event===E&&Gi.isFilterValueEqual(Y.schema,C)&&Gi.isFilterValueEqual(Y.table,T)&&Gi.isFilterValueEqual(Y.filter,B))f.push(Object.assign(Object.assign({},v),{id:Y.id}));else{this.unsubscribe(),this.state=Zt.errored,t==null||t(Ys.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,t&&t(Ys.SUBSCRIBED);return}}).receive("error",p=>{this.state=Zt.errored,t==null||t(Ys.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Ys.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Zt.joined&&t===Ja.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=s.timeout)!==null&&i!==void 0?i:this.timeout);if(c.status===202)return{success:!0};let l=c.statusText;try{const u=await c.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var s,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,c,l;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Zt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ps.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new Xc(this,Ps.leave,{},t),s.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Zt.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const i=new AbortController,a=setTimeout(()=>i.abort(),s),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),o}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Xc(this,t,r,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ay){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var i,a;const o=t.toLocaleLowerCase(),{close:c,error:l,leave:u,join:d}=Ps;if(s&&[c,l,u,d].indexOf(o)>=0&&s!==this._joinRef())return;let h=this._onMessage(o,r,s);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var y,w,N;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((N=(w=p.filter)===null||w===void 0?void 0:w.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===o}).map(p=>p.callback(h,s)):(a=this.bindings[o])===null||a===void 0||a.filter(p=>{var y,w,N,f,m,v,E,C;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const T=p.id,B=(y=p.filter)===null||y===void 0?void 0:y.event;return T&&((w=r.ids)===null||w===void 0?void 0:w.includes(T))&&(B==="*"||(B==null?void 0:B.toLocaleLowerCase())===((N=r.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))&&(!(!((f=p.filter)===null||f===void 0)&&f.table)||p.filter.table===((m=r.data)===null||m===void 0?void 0:m.table))}else{const T=(E=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return T==="*"||T===((C=r==null?void 0:r.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:w,table:N,commit_timestamp:f,type:m,errors:v}=y;h=Object.assign(Object.assign({},{schema:w,table:N,commit_timestamp:f,eventType:m,new:{},old:{},errors:v}),this._getPayloadRecords(y))}p.callback(h,s)})}_isClosed(){return this.state===Zt.closed}_isJoined(){return this.state===Zt.joined}_isJoining(){return this.state===Zt.joining}_isLeaving(){return this.state===Zt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const i=t.toLocaleLowerCase(),a={type:i,filter:r,callback:s};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Gi.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ps.close,{},t)}_onError(t){this._on(Ps.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Zt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Hf(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Hf(t.columns,t.old_record)),r}}const Zc=()=>{},nl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},my=[1e3,2e3,5e3,1e4],py=1e4,gy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xy{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=id,this.transport=null,this.heartbeatIntervalMs=nl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zc,this.ref=0,this.reconnectTimer=null,this.vsn=Bf,this.logger=Zc,this.conn=null,this.sendBuffer=[],this.serializer=new oy,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ad.websocket}`,this.httpEndpoint=$0(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ty.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case bn.connecting:return Jn.Connecting;case bn.open:return Jn.Open;case bn.closing:return Jn.Closing;default:return Jn.Closed}}isConnected(){return this.connectionState()===Jn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===s);if(i)return i;{const a=new Gi(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:s,payload:i,ref:a}=t,o=()=>{this.encode(t,c=>{var l;(l=this.conn)===null||l===void 0||l.send(c)})};this.log("push",`${r} ${s} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(iy,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},nl.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",u)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:i,payload:a,ref:o}=r,c=o?`(${o})`:"",l=a.status||"";this.log("receive",`${l} ${s} ${i} ${c}`.trim(),a),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(i,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===bn.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===bn.open||this.conn.readyState===bn.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ps.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${s}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([gy],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,s=!1;if(t)r=t,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const a={access_token:r,version:sy};r&&i.updateJoinPayload(a),i.joinedOnce&&i._isJoined()&&i._push(Ps.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new O0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},nl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,i,a,o,c,l,u,d,x,h,p;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:id,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:nl.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:Zc,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:Bf,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:y=>my[y-1]||py,this.vsn){case ny:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(y,w)=>w(JSON.stringify(y)),this.decode=(x=t==null?void 0:t.decode)!==null&&x!==void 0?x:(y,w)=>w(JSON.parse(y));break;case I0:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(p=t==null?void 0:t.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var po=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function by(e,t,r){const s=new URL(t,e);if(r)for(const[i,a]of Object.entries(r))a!==void 0&&s.searchParams.set(i,a);return s.toString()}async function yy(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function vy(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:i,body:a,headers:o}){const c=by(e.baseUrl,s,i),l=await yy(e.auth),u=await t(c,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...l,...o},body:a?JSON.stringify(a):void 0}),d=await u.text(),x=(u.headers.get("content-type")||"").includes("application/json"),h=x&&d?JSON.parse(d):d;if(!u.ok){const p=x?h:void 0,y=p==null?void 0:p.error;throw new po((y==null?void 0:y.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:p})}return{status:u.status,headers:u.headers,data:h}}}}function il(e){return e.join("")}var wy=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:il(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${il(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${il(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${il(e.namespace)}`}),!0}catch(t){if(t instanceof po&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof po&&r.status===409)return;throw r}}};function Ni(e){return e.join("")}var Ny=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ni(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ni(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ni(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ni(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ni(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ni(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof po&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof po&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},jy=class{constructor(e){var s;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=vy({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(s=e.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new wy(this.client,t),this.tableOps=new Ny(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},yc=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Dt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var _y=class extends yc{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ld=class extends yc{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const fh=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Sy=()=>Response,cd=e=>{if(Array.isArray(e))return e.map(r=>cd(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const i=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=cd(s)}),t},ky=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Ey=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function go(e){"@babel/helpers - typeof";return go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},go(e)}function Py(e,t){if(go(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(go(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cy(e){var t=Py(e,"string");return go(t)=="symbol"?t:t+""}function Ay(e,t,r){return(t=Cy(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,s)}return r}function Le(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gf(Object(r),!0).forEach(function(s){Ay(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gf(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const eu=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Ry=async(e,t,r)=>{e instanceof await Sy()&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const i=e.status||500,a=(s==null?void 0:s.statusCode)||i+"";t(new _y(eu(s),i,a))}).catch(s=>{t(new ld(eu(s),s))}):t(new ld(eu(e),e))},Ty=(e,t,r,s)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?i:(ky(s)?(i.headers=Le({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(s)):i.body=s,t!=null&&t.duplex&&(i.duplex=t.duplex),Le(Le({},i),r))};async function ko(e,t,r,s,i,a){return new Promise((o,c)=>{e(r,Ty(t,s,i,a)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Ry(l,c,s))})}async function xo(e,t,r,s){return ko(e,"GET",t,r,s)}async function ks(e,t,r,s,i){return ko(e,"POST",t,s,i,r)}async function ud(e,t,r,s,i){return ko(e,"PUT",t,s,i,r)}async function Fy(e,t,r,s){return ko(e,"HEAD",t,Le(Le({},r),{},{noResolveJson:!0}),s)}async function mh(e,t,r,s,i){return ko(e,"DELETE",t,s,i,r)}var Iy=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}}};let M0;M0=Symbol.toStringTag;var Oy=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[M0]="BlobDownloadBuilder",this.promise=null}asStream(){return new Iy(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}}};const Dy={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var $y=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=fh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var i=this;try{let a;const o=Le(Le({},Wf),s);let c=Le(Le({},i.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),l&&a.append("metadata",i.encodeMetadata(l)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),l&&!a.has("metadata")&&a.append("metadata",i.encodeMetadata(l))):(a=r,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,l&&(c["x-metadata"]=i.toBase64(i.encodeMetadata(l))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(c=Le(Le({},c),s.headers));const u=i._removeEmptyFolders(t),d=i._getFinalPath(u),x=await(e=="PUT"?ud:ks)(i.fetch,`${i.url}/object/${d}`,a,Le({headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:x.Id,fullPath:x.Key},error:null}}catch(a){if(i.shouldThrowOnError)throw a;if(Dt(a))return{data:null,error:a};throw a}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var i=this;const a=i._removeEmptyFolders(e),o=i._getFinalPath(a),c=new URL(i.url+`/object/upload/sign/${o}`);c.searchParams.set("token",t);try{let l;const u=Le({upsert:Wf.upsert},s),d=Le(Le({},i.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:a,fullPath:(await ud(i.fetch,c.toString(),l,{headers:d})).Key},error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Dt(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const i=Le({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const a=await ks(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:i}),o=new URL(r.url+a.url),c=o.searchParams.get("token");if(!c)throw new yc("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Dt(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await ks(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}}async copy(e,t,r){var s=this;try{return{data:{path:(await ks(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}}async createSignedUrl(e,t,r){var s=this;try{let i=s._getFinalPath(e),a=await ks(s.fetch,`${s.url}/object/sign/${i}`,Le({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${s.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}}async createSignedUrls(e,t,r){var s=this;try{const i=await ks(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Le(Le({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=s?`?${s}`:"",a=this._getFinalPath(e),o=()=>xo(this.fetch,`${this.url}/${r}/${a}${i}`,{headers:this.headers,noResolveJson:!0});return new Oy(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:cd(await xo(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Dt(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Fy(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Dt(s)&&s instanceof ld){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&s.push(o);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}async remove(e){var t=this;try{return{data:await mh(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const i=Le(Le(Le({},Dy),t),{},{prefix:e||""});return{data:await ks(s.fetch,`${s.url}/object/list/${s.bucketId}`,i,{headers:s.headers},r),error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(Dt(i))return{data:null,error:i};throw i}}async listV2(e,t){var r=this;try{const s=Le({},e);return{data:await ks(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Dt(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const L0="2.91.0",U0={"X-Client-Info":`storage-js/${L0}`};var My=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Le(Le({},U0),t),this.fetch=fh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await xo(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await xo(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await ks(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Dt(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await ud(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Dt(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await ks(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await mh(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Ly=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Le(Le({},U0),t),this.fetch=fh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await ks(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const s=r.toString(),i=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await xo(t.fetch,i,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await mh(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!Ey(e))throw new yc("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new jy({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(i,a){const o=i[a];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(i,c),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const ph={"X-Client-Info":`storage-js/${L0}`,"Content-Type":"application/json"};var B0=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Qr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var tu=class extends B0{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Uy=class extends B0{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const gh=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),By=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Vf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Hy=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e.status||500,i=e;if(typeof i.json=="function")i.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||s+"";t(new tu(Vf(a),s,o))}).catch(()=>{const a=s+"";t(new tu(i.statusText||`HTTP ${s} error`,s,a))});else{const a=s+"";t(new tu(i.statusText||`HTTP ${s} error`,s,a))}}else t(new Uy(Vf(e),e))},zy=(e,t,r,s)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return s?(By(s)?(i.headers=Le({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(s)):i.body=s,Le(Le({},i),r)):i};async function qy(e,t,r,s,i,a){return new Promise((o,c)=>{e(r,zy(t,s,i,a)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>Hy(l,c,s))})}async function Xr(e,t,r,s,i){return qy(e,"POST",t,s,i,r)}var Gy=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Le(Le({},ph),t),this.fetch=gh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Xr(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Qr(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Xr(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Qr(s))return{data:null,error:s};throw s}}},Wy=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Le(Le({},ph),t),this.fetch=gh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Xr(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Xr(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Xr(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}},Vy=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Le(Le({},ph),t),this.fetch=gh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Xr(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}},Ky=class extends Vy{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Yy(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},Yy=class extends Gy{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Le(Le({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Le(Le({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new Jy(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Jy=class extends Wy{constructor(e,t,r,s,i){super(e,t,i),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Le(Le({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Le(Le({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Le(Le({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Le(Le({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Le(Le({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Qy=class extends My{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new $y(this.url,this.headers,e,this.fetch)}get vectors(){return new Ky(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Ly(this.url+"/iceberg",this.headers,this.fetch)}};const H0="2.91.0",Ri=30*1e3,dd=3,ru=dd*Ri,Xy="http://localhost:9999",Zy="supabase.auth.token",ev={"X-Client-Info":`gotrue-js/${H0}`},hd="X-Supabase-Api-Version",z0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},tv=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,rv=10*60*1e3;class bo extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Ae(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class sv extends bo{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function nv(e){return Ae(e)&&e.name==="AuthApiError"}class Qn extends bo{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class cn extends bo{constructor(t,r,s,i){super(t,s,i),this.name=r,this.status=s}}class Yr extends cn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function iv(e){return Ae(e)&&e.name==="AuthSessionMissingError"}class ji extends cn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class al extends cn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ol extends cn{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function av(e){return Ae(e)&&e.name==="AuthImplicitGrantRedirectError"}class Kf extends cn{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ov extends cn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class fd extends cn{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function su(e){return Ae(e)&&e.name==="AuthRetryableFetchError"}class Yf extends cn{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class md extends cn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jf=` 	
\r=`.split(""),lv=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Jf.length;t+=1)e[Jf[t].charCodeAt(0)]=-2;for(let t=0;t<Jl.length;t+=1)e[Jl[t].charCodeAt(0)]=t;return e})();function Qf(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Jl[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Jl[s]),t.queuedBits-=6}}function q0(e,t,r){const s=lv[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Xf(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{dv(o,s,r)};for(let o=0;o<e.length;o+=1)q0(e.charCodeAt(o),i,a);return t.join("")}function cv(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function uv(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}cv(s,t)}}function dv(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Zi(e){const t=[],r={queue:0,queuedBits:0},s=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)q0(e.charCodeAt(i),r,s);return new Uint8Array(t)}function hv(e){const t=[];return uv(e,r=>t.push(r)),new Uint8Array(t)}function ri(e){const t=[],r={queue:0,queuedBits:0},s=i=>{t.push(i)};return e.forEach(i=>Qf(i,r,s)),Qf(null,r,s),t.join("")}function fv(e){return Math.round(Date.now()/1e3)+e}function mv(){return Symbol("auth-callback")}const pr=()=>typeof window<"u"&&typeof document<"u",Gn={tested:!1,writable:!1},G0=()=>{if(!pr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Gn.tested)return Gn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Gn.tested=!0,Gn.writable=!0}catch{Gn.tested=!0,Gn.writable=!1}return Gn.writable};function pv(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return r.searchParams.forEach((s,i)=>{t[i]=s}),t}const W0=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),gv=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ti=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Wn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},mr=async(e,t)=>{await e.removeItem(t)};class vc{constructor(){this.promise=new vc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}vc.promiseConstructor=Promise;function nu(e){const t=e.split(".");if(t.length!==3)throw new md("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!tv.test(t[s]))throw new md("JWT not in base64url format");return{header:JSON.parse(Xf(t[0])),payload:JSON.parse(Xf(t[1])),signature:Zi(t[2]),raw:{header:t[0],payload:t[1]}}}async function xv(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function bv(e,t){return new Promise((s,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){s(o);return}}catch(o){if(!t(a,o)){i(o);return}}})()})}function yv(e){return("0"+e.toString(16)).substr(-2)}function vv(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(t),Array.from(t,yv).join("")}async function wv(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(s);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function Nv(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await wv(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _i(e,t,r=!1){const s=vv();let i=s;r&&(i+="/PASSWORD_RECOVERY"),await Ti(e,`${t}-code-verifier`,i);const a=await Nv(s);return[a,s===a?"plain":"s256"]}const jv=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _v(e){const t=e.headers.get(hd);if(!t||!t.match(jv))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Sv(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function kv(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ev=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Si(e){if(!Ev.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function iu(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Pv(e,t){return new Proxy(e,{get:(r,s,i)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,i)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,i)}})}function Zf(e){return JSON.parse(JSON.stringify(e))}const Yn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Cv=[502,503,504];async function em(e){var t;if(!gv(e))throw new fd(Yn(e),0);if(Cv.includes(e.status))throw new fd(Yn(e),e.status);let r;try{r=await e.json()}catch(a){throw new Qn(Yn(a),a)}let s;const i=_v(e);if(i&&i.getTime()>=z0["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Yf(Yn(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Yr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Yf(Yn(r),e.status,r.weak_password.reasons);throw new sv(Yn(r),e.status||500,s)}const Av=(e,t,r,s)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),r))};async function Me(e,t,r,s){var i;const a=Object.assign({},s==null?void 0:s.headers);a[hd]||(a[hd]=z0["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const o=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Rv(e,t,r+c,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Rv(e,t,r,s,i,a){const o=Av(t,s,i,a);let c;try{c=await e(r,Object.assign({},o))}catch(l){throw console.error(l),new fd(Yn(l),0)}if(c.ok||await em(c),s!=null&&s.noResolveJson)return c;try{return await c.json()}catch(l){await em(l)}}function _s(e){var t;let r=null;Iv(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=fv(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function tm(e){const t=_s(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function wn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Tv(e){return{data:e,error:null}}function Fv(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:i,verification_type:a}=e,o=bc(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:s,redirect_to:i,verification_type:a},l=Object.assign({},o);return{data:{properties:c,user:l},error:null}}function rm(e){return e}function Iv(e){return e.access_token&&e.refresh_token&&e.expires_in}const au=["global","local","others"];class Ov{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=W0(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=au[0]){if(au.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${au.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ae(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:wn})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=bc(t,["options"]),i=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Fv,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ae(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:wn})}catch(r){if(Ae(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,i,a,o,c,l;try{const u={nextPage:null,lastPage:0,total:0},d=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:rm});if(d.error)throw d.error;const x=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const w=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(y.split(";")[1].split("=")[1]);u[`${N}Page`]=w}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},x),u),error:null}}catch(u){if(Ae(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Si(t);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:wn})}catch(r){if(Ae(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Si(t);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:wn})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){Si(t);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:wn})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){Si(t.userId);try{const{data:r,error:s}=await Me(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:s}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Si(t.userId),Si(t.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,i,a,o,c,l;try{const u={nextPage:null,lastPage:0,total:0},d=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:rm});if(d.error)throw d.error;const x=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const w=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(y.split(";")[1].split("=")[1]);u[`${N}Page`]=w}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},x),u),error:null}}catch(u){if(Ae(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ae(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}}function sm(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const ki={debug:!!(globalThis&&G0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class V0 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Dv extends V0{}async function $v(e,t,r){ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),ki.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Dv(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ki.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Mv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function K0(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Lv(e){return parseInt(e,16)}function Uv(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function Bv(e){var t;const{chainId:r,domain:s,expirationTime:i,issuedAt:a=new Date,nonce:o,notBefore:c,requestId:l,resources:u,scheme:d,uri:x,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=K0(e.address),y=d?`${d}://${s}`:s,w=e.statement?`${e.statement}
`:"",N=`${y} wants you to sign in with your Ethereum account:
${p}

${w}`;let f=`URI: ${x}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(i&&(f+=`
Expiration Time: ${i.toISOString()}`),c&&(f+=`
Not Before: ${c.toISOString()}`),l&&(f+=`
Request ID: ${l}`),u){let m=`
Resources:`;for(const v of u){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);m+=`
- ${v}`}f+=m}return`${N}
${f}`}class Kt extends Error{constructor({message:t,code:r,cause:s,name:i}){var a;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=i??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Ql extends Kt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Hv({error:e,options:t}){var r,s,i;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Kt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Kt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Kt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Kt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Kt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Kt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Kt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(Y0(o)){if(a.rp.id!==o)return new Kt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Kt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function zv({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Kt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(Y0(s)){if(r.rpId!==s)return new Kt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class qv{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Gv=new qv;function Wv(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,i=bc(e,["challenge","user","excludeCredentials"]),a=Zi(t).buffer,o=Object.assign(Object.assign({},r),{id:Zi(r.id).buffer}),c=Object.assign(Object.assign({},i),{challenge:a,user:o});if(s&&s.length>0){c.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const u=s[l];c.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:Zi(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return c}function Vv(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=bc(e,["challenge","allowCredentials"]),i=Zi(t).buffer,a=Object.assign(Object.assign({},s),{challenge:i});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const c=r[o];a.allowCredentials[o]=Object.assign(Object.assign({},c),{id:Zi(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function Kv(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ri(new Uint8Array(e.response.attestationObject)),clientDataJSON:ri(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Yv(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ri(new Uint8Array(i.authenticatorData)),clientDataJSON:ri(new Uint8Array(i.clientDataJSON)),signature:ri(new Uint8Array(i.signature)),userHandle:i.userHandle?ri(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Y0(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function nm(){var e,t;return!!(pr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Jv(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ql("Browser returned unexpected credential type",t)}:{data:null,error:new Ql("Empty credential response",t)}}catch(t){return{data:null,error:Hv({error:t,options:e})}}}async function Qv(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ql("Browser returned unexpected credential type",t)}:{data:null,error:new Ql("Empty credential response",t)}}catch(t){return{data:null,error:zv({error:t,options:e})}}}const Xv={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Zv={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Xl(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),s={};for(const i of e)if(i)for(const a in i){const o=i[a];if(o!==void 0)if(Array.isArray(o))s[a]=o;else if(r(o))s[a]=o;else if(t(o)){const c=s[a];t(c)?s[a]=Xl(c,o):s[a]=Xl(o)}else s[a]=o}return s}function ew(e,t){return Xl(Xv,e,t||{})}function tw(e,t){return Xl(Zv,e,t||{})}class rw{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:i},a){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:c};const l=i??Gv.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=ew(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:x}=await Jv({publicKey:u,signal:l});return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:x}}case"request":{const u=tw(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:x}=await Qv(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:x}}}}catch(o){return Ae(o)?{data:null,error:o}:{data:null,error:new Qn("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new bo("rpId is required for WebAuthn authentication")};try{if(!nm())return{data:null,error:new Qn("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:i},{request:a});if(!o)return{data:null,error:c};const{webauthn:l}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:s,credential_response:l.credential_response}})}catch(o){return Ae(o)?{data:null,error:o}:{data:null,error:new Qn("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new bo("rpId is required for WebAuthn registration")};try{if(!nm())return{data:null,error:new Qn("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(d=>{var x;return(x=d.data)===null||x===void 0?void 0:x.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:c};const{data:l,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:i},{create:a});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Ae(o)?{data:null,error:o}:{data:null,error:new Qn("Unexpected error in register",o)}}}}Mv();const sw={url:Xy,storageKey:Zy,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ev,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function im(e,t,r){return await r()}const Ei={};class yo{get jwks(){var t,r;return(r=(t=Ei[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ei[this.storageKey]=Object.assign(Object.assign({},Ei[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ei[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ei[this.storageKey]=Object.assign(Object.assign({},Ei[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},sw),t);if(this.storageKey=a.storageKey,this.instanceID=(r=yo.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,yo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&pr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Ov({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=W0(a.fetch),this.lock=a.lock||im,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&pr()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=$v:this.lock=im,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new rw(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:G0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sm(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=sm(this.memoryStorage)),pr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${H0}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(pr()&&(r=pv(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),pr()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),av(a)){const l=(t=a.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:o,redirectType:c}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ae(r)?this._returnResult({error:r}):this._returnResult({error:new Qn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,i;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:_s}),{data:o,error:c}=a;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(a){if(Ae(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,s,i;try{let a;if("email"in t){const{email:d,password:x,options:h}=t;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await _i(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:x,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:y},xform:_s})}else if("phone"in t){const{phone:d,password:x,options:h}=t;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:x,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_s})}else throw new al("You must provide either an email or phone number and a password");const{data:o,error:c}=a;if(c||!o)return await mr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(a){if(await mr(this.storage,`${this.storageKey}-code-verifier`),Ae(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:c}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:tm})}else if("phone"in t){const{phone:a,password:o,options:c}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:tm})}else throw new al("You must provide either an email or phone number and a password");const{data:s,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!s||!s.session||!s.user){const a=new ji;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,i,a,o,c,l,u,d,x,h;let p,y;if("message"in t)p=t.message,y=t.signature;else{const{chain:w,wallet:N,statement:f,options:m}=t;let v;if(pr())if(typeof N=="object")v=N;else{const le=window;if("ethereum"in le&&typeof le.ethereum=="object"&&"request"in le.ethereum&&typeof le.ethereum.request=="function")v=le.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=N}const E=new URL((r=m==null?void 0:m.url)!==null&&r!==void 0?r:window.location.href),C=await v.request({method:"eth_requestAccounts"}).then(le=>le).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const T=K0(C[0]);let B=(s=m==null?void 0:m.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!B){const le=await v.request({method:"eth_chainId"});B=Lv(le)}const Y={domain:E.host,address:T,statement:f,uri:E.href,version:"1",chainId:B,nonce:(i=m==null?void 0:m.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(a=m==null?void 0:m.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=m==null?void 0:m.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(l=m==null?void 0:m.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=m==null?void 0:m.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=m==null?void 0:m.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=Bv(Y),y=await v.request({method:"personal_sign",params:[Uv(p),T]})}try{const{data:w,error:N}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:y},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:_s});if(N)throw N;if(!w||!w.session||!w.user){const f=new ji;return this._returnResult({data:{user:null,session:null},error:f})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:N})}catch(w){if(Ae(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var r,s,i,a,o,c,l,u,d,x,h,p;let y,w;if("message"in t)y=t.message,w=t.signature;else{const{chain:N,wallet:f,statement:m,options:v}=t;let E;if(pr())if(typeof f=="object")E=f;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))E=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof f!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=f}const C=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const T=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),m?{statement:m}:null));let B;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")B=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)B=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in B&&"signature"in B&&(typeof B.signedMessage=="string"||B.signedMessage instanceof Uint8Array)&&B.signature instanceof Uint8Array)y=typeof B.signedMessage=="string"?B.signedMessage:new TextDecoder().decode(B.signedMessage),w=B.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${C.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(i=(s=v==null?void 0:v.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((x=(d=v==null?void 0:v.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||x===void 0)&&x.length?["Resources",...v.signInWithSolana.resources.map(B=>`- ${B}`)]:[]].join(`
`);const T=await E.signMessage(new TextEncoder().encode(y),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=T}}try{const{data:N,error:f}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:ri(w)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:_s});if(f)throw f;if(!N||!N.session||!N.user){const m=new ji;return this._returnResult({data:{user:null,session:null},error:m})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:f})}catch(N){if(Ae(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(t){const r=await Wn(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ov;const{data:a,error:o}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:_s});if(await mr(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const c=new ji;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",a.session)},0)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(await mr(this.storage,`${this.storageKey}-code-verifier`),Ae(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:s,token:i,access_token:a,nonce:o}=t,c=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:_s}),{data:l,error:u}=c;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new ji;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,i,a,o;try{if("email"in t){const{email:c,options:l}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await _i(this.storage,this.storageKey));const{error:x}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:c,options:l}=t,{data:u,error:d}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new al("You must provide either an email or phone number.")}catch(c){if(await mr(this.storage,`${this.storageKey}-code-verifier`),Ae(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(t){var r,s;try{let i,a;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:c}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:_s});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,s,i,a,o;try{let c=null,l=null;this.flowType==="pkce"&&([c,l]=await _i(this.storage,this.storageKey));const u=await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:l}),headers:this.headers,xform:Tv});return!((a=u.data)===null||a===void 0)&&a.url&&pr()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(c){if(await mr(this.storage,`${this.storageKey}-code-verifier`),Ae(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new Yr;const{error:i}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Ae(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:i,options:a}=t,{error:o}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:s,type:i,options:a}=t,{data:o,error:c}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c})}throw new al("You must provide either an email or phone number and a type")}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Wn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<ru:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const o=await Wn(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=iu()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=Pv(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:wn}):await this._useSession(async r=>{var s,i,a;const{data:o,error:c}=r;if(c)throw c;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Yr}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:wn})})}catch(r){if(Ae(r))return iv(r)&&(await this._removeSession(),await mr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:i,error:a}=s;if(a)throw a;if(!i.session)throw new Yr;const o=i.session;let c=null,l=null;this.flowType==="pkce"&&t.email!=null&&([c,l]=await _i(this.storage,this.storageKey));const{data:u,error:d}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:l}),jwt:o.access_token,xform:wn});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await mr(this.storage,`${this.storageKey}-code-verifier`),Ae(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Yr;const r=Date.now()/1e3;let s=r,i=!0,a=null;const{payload:o}=nu(t.access_token);if(o.exp&&(s=o.exp,i=s<=r),i){const{data:c,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:l}=await this._getUser(t.access_token);if(l)throw l;a={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(Ae(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:o,error:c}=r;if(c)throw c;t=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new Yr;const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!pr())throw new ol("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ol(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Kf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ol("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Kf("No code detected.");const{data:m,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:c,expires_at:l,token_type:u}=t;if(!a||!c||!o||!u)throw new ol("No session defined in URL");const d=Math.round(Date.now()/1e3),x=parseInt(c);let h=d+x;l&&(h=parseInt(l));const p=h-d;p*1e3<=Ri&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${x}s`);const y=h-x;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,h,d);const{data:w,error:N}=await this._getUser(a);if(N)throw N;const f={provider_token:s,provider_refresh_token:i,access_token:a,expires_in:x,expires_at:h,refresh_token:o,token_type:u,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:f,redirectType:t.type},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Wn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:i,error:a}=r;if(a)return this._returnResult({error:a});const o=(s=i.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(nv(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return t!=="others"&&(await this._removeSession(),await mr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=mv(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,i;try{const{data:{session:a},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await _i(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await mr(this.storage,`${this.storageKey}-code-verifier`),Ae(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:i}=await this._useSession(async a=>{var o,c,l,u,d;const{data:x,error:h}=a;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=x.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return pr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:i,data:{session:a}}=r;if(i)throw i;const{options:o,provider:c,token:l,access_token:u,nonce:d}=t,x=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:c,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:_s}),{data:h,error:p}=x;return p?this._returnResult({data:{user:null,session:null},error:p}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new ji}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:p}))}catch(i){if(await mr(this.storage,`${this.storageKey}-code-verifier`),Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,i;const{data:a,error:o}=r;if(o)throw o;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await bv(async i=>(i>0&&await xv(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:_s})),(i,a)=>{const o=200*Math.pow(2,i);return a&&su(a)&&Date.now()+o-s<Ri})}catch(s){if(this._debug(r,"error",s),Ae(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),pr()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await Wn(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Wn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Ti(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:iu()}else if(i&&!i.user&&!i.user){const o=await Wn(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await mr(this.storage,this.storageKey+"-user"),await Ti(this.storage,this.storageKey,i)):i.user=iu()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const a=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ru;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${ru}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),su(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(i.access_token);!c&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new Yr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new vc;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new Yr;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(i,"error",a),Ae(a)){const o={data:null,error:a};return su(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,s=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(l){a.push(l)}});if(await Promise.all(o),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await mr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Ti(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const a=Zf(i);await Ti(this.storage,this.storageKey,a)}else{const i=Zf(r);await Ti(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await mr(this.storage,this.storageKey),await mr(this.storage,this.storageKey+"-code-verifier"),await mr(this.storage,this.storageKey+"-user"),this.userStorage&&await mr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&pr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ri);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-t)/Ri);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ri}ms, refresh threshold is ${dd} ticks`),i<=dd&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof V0)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const i=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,o]=await _i(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(c.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);i.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:i,error:a}=r;return a?this._returnResult({data:null,error:a}):await Me(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,i;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:u}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Kv(t.webauthn.credential_response):Yv(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:l}=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:l}))})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:Wv(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:Vv(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=nu(s.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;return i?this._returnResult({data:null,error:i}):s?await Me(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Yr})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:i},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Yr});const o=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&pr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:i},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Yr});const o=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&pr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Me(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Yr})})}catch(t){if(Ae(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;return i?this._returnResult({data:null,error:i}):s?(await Me(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Yr})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(c=>c.kid===t);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(c=>c.kid===t),s&&this.jwks_cached_at+rv>i)return s;const{data:a,error:o}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,s=a.keys.find(c=>c.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:p,error:y}=await this.getSession();if(y||!p.session)return this._returnResult({data:null,error:y});s=p.session.access_token}const{header:i,payload:a,signature:o,raw:{header:c,payload:l}}=nu(s);r!=null&&r.allowExpired||Sv(a.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:i,signature:o},error:null}}const d=kv(i.alg),x=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,x,o,hv(`${c}.${l}`)))throw new md("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}}yo.nextInstanceID={};const nw=yo,iw="2.91.0";let La="";typeof Deno<"u"?La="deno":typeof document<"u"?La="web":typeof navigator<"u"&&navigator.product==="ReactNative"?La="react-native":La="node";const aw={"X-Client-Info":`supabase-js-${La}/${iw}`},ow={headers:aw},lw={schema:"public"},cw={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uw={};function vo(e){"@babel/helpers - typeof";return vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vo(e)}function dw(e,t){if(vo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(vo(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hw(e){var t=dw(e,"string");return vo(t)=="symbol"?t:t+""}function fw(e,t,r){return(t=hw(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function am(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,s)}return r}function Bt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?am(Object(r),!0).forEach(function(s){fw(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):am(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const mw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),pw=()=>Headers,gw=(e,t,r)=>{const s=mw(r),i=pw();return async(a,o)=>{var c;const l=(c=await t())!==null&&c!==void 0?c:e;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(a,Bt(Bt({},o),{},{headers:u}))}};function xw(e){return e.endsWith("/")?e:e+"/"}function bw(e,t){var r,s;const{db:i,auth:a,realtime:o,global:c}=e,{db:l,auth:u,realtime:d,global:x}=t,h={db:Bt(Bt({},l),i),auth:Bt(Bt({},u),a),realtime:Bt(Bt({},d),o),storage:{},global:Bt(Bt(Bt({},x),c),{},{headers:Bt(Bt({},(r=x==null?void 0:x.headers)!==null&&r!==void 0?r:{}),(s=c==null?void 0:c.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function yw(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(xw(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var vw=class extends nw{constructor(e){super(e)}},ww=class{constructor(e,t,r){var s,i;this.supabaseUrl=e,this.supabaseKey=t;const a=yw(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:lw,realtime:uw,auth:Bt(Bt({},cw),{},{storageKey:o}),global:ow},l=bw(r??{},c);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=l.global.headers)!==null&&i!==void 0?i:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=gw(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Bt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new ey(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new Qy(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new Yb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:s}=await e.auth.getSession();return(t=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:a,flowType:o,lock:c,debug:l,throwOnError:u},d,x){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vw({url:this.authUrl.href,headers:Bt(Bt({},h),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,flowType:o,lock:c,debug:l,throwOnError:u,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new xy(this.realtimeUrl.href,Bt(Bt({},e),{},{params:Bt(Bt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const pd=(e,t,r)=>new ww(e,t,r);function Nw(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Nw()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const jw={BASE_URL:"/golf/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1xa25haGRmcHF4cnBncHhxdHVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NTU3MDYsImV4cCI6MjA3ODAzMTcwNn0.GTUVsrRJ-MClMg96vuHZpUtAnUFtCsJvuLiiE0D-fCc
`,VITE_SUPABASE_URL:`https://mqknahdfpqxrpgpxqtus.supabase.co
`},_w=["kevanojb@icloud.com"];let Wi="",ll="";const ou=(e,t=0)=>{const r=Number(e);return Number.isFinite(r)?r:t};typeof window<"u"&&(window.supabase=window.supabase||{},window.supabase.createClient=window.supabase.createClient||pd);function Sw(){try{return(typeof import.meta<"u"&&jw?"/golf/":"/").replace(/^\/+/,"").split("/")[0]||""}catch{return""}}function kw(){try{if(typeof window>"u")return"";const e=Sw(),t=String(window.location.pathname||"").split("?")[0].split("#")[0].split("/").filter(Boolean);if(!t.length)return"";if(e){const r=t.indexOf(e);if(r>=0&&t[r+1])return decodeURIComponent(t[r+1])}return decodeURIComponent(t[0]||"")}catch{return""}}var la=function(e,t){if(t===void 0&&(t=NaN),e==null)return t;if(typeof e=="string"){var r=e.trim();if(!r||r===""||r==="-")return t;e=r}var s=Number(e);return Number.isFinite(s)?s:t},Ew=function(e){var t=e&&(e.parsPerHole||e.parPerHole||e.parsArr||e.pars||e.parHoles||e.par)||null,r=e&&(e.siPerHole||e.strokeIndexPerHole||e.siArr||e.si||e.strokeIndex)||null,s=Array.isArray(t)?t.map(Number):null,i=Array.isArray(r)?r.map(Number):null;return{pArr:s,sArr:i}};function xh(e,t,r){const s=r||{},i=!!s.pickupAsZero,a=s.max===void 0?1/0:s.max,o=s.min===void 0?-1/0:s.min,c=s.intMode!==!1,l=new Array(18).fill(NaN);if(!e||t===void 0||t===null)return l;for(let u=0;u<18;u++){const d=t+u+(u>=9?1:0),x=d<e.length?e[d]:"";let h=String(x??"").trim();if(h===""||h===""||h==="-"){l[u]=NaN;continue}if(h==="P"||h==="p"||h==="\\"||h==="/"){l[u]=i?0:NaN;continue}const p=h.replace(/[^0-9.\-]/g,"");let y=c?parseInt(p,10):parseFloat(p);if(!Number.isFinite(y)){l[u]=NaN;continue}if(y<o||y>a){l[u]=NaN;continue}l[u]=y}return l}function gs(e){try{const t=Array.isArray(e)?e:[];if(!t.length)return 18;for(const r of t){const s=Array.isArray(r==null?void 0:r.perHole)?r.perHole:null,i=Array.isArray(r==null?void 0:r.grossPerHole)?r.grossPerHole:null;for(let a=9;a<18;a++){const o=s?Number(s[a]):NaN,c=i?Number(i[a]):NaN;if(Number.isFinite(o)||Number.isFinite(c))return 18}}return 9}catch{return 18}}function om(e){const t=Array.isArray(e)?e:[],r=[];for(let u=0;u<t.length;u++){const d=Number(t[u]);Number.isFinite(d)&&r.push(d)}if(r.length<6)return NaN;const s=Math.min(10,r.length),i=r.slice(-s),a=(s-1)/2,o=i.reduce((u,d)=>u+d,0)/s;let c=0,l=0;for(let u=0;u<s;u++){const d=u-a;c+=d*(i[u]-o),l+=d*d}return l?c/l:NaN}function lm(e){const t=Array.isArray(e)?e.slice():[],r=typeof window<"u"&&window.__dslUiState?window.__dslUiState:{},s=r&&r.seasonYear?String(r.seasonYear):"All",i=r&&r.seasonLimit?String(r.seasonLimit):"All";let o=t.filter(Boolean).slice().sort((c,l)=>{const u=Number.isFinite(Number(c==null?void 0:c.dateMs))?Number(c.dateMs):Number((c==null?void 0:c.idx)||0),d=Number.isFinite(Number(l==null?void 0:l.dateMs))?Number(l.dateMs):Number((l==null?void 0:l.idx)||0);return u-d});if(s&&s.toLowerCase()!=="all"){const c=u=>{const d=String(u??"").trim(),x=d.match(/^(\d{4})-(\d{2})$/);if(x){const h=x[1],p=String(Number(h.slice(0,2)+x[2]));return`${h}-${p}`}return d},l=c(s);o=o.filter(u=>{var h;const d=(u&&(u.seasonId??u.season_id))??(u&&u.parsed&&(u.parsed.seasonId??u.parsed.season_id))??(u&&u.meta&&(u.meta.seasonId??u.meta.season_id));if(d!=null&&String(d).trim()!=="")return c(d)===l;const x=Number.isFinite(Number(u==null?void 0:u.dateMs))?Number(u.dateMs):Number.isFinite(Number((h=u==null?void 0:u.parsed)==null?void 0:h.dateMs))?Number(u.parsed.dateMs):u!=null&&u.date?_coerceDateMs(u.date):NaN;if(Number.isFinite(x))try{const p=typeof window<"u"&&window.__dslSeasonsDef?window.__dslSeasonsDef:[],y=seasonIdForDateMs(x,p);if(y!=null&&String(y).trim()!=="")return c(y)===l}catch{}return!1})}if(i&&i.toLowerCase()!=="all"){const c=Number(i);Number.isFinite(c)&&c>0&&(o=o.slice(-c))}return o}if(typeof window<"u"&&typeof window._bestWorstSentences<"u"&&typeof window._bestWorstSentences!="function"){const e=window._bestWorstSentences;window._bestWorstSentences=()=>Array.isArray(e)?e:e?[e]:[]}const Pw=[20,17,15,13,11,9,8,7,6,5,4,3,2,1],Us=(e,t,r)=>Math.max(t,Math.min(r,e)),cl=e=>Math.round((Number(e)||0)*10)/10;function Ot(e){return String(e||"").replace(/\u00A0/g," ").replace(/\s+/g," ").trim().toLowerCase()}function cm(e){const t=Ot(e).split(" ").filter(Boolean);return t.length?t[t.length-1]:""}function _l(e,t){if(e=Ot(e),t=Ot(t),e===t)return 0;const r=e.length,s=t.length;if(!r)return s;if(!s)return r;const i=new Array(s+1);for(let a=0;a<=s;a++)i[a]=a;for(let a=1;a<=r;a++){let o=i[0];i[0]=a;for(let c=1;c<=s;c++){const l=i[c],u=e[a-1]===t[c-1]?0:1;i[c]=Math.min(i[c]+1,i[c-1]+1,o+u),o=l}}return i[s]}function um(e,t){const r=Ot(e),s=Ot(t);if(!r||!s)return!1;if(r===s||r.includes(s)||s.includes(r))return!0;const i=cm(r),a=cm(s),o=_l(r,s),c=Math.max(r.length,s.length);return i&&a&&i===a?o<=(c<=10?2:3):o<=(c<=8?1:2)}function bt(e){try{const t=document.createElement("div");t.className="fixed bottom-4 right-4 left-4 md:left-auto md:right-4 px-3 py-2 rounded-lg bg-black text-white text-sm shadow z-50 text-center",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="0",t.style.transition="opacity .2s",setTimeout(()=>t.remove(),220)},1400)}catch{}}function Cw({open:e,onClose:t,onSubmit:r,busy:s}){const[i,a]=Q.useState(""),[o,c]=Q.useState(""),[l,u]=Q.useState("");if(Q.useEffect(()=>{e||(a(""),c(""),u(""))},[e]),!e)return null;const d=async x=>{x.preventDefault(),u("");const h=(i||"").trim();if(!h||!o){u("Enter email + password.");return}try{await r(h,o)}catch(p){u((p==null?void 0:p.message)||String(p))}};return n.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4",children:[n.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:t}),n.jsxs("div",{className:"relative w-full max-w-md glass-card p-4 sm:p-5",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-lg font-extrabold text-squab-900",children:"Admin sign in"}),n.jsx("div",{className:"text-xs text-neutral-500",children:"Use your Supabase account."})]}),n.jsx("button",{className:"btn-secondary",type:"button",onClick:t,children:""})]}),n.jsxs("form",{className:"mt-4 space-y-3",onSubmit:d,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-neutral-700 mb-1",children:"Email"}),n.jsx("input",{className:"w-full px-3 py-2 rounded-xl border border-squab-200 bg-white/90 focus:outline-none focus:ring-2 focus:ring-squab-300",type:"email",autoComplete:"email",value:i,onChange:x=>a(x.target.value),placeholder:"name@example.com"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-neutral-700 mb-1",children:"Password"}),n.jsx("input",{className:"w-full px-3 py-2 rounded-xl border border-squab-200 bg-white/90 focus:outline-none focus:ring-2 focus:ring-squab-300",type:"password",autoComplete:"current-password",value:o,onChange:x=>c(x.target.value),placeholder:""})]}),l?n.jsx("div",{className:"text-sm text-red-700 bg-red-50 border border-red-200 rounded-xl px-3 py-2",children:l}):null,n.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[n.jsx("button",{type:"button",className:"btn-secondary",onClick:t,disabled:s,children:"Cancel"}),n.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?"Signing in...":"Sign in"})]})]})]})]})}function Aw({open:e,onClose:t,onSubmit:r}){const[s,i]=ue.useState("");return ue.useEffect(()=>{e&&i("")},[e]),ue.useEffect(()=>{if(!e)return;const a=o=>{o&&(o.key==="Escape"&&t&&t(),o.key==="Enter"&&r&&r(s))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[e,s,t,r]),e?n.jsxs("div",{className:"fixed inset-0 z-50",children:[n.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:t}),n.jsxs("div",{className:"absolute inset-x-0 bottom-0 max-h-[75vh] rounded-t-3xl bg-white border border-neutral-200 shadow-2xl overflow-hidden",children:[n.jsx("div",{className:"p-4 border-b border-neutral-200 bg-white/90 backdrop-blur-md",children:n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-squab-700",children:"Admin"}),n.jsx("div",{className:"text-xl font-black text-neutral-900",children:"Enter password"}),n.jsx("div",{className:"text-xs text-neutral-600 mt-1",children:"Unlocks player management on this device."})]}),n.jsx("button",{className:"chip border-neutral-200 bg-white text-neutral-700 hover:opacity-90",onClick:t,children:"Close"})]})}),n.jsxs("div",{className:"p-4",children:[n.jsx("input",{value:s,onChange:a=>i(a.target.value),placeholder:"Password...",type:"password",className:"w-full rounded-2xl border border-neutral-200 px-4 py-3 bg-white"}),n.jsxs("div",{className:"mt-3 flex items-center justify-end gap-2",children:[n.jsx("button",{className:"btn-secondary",onClick:t,children:"Cancel"}),n.jsx("button",{className:"btn-primary",onClick:()=>r&&r(s),children:"Unlock"})]}),n.jsxs("div",{className:"mt-2 text-[11px] text-neutral-500",children:["Tip: set ",n.jsx("span",{className:"font-mono",children:"window.DEN_ADMIN_PASSWORD"})," in the file to change the password."]})]})]})]}):null}function Rw({open:e,onClose:t,isAdmin:r,players:s,hiddenKeys:i,onSave:a}){const[o,c]=ue.useState(""),[l,u]=ue.useState([]),d=ue.useRef(null);ue.useEffect(()=>{e&&(c(""),u(Array.isArray(i)?i.slice():[]))},[e,i]),ue.useEffect(()=>{if(!e)return;const C=T=>{T&&T.key==="Escape"&&t&&t()};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[e,t]);const x=ue.useMemo(()=>{const T=(Array.isArray(s)?s:[]).map(le=>{const J=String((le==null?void 0:le.name)||"").trim(),De=Ot(J);return{name:J,key:De}}).filter(le=>le.name&&le.key),B=new Set,Y=[];for(const le of T.sort((J,De)=>J.name.localeCompare(De.name)))B.has(le.key)||(B.add(le.key),Y.push(le));return Y},[s]),h=(o||"").toLowerCase().trim(),p=h?x.filter(C=>C.name.toLowerCase().includes(h)):x,y=new Set(l),w=x.reduce((C,T)=>C+(y.has(T.key)?0:1),0);function N(C,T){u(B=>{const Y=new Set(Array.isArray(B)?B:[]);return T?Y.delete(C):Y.add(C),Array.from(Y)})}function f(){u([])}function m(){u(x.map(C=>C.key))}function v(){try{const C=JSON.stringify({hiddenKeys:Array.from(new Set(l))},null,2),T=new Blob([C],{type:"application/json"}),B=URL.createObjectURL(T),Y=document.createElement("a");Y.href=B,Y.download="player_visibility.json",document.body.appendChild(Y),Y.click(),Y.remove(),setTimeout(()=>URL.revokeObjectURL(B),2e3)}catch{}}async function E(C){var B,Y;const T=(Y=(B=C==null?void 0:C.target)==null?void 0:B.files)==null?void 0:Y[0];if(T)try{const le=await T.text(),J=JSON.parse(le),De=Array.isArray(J==null?void 0:J.hiddenKeys)?J.hiddenKeys:Array.isArray(J==null?void 0:J.hidden)?J.hidden:[],nt=Array.from(new Set((De||[]).map(Ke=>String(Ke||"").trim()).filter(Boolean)));u(nt)}catch{alert("Could not import file (invalid JSON).")}finally{try{C.target.value=""}catch{}}}return e?n.jsxs("div",{className:"fixed inset-0 z-50",children:[n.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:t}),n.jsxs("div",{className:"absolute inset-x-0 bottom-0 max-h-[92vh] rounded-t-3xl bg-white border border-neutral-200 shadow-2xl overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"sticky top-0 bg-white/90 backdrop-blur-md border-b border-neutral-200 p-4",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Admin"}),n.jsx("div",{className:"text-xl font-black text-neutral-900",children:"Player filter"}),n.jsx("div",{className:"text-xs text-neutral-600 mt-1",children:"Show only the players you want in leaderboards & reports. You can readd anyone anytime."})]}),n.jsx("button",{className:"chip border-neutral-200 bg-white text-neutral-700 hover:opacity-90",onClick:t,children:"Close"})]}),n.jsxs("div",{className:"mt-3 flex items-center justify-between gap-2 flex-wrap",children:[n.jsxs("div",{className:"text-[11px] text-neutral-600",children:["Showing ",n.jsx("span",{className:"font-black",children:w})," / ",n.jsx("span",{className:"font-black",children:x.length})," players"]}),n.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[n.jsx("button",{className:"chip border-neutral-200 bg-white text-neutral-700",onClick:f,children:"Include all"}),n.jsx("button",{className:"chip border-neutral-200 bg-white text-neutral-700",onClick:m,children:"Exclude all"}),n.jsx("button",{className:"chip border-neutral-200 bg-white text-neutral-700",onClick:v,title:"Download current visibility list",children:"Export"}),n.jsx("button",{className:"chip border-neutral-200 bg-white text-neutral-700",onClick:()=>d.current&&d.current.click(),title:"Import a previously exported list",children:"Import"}),n.jsx("input",{ref:d,type:"file",accept:"application/json",style:{display:"none"},onChange:E})]})]}),n.jsx("div",{className:"mt-3",children:n.jsx("input",{value:o,onChange:C=>c(C.target.value),placeholder:"Search player...",className:"w-full rounded-2xl border border-neutral-200 px-4 py-2 bg-white"})})]}),n.jsx("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:x.length?n.jsx("div",{className:"space-y-2",children:p.map(C=>{const T=!y.has(C.key);return n.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-2xl border border-neutral-200 bg-neutral-50 px-4 py-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"font-extrabold text-neutral-900 truncate",children:C.name}),n.jsx("div",{className:"text-xs text-neutral-600",children:T?"Included":"Excluded"})]}),n.jsx("input",{type:"checkbox",checked:T,onChange:B=>N(C.key,B.target.checked),className:"h-5 w-5"})]},C.key)})}):n.jsx("div",{className:"text-sm text-neutral-600",children:"No players yet  scan/import some games first."})}),n.jsxs("div",{className:"border-t border-neutral-200 p-4 flex items-center justify-between gap-3",children:[n.jsx("div",{className:"text-xs text-neutral-600",children:r?"Save publishes to the league.":"Save stores locally on this device (sign in to publish to everyone)."}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn-secondary",onClick:t,children:"Cancel"}),n.jsx("button",{className:"btn-primary",onClick:()=>a&&a(l),title:r?"Publish player visibility":"Save locally",children:r?"Publish":"Save locally"})]})]})]})]}):null}function Tw(e){return 36}function ca(e){return Number.isFinite(e)?e<=9?"0-9":e<=18?"10-18":e<=28?"19-28":"29-36":null}function Fw(e){const t=ca(e);return t==="0-9"?.5:t==="10-18"||t==="19-28"?1:1.5}function Iw(e){const t=ca(e);return t==="0-9"?1:t==="10-18"?2:t==="19-28"?2.5:3}function J0(e,t,r,s,i){const a=Math.round(e);let o=e;r>=35?o-=Fw(a)*(r-34):r<=31&&(o+=.5*(32-r)),i&&(o-=Iw(a));const c=Tw(),l=Us(o,0,36),u=Us(Math.round(l),0,c);return{nextExact:l,nextPlaying:u}}const Yt=e=>{const t=(e||"").trim();return/^players?$/i.test(t)||/^team(\s*\d+)?$/i.test(t)||/^team average$/i.test(t)||/^stableford$/i.test(t)||/^strokeplay$/i.test(t)||/^round\s*\d+$/i.test(t)||/^(out|in|total|s\.i\.|par)$/i.test(t)};function Ow(e){if(!e)return[];const t=e.includes("	")?"	":e.includes(";")?";":",",r=[];let s="",i=!1;for(let a=0;a<e.length;a++){const o=e[a];o==='"'?i&&e[a+1]==='"'?(s+='"',a++):i=!i:o===t&&!i?(r.push(s.trim()),s=""):s+=o}return r.push(s.trim()),r.map(a=>a.replace(/^"|"$/g,""))}function kt(e){const t=parseFloat(String(e??"").replace(/[^0-9.\-]/g,""));return Number.isFinite(t)?t:NaN}function Ve(e,t){const r=kt(e);return Number.isFinite(r)?r:t}const Dw="peerGroup";function dm(e){var s,i;const t=["startExact","start_exact","hcap","handicap","playingHcap","handicapIndex","handicap_index","hi","HI","exact","hcp","HCP"],r=a=>{if(!a)return NaN;for(const o of t){const c=Ve(a[o],NaN);if(Number.isFinite(c))return c}return NaN};try{const a=Array.isArray(e==null?void 0:e.windowSeries)?e.windowSeries:Array.isArray(e==null?void 0:e.roundSeries)?e.roundSeries:Array.isArray(e==null?void 0:e.series)?e.series:Array.isArray(e==null?void 0:e.rounds)?e.rounds:null;if(a&&a.length){const l=a[a.length-1]||{};let u=r(l);if(Number.isFinite(u))return Math.round(u*10)/10;let d=0,x=0;for(const h of a){const p=r(h);Number.isFinite(p)&&(d+=p,x++)}if(x)return Math.round(d/x*10)/10}const o=Ve((s=e==null?void 0:e.metrics)==null?void 0:s.avgHcap,Ve((i=e==null?void 0:e.metrics)==null?void 0:i.avg_handicap,Ve(e==null?void 0:e.avgHcap,Ve(e==null?void 0:e.handicapIndex,Ve(e==null?void 0:e.handicap_index,NaN)))));if(Number.isFinite(o))return Math.round(o*10)/10;const c=r(e);if(Number.isFinite(c))return Math.round(c*10)/10}catch{}return NaN}function Pi(e,t){const r={};return(e||[]).forEach(s=>{const i=(s==null?void 0:s[t])||{};Object.keys(i).forEach(a=>{const o=i[a];r[a]||(r[a]={sumMe:0,sumField:0,holes:0}),r[a].sumMe+=Ve(o==null?void 0:o.me,0),r[a].sumField+=Ve(o==null?void 0:o.fieldAvg,0),r[a].holes+=Ve(o==null?void 0:o.holes,0)})}),Object.keys(r).forEach(s=>{const i=r[s],a=Math.max(0,i.holes);r[s]={me:a?i.sumMe/a:0,fieldAvg:a?i.sumField/a:0,holes:a}}),r}function $w(e,t,r,s){const i=kt(e),a=kt(t),o=kt(r),c=kt(s);return!Number.isFinite(i)||!Number.isFinite(a)||a<=0||!Number.isFinite(o)||!Number.isFinite(c)?NaN:Math.round(i*(a/113)+(o-c))}function Mw(e,t){const r=Math.trunc(kt(e)),s=Math.trunc(kt(t));if(!Number.isFinite(r)||!Number.isFinite(s)||s<1||s>18||r<=0)return 0;const i=Math.floor(r/18),a=r%18;return i+(s<=a?1:0)}function Lw(e,t){const r=Math.trunc(kt(e)),s=Math.trunc(kt(t));return Number.isFinite(r)?r+(Number.isFinite(s)?s:0)+2:NaN}function gd(e,t,r,s,i){const a=Array.isArray(e)?e:[],o=Array.isArray(t==null?void 0:t.pars)?t.pars:Array.isArray(t==null?void 0:t.par)?t.par:[],c=Array.isArray(t==null?void 0:t.si)?t.si:Array.isArray(t==null?void 0:t.SI)?t.SI:[],l=o.reduce((h,p)=>h+(Number.isFinite(kt(p))?kt(p):0),0),u=$w(r,s,i,l);if(!Number.isFinite(u))return NaN;let d=0,x=0;for(let h=0;h<18;h++){const p=kt(a[h]),y=kt(o[h]),w=kt(c[h]);if(!Number.isFinite(p)||!Number.isFinite(y)||y<=0)continue;const N=Mw(u,w),f=Lw(y,N),m=Number.isFinite(f)?Math.min(p,f):p;d+=m,x+=1}return x>=9?d:NaN}function xd(e,t,r,s){const i=kt(e),a=kt(t),o=kt(r),c=Number.isFinite(kt(s))?kt(s):0;return!Number.isFinite(i)||!Number.isFinite(a)||a<=0||!Number.isFinite(o)?NaN:(i-o-c)*113/a}function Q0(e){const t=(Array.isArray(e)?e:[]).map(kt).filter(Number.isFinite),r=t.length;if(r<3)return NaN;let s=0,i=0;r===3?(s=1,i=-2):r===4?(s=1,i=-1):r===5?(s=1,i=0):r===6||r===7||r===8?(s=2,i=0):r===9||r===10||r===11?(s=3,i=0):r===12||r===13||r===14?(s=4,i=0):r===15||r===16?(s=5,i=0):r===17||r===18?(s=6,i=0):r===19?(s=7,i=0):(s=8,i=0);const o=t.slice().sort((u,d)=>u-d).slice(0,s);if(!o.length)return NaN;const l=o.reduce((u,d)=>u+d,0)/o.length+i;return Math.round(l*10)/10}function Uw(e){var x;if(!Array.isArray(e))return{ok:!1,reason:"no_series"};const t=new Map;for(const h of e){const p=(h==null?void 0:h.courseName)||(h==null?void 0:h.course)||(h==null?void 0:h.clubName)||(h==null?void 0:h.venueName)||"",y=(h==null?void 0:h.teeName)||(h==null?void 0:h.tee)||(h==null?void 0:h.teeLabel)||"",w=`${String(p)}|${String(y)}`;t.has(w)||t.set(w,{courseName:p,teeName:y,rounds:[]}),t.get(w).rounds.push(h)}const r=Array.from(t.values()).sort((h,p)=>{var y,w;return(((y=p.rounds)==null?void 0:y.length)||0)-(((w=h.rounds)==null?void 0:w.length)||0)})[0];if(!r||(((x=r.rounds)==null?void 0:x.length)||0)<2)return{ok:!1,reason:"need_2_rounds",groups:Array.from(t.values())};const s=18,i=Array(s).fill(0),a=Array(s).fill(0);for(const h of r.rounds){const p=Array.isArray(h==null?void 0:h.perHole)?h.perHole:Array.isArray(h==null?void 0:h.pointsPerHole)?h.pointsPerHole:null;if(p)for(let y=0;y<s;y++){const w=Number(p[y]);Number.isFinite(w)&&(i[y]+=w,a[y]+=1)}}const o=i.map((h,p)=>a[p]?h/a[p]:NaN),c=o.filter(Number.isFinite),l=c.length?c.reduce((h,p)=>h+p,0)/c.length:NaN,u=o.map((h,p)=>({hole:p+1,avg:h,vsOverall:Number.isFinite(h)&&Number.isFinite(l)?h-l:NaN,samples:a[p]||0})).filter(h=>Number.isFinite(h.avg)&&h.samples>0).sort((h,p)=>h.avg-p.avg),d=u.filter(h=>Number.isFinite(h.vsOverall)&&h.vsOverall<=-.5);return{ok:!0,courseName:r.courseName||"",teeName:r.teeName||"",rounds:r.rounds.length,overallAvg:l,flagged:d,rows:u}}function cs(e,t){const r=e==null||e===""?NaN:Number(e);if(!Number.isFinite(r))return"";const s=t&&typeof t=="object"?t:{},i=Number.isFinite(s.min)?s.min:0,a=Number.isFinite(s.max)?s.max:Number.isFinite(s.dp)?s.dp:i,o=s.sign===!0;try{const l=new Intl.NumberFormat(void 0,{minimumFractionDigits:i,maximumFractionDigits:a}).format(r);return o&&r>0?`+${l}`:l}catch{const c=a,l=c?r.toFixed(c):String(Math.round(r));return o&&r>0?`+${l}`:l}}function Bw(e,t=2){const r=Number(e);if(!Number.isFinite(r))return"";const s=Math.abs(r),i=s>0&&s<.01?3:t;return(r>0?"+":"")+r.toFixed(i)}function Zl(e){const t=Ve(e==null?void 0:e.holes,NaN),r=Ve(e==null?void 0:e.pts,NaN);return!Number.isFinite(t)||t<=0||!Number.isFinite(r)?NaN:r/t}function ec(e){const t=Ve(e==null?void 0:e.holes,NaN),r=Ve(e==null?void 0:e.val,NaN);return!Number.isFinite(t)||t<=0||!Number.isFinite(r)?NaN:r/t}function Hw(e,t,r){const s=Number(t),i=Number(r);return!Number.isFinite(s)||!Number.isFinite(i)?NaN:String(e)==="gross"?i-s:s-i}function ea({scoringMode:e,dim:t,mapObj:r,fieldObj:s,limit:i}){const a=String(e)==="gross",o=[],c=Object.keys(r||{});for(const u of c){const d=r==null?void 0:r[u],x=s==null?void 0:s[u],h=Ve(d==null?void 0:d.holes,0);if(!h)continue;const p=a?ec(d):Zl(d),y=a?ec(x):Zl(x);let w=String(u);t==="SI"&&(w=`SI ${u}`),t==="Par"&&(w=String(u)),o.push({key:String(u),label:w,holes:h,playerAvg:p,fieldAvg:y})}const l=u=>{const d=String(u).match(/(-?\d+\.?\d*)/);return d?Number(d[1]):NaN};if(t==="Par"){const u={"Par 3":1,"Par 4":2,"Par 5":3,Unknown:9};o.sort((d,x)=>(u[d.key]||99)-(u[x.key]||99))}else if(t==="SI"){const u={"16":1,"712":2,"1318":3,Unknown:9,"1-6":1,"7-12":2,"13-18":3};o.sort((d,x)=>(u[d.key]||99)-(u[x.key]||99))}else o.sort((u,d)=>{const x=l(u.key),h=l(d.key);return Number.isFinite(x)&&Number.isFinite(h)&&x!==h?x-h:u.key.localeCompare(d.key)});return Number.isFinite(Number(i))&&Number(i)>0&&o.length>Number(i)?(o.sort((u,d)=>(d.holes||0)-(u.holes||0)),o.slice(0,Number(i))):o}function zw(e){if(!e||!e.length)return new Array(18).fill(NaN);let t=-1;for(let i=0;i<e.length;i++)if(String(e[i]).trim().toLowerCase()==="stableford"){t=i;break}if(t<0)return new Array(18).fill(NaN);const r=t+2;return xh(e,r,{min:0,max:6,intMode:!1,pickupAsZero:!0})}function qw(e){if(!e||!e.length)return new Array(18).fill(NaN);let t=-1;for(let i=0;i<e.length;i++)if(String(e[i]).trim().toLowerCase()==="best ball"){t=i;break}if(t<0)return new Array(18).fill(NaN);const r=t+2;return xh(e,r,{min:0,max:6,intMode:!1,pickupAsZero:!0})}function Gw(e,t){let r="";const s=[];let i=t+1;for(;i<e.length;){const a=e[i]||[],o=(a[0]||"").trim().toLowerCase();if(!o){i++;continue}if(o==="courselayout")break;if(o==="course"){r=(a[1]||"").trim()||r,i++;continue}if(o==="tee"){const c=(a[1]||"").trim(),u=(a[2]||"").trim().toUpperCase()==="F"?"F":"M",d=e[i+1]||[];if((d[0]||"").trim().toLowerCase()!=="hole"){i++;continue}const h=d.findIndex(f=>String(f).trim().toLowerCase()==="par"),p=d.findIndex(f=>String(f).trim().toLowerCase()==="yards"),y=d.findIndex(f=>String(f).trim().toLowerCase()==="si");if(p<0||h<0||y<0){i+=2;continue}const w=Array(18).fill(null).map((f,m)=>({hole:m+1,par:0,yards:0,si:0}));let N=i+2;for(;N<e.length;){const f=e[N]||[],m=(f[0]||"").trim().toLowerCase();if(!m||m==="tee"||m==="course"||m==="courselayout")break;const v=parseInt(f[0],10);if(!Number.isFinite(v)||v<1||v>18)break;w[v-1]={hole:v,par:parseInt(f[h]||"0",10),yards:parseInt(f[p]||"0",10),si:parseInt(f[y]||"0",10)},N++}s.push({teeName:c,gender:u,pars:w.map(f=>f.par),yards:w.map(f=>f.yards),si:w.map(f=>f.si)}),i=N;continue}i++}return s.length?{courseName:r,tees:s}:null}function Ww(e,t){let r=-1;for(let w=t+1;w<e.length;w++){const f=((e[w]||[])[0]||"").trim().toLowerCase();if(f){if(f==="courselayout")break;if(f==="hole"){r=w;break}}}if(r<0)return null;const s=e[r].map(w=>String(w||"")),i=w=>w.replace(/\s+/g,"").toLowerCase(),a=s.findIndex(w=>i(w)==="mensyards"),o=s.findIndex(w=>i(w)==="menspar"),c=s.findIndex(w=>i(w)==="menssi"),l=s.findIndex(w=>i(w)==="womensyards"||i(w)==="ladiesyards"),u=s.findIndex(w=>i(w)==="womenspar"||i(w)==="ladiespar"),d=s.findIndex(w=>i(w)==="womenssi"||i(w)==="ladiessi");if(a<0||o<0||c<0)return null;const x=Array(18).fill(null).map((w,N)=>({hole:N+1,par:0,yards:0,si:0})),h=Array(18).fill(null).map((w,N)=>({hole:N+1,par:0,yards:0,si:0}));let p=r+1;for(;p<e.length;){const w=e[p]||[],N=(w[0]||"").trim().toLowerCase();if(!N||N==="courselayout")break;const f=parseInt(w[0],10);if(!Number.isFinite(f)||f<1||f>18)break;x[f-1]={hole:f,par:parseInt(w[o]||0),yards:parseInt(w[a]||0),si:parseInt(w[c]||0)},u>=0&&(h[f-1]={hole:f,par:parseInt(w[u]||0),yards:parseInt(w[l]||0),si:parseInt(w[d]||0)}),p++}const y=[{teeName:"Men",gender:"M",pars:x.map(w=>w.par),yards:x.map(w=>w.yards),si:x.map(w=>w.si)}];return u>=0&&h.some(w=>w.par>0)&&y.push({teeName:"Women",gender:"F",pars:h.map(w=>w.par),yards:h.map(w=>w.yards),si:h.map(w=>w.si)}),{courseName:"",tees:y}}function Vw(e){let t=-1;for(let s=0;s<e.length;s++)if((e[s][0]||"").trim().toLowerCase()==="courselayout"){t=s;break}if(t<0)return null;let r=!1;for(let s=t+1;s<e.length;s++){const i=(e[s][0]||"").trim().toLowerCase();if(i==="tee"){r=!0;break}if(i==="courselayout")break}return r?Gw(e,t):Ww(e,t)}function en(e,t){if(!t||!t.length)return null;const r=(e.teeLabel||"").toLowerCase(),s=(e.gender||"M").toUpperCase();if(r){let a=t.find(o=>(o.teeName||"").toLowerCase()===r);if(a||(a=t.find(o=>{const c=(o.teeName||"").toLowerCase();return c&&(c.includes(r)||r.includes(c))}),a))return a}return t.find(a=>(a.gender||"M").toUpperCase()===s)||null}function ul(e){const r=e.replace(/\r/g,"").split(`
`).map(Ow);let s="",i=-1;for(let $=0;$<r.length;$++){const R=r[$].join("").toLowerCase();if(R.includes("hole 1")&&R.includes("hole 18")){i=$;break}}if(i>0)for(let $=i-1;$>=0;$--){const R=(r[$][0]||"").trim();if(R&&!/round\s*\d+/i.test(R)&&!/stableford|strokeplay/i.test(R)){const U=(r[$]||[]).join(" "),D=/\b(?:jan|feb|mar|apr|may|jun|jul|aug|sep|sept|oct|nov|dec)\b/i.test(U)&&/\b20\d{2}\b/.test(U),A=$>0?String(r[$-1]&&r[$-1][0]||"").trim():"";let W=R;D&&A&&!/round\s*\d+/i.test(A)&&!/stableford|strokeplay/i.test(A)&&(W=/[a-z]$/.test(A)&&/^[a-z]/.test(R)?A+R:A+" "+R),s=W;break}}let a=null,o=null;for(let $=0;$<r.length;$++){const R=r[$],U=String(R[0]||"").trim().toLowerCase();if(U==="s.i."||U==="si"||U==="s.i"){const D=[];for(let A=3;A<R.length;A++){const W=parseInt(String(R[A]||"").trim(),10);Number.isNaN(W)||D.push(W)}D.length>=19?o=D.slice(0,9).concat(D.slice(10,19)):D.length===18&&(o=D.slice(0,18))}}for(let $=0;$<r.length;$++){const R=r[$];if((R[0]||"").trim().toLowerCase()==="par"){const U=[];for(let D=3;D<R.length;D++){const A=parseInt(String(R[D]||"").trim(),10);Number.isNaN(A)||U.push(A)}U.length>=19?a=U.slice(0,9).concat(U.slice(10,19)):U.length===18&&(a=U.slice(0,18));break}}let c=null;try{c=Vw(r)}catch{}const l=c&&c.tees?c.tees.map($=>{let R=$.pars||[];return(!R||R.length!==18||R.every(U=>!U))&&a&&a.length===18&&(R=a.slice()),{teeName:$.teeName||"",gender:($.gender||"M").toUpperCase(),pars:R,yards:$.yards||[],si:$.si&&$.si.length===18?$.si:o&&o.length===18?o.slice():[]}}):[],u=$=>{const R=String($||"").trim().toLowerCase();return R?R==="m"||R==="male"||R==="man"||R==="men"||R==="gents"||R==="gent"?"M":R==="f"||R==="female"||R==="woman"||R==="women"||R==="ladies"||R==="lady"?"F":"":""},d=($,R)=>{const U=($||[]).map(D=>String(D||"").trim().toLowerCase());for(const D of R){const A=U.findIndex(W=>W===D||W.replace(/\s+/g,"")===D.replace(/\s+/g,""));if(A>=0)return A}return-1};let x=-1,h=0,p=1,y=-1,w=-1;for(let $=0;$<r.length;$++){const R=r[$];if(!R||!R.length)continue;const U=d(R,["name","player","player name","playername"]),D=d(R,["hdcp","handicap","hcp"]);if(U>=0&&D>=0){x=$,h=U,p=D,y=d(R,["gender","sex"]),w=d(R,["tee","teelabel","tee label","tee name","teename"]);break}}const N=[];if(x>=0)for(let $=x+1;$<r.length;$++){const R=r[$];if(!R)break;const U=(R[h]||"").trim();if(!U)break;if(Yt(U)||/^player$/i.test(U))continue;const D=parseFloat(String(R[p]||"").trim());if(Number.isNaN(D))continue;const A=y>=0?u(R[y]):"",W=w>=0?String(R[w]||"").trim():"";N.push({name:U,handicap:D,gender:A||"M",teeLabel:W||""})}const f={},m={},v=$=>{const R=String($||"").trim();if(!R||/^[+-]?\d+(?:\.\d+)?$/.test(R))return!1;const U=R.toLowerCase();return/tee|white|yellow|red|blue|black|green|gold|silver|champ|championship|mens|men|gents|ladies|women|forward|back/.test(U)};for(let $=0;$<r.length;$++){const R=r[$];if(!R)continue;const U=(R[0]||"").trim();if(U){for(let D=1;D<=4;D++){const A=(R[D]||"").trim();if(!A)continue;v(A)&&!m[U]&&(m[U]=A);const W=A.toLowerCase();/women|ladies/.test(W)&&(f[U]="F")}f[U]==null&&(f[U]="M")}}for(const $ of N)!$.gender&&f[$.name]&&($.gender=f[$.name]),!$.teeLabel&&m[$.name]&&($.teeLabel=m[$.name]);typeof window<"u"&&window.__SMART_ODDS_DEBUG&&console.log("[PARSE CSV PLAYERS]",{count:N.length,sample:N.slice(0,5).map($=>({name:$.name,handicap:$.handicap,gender:$.gender,teeLabel:$.teeLabel}))});let E=l;if((!E||!E.length)&&a&&a.length===18){const $=Array.from(new Set(N.map(U=>String(U.teeLabel||"").trim()).filter(Boolean)));E=($.length?$:["Default tee"]).map(U=>({teeName:U,gender:/women|ladies|red\b/.test(String(U).toLowerCase())?"F":"M",pars:a.slice(),yards:[],si:o&&o.length===18?o.slice():[]}))}let C=-1;for(let $=0;$<r.length;$++)if((r[$][0]||"").trim().toLowerCase()==="stableford"){C=$;break}const T={};if(C>=0)for(let $=C+2;$<r.length;$++){const R=r[$];if(!R)break;const U=(R[0]||"").trim();if(!U||U==="..."||/^round\s*\d+/i.test(U)||/^(player)$/i.test(U)||Yt(U))break;const D=[];for(let A=1;A<R.length;A++){const W=kt(R[A]);Number.isFinite(W)&&D.push(W)}D.length&&(T[U]=D[D.length-1],N.some(A=>A.name===U)||N.push({name:U,handicap:0,gender:f[U]||"M",teeLabel:m[U]||""}))}const B={},Y=N.map($=>($.name||"").trim()).filter(Boolean),le=($,R)=>{if(!$||($[0]||"").trim()!==R)return!1;const U=String($[1]||"").trim().toLowerCase();if(!U||!U.includes("tee"))return!1;let D=0;for(let A=3;A<$.length;A++){const W=String($[A]??"").trim();if(!W||W.includes(""))continue;const Fe=parseInt(W.replace(/[^0-9\-]/g,""),10);Number.isFinite(Fe)&&Fe>=1&&Fe<=19&&D++}return D>=6},J=($,R)=>Array.isArray($)&&$.some(U=>String(U||"").trim().toLowerCase()===R),De=$=>Array.isArray($)&&$.some(R=>String(R||"").trim().toLowerCase().replace(/\s+/g,"")==="bestball"),nt=$=>{const R=i>=0?i:0;for(let U=R;U<r.length;U++)if(le(r[U],$))return U;return-1},Ke=($,R)=>{var U;for(let D=$+1;D<r.length;D++){const A=(((U=r[D])==null?void 0:U[0])||"").trim();if(!A)continue;if(A!==R&&Y.includes(A)&&le(r[D],A))return D;const W=A.toLowerCase();if(W==="stableford"||W==="courselayout")return D}return r.length},He=($,R,U)=>{for(let D=$;D<R;D++){const A=r[D];if(U(A))return A}return null};for(const $ of N){const R=nt($.name);if(R<0){console.warn("[parseSquabbitCSV] Player block not found:",$.name),B[$.name]={perHole:Array(18).fill(0),back9:0,hcapCard:NaN,totalFromCard:NaN,grossPerHole:Array(18).fill(NaN),bestBallPerHole:null,bestBallHcapCard:NaN};continue}const U=Ke(R,$.name),D=r[R]||[],A=q=>{if(!q||!q.length)return new Array(18).fill(NaN);let L=-1;for(let Ee=0;Ee<q.length;Ee++)if(String(q[Ee]).trim().toLowerCase()==="gross"){L=Ee;break}let X=3;return L>=0&&(X=L+2),xh(q,X,{min:1,max:19,intMode:!0,pickupAsZero:!1})};let W=Array(18).fill(NaN),Fe=-1;for(let q=R+1;q<U;q++)if(J(r[q],"stableford")){Fe=q;break}const de=Fe>=0?r[Fe]:null;let oe=Array(18).fill(0),xe=NaN,Ye=NaN;if(de){oe=zw(de)||Array(18).fill(0);let q=-1;for(let L=0;L<de.length;L++)if(String(de[L]).trim().toLowerCase()==="stableford"){q=L;break}if(q>=0){xe=kt(de[q+1]);for(let L=de.length-1;L>q;L--){const X=kt(de[L]);if(Number.isFinite(X)){Ye=X;break}}}}const O=Fe>R&&r[Fe-1]||D;W=A(O)||Array(18).fill(NaN);const ht=He(R+1,U,q=>De(q));let Re=null,ne=NaN;if(ht){Re=qw(ht);let q=-1;for(let L=0;L<ht.length;L++)if(String(ht[L]||"").trim().toLowerCase().replace(/\s+/g,"")==="bestball"){q=L;break}q>=0&&(ne=kt(ht[q+1]))}const Ue=(oe||[]).slice(9).reduce((q,L)=>q+(Number(L)||0),0);B[$.name]={perHole:oe,back9:Ue,hcapCard:xe,totalFromCard:Ye,grossPerHole:W,bestBallPerHole:Re,bestBallHcapCard:ne}}const Ze=N.filter($=>$.name&&!/^player$/i.test($.name.trim())&&!Yt($.name)).map($=>{const R=B[$.name]||{};let U=Number.isFinite($.handicap)?$.handicap:NaN;(!Number.isFinite(U)||U<=0)&&(U=Number.isFinite(R.hcapCard)?R.hcapCard:0);let D=0;return Number.isFinite(T[$.name])?D=T[$.name]:Number.isFinite(R.totalFromCard)&&(D=R.totalFromCard),{name:$.name,gender:$.gender||f[$.name]||"M",teeLabel:$.teeLabel||m[$.name]||"",handicap:U,points:D,back9:R.back9||0,perHole:R.perHole||[],grossPerHole:R.grossPerHole||Array(18).fill(NaN),courseHandicap:Number.isFinite(R.hcapCard)?R.hcapCard:U,bestBallPerHole:R.bestBallPerHole||null,bestBallCourseHandicap:R.bestBallHcapCard,pars:a||null,sis:o||null}}),ce=s||(c?c.courseName:"");try{let $=function(D,A){const W=Math.max(0,Math.round(Number(D)||0)),Fe=Number(A);if(!Number.isFinite(Fe)||Fe<=0)return 0;const de=Math.floor(W/18),oe=W%18;return de+(oe>0&&Fe<=oe?1:0)},R=function(D,A,W){const Fe=Number.isFinite(Number(D))?Number(D):4,de=Number.isFinite(Number(W))?Number(W):1;return Fe+$(A,de)+2};const U=(()=>{let D=9;for(const A of Ze||[]){const W=Array.isArray(A==null?void 0:A.perHole)?A.perHole:null,Fe=Array.isArray(A==null?void 0:A.grossPerHole)?A.grossPerHole:null;for(let de=9;de<18;de++){const oe=W?Number(W[de]):NaN,xe=Fe?Number(Fe[de]):NaN;if(Number.isFinite(oe)||Number.isFinite(xe)){D=18;break}}if(D===18)break}return D})();for(const D of Ze||[]){const A=Array.isArray(D==null?void 0:D.perHole)?D.perHole.slice():new Array(18).fill(NaN),W=Array.isArray(D==null?void 0:D.grossPerHole)?D.grossPerHole.slice():new Array(18).fill(NaN),Fe=new Array(18).fill(!1);let de=!1;for(let O=0;O<U;O++){const ht=Number(A[O]),Re=Number(W[O]);if(Number.isFinite(ht)||Number.isFinite(Re)&&Re>0){de=!0;break}}if(!de){D.imputedMask=Fe,D.imputedGrossPerHole=W;continue}let oe=Array.isArray(D==null?void 0:D.pars)&&D.pars.length===18?D.pars:null,xe=Array.isArray(D==null?void 0:D.sis)&&D.sis.length===18?D.sis:null;if((!oe||!xe)&&Array.isArray(E)&&E.length){const O=String((D==null?void 0:D.teeLabel)||(D==null?void 0:D.tee)||"").trim().toLowerCase(),ht=String((D==null?void 0:D.gender)||"").trim().toUpperCase();let Re=E.find(ne=>String((ne==null?void 0:ne.teeName)||"").trim().toLowerCase()===O)||null;Re||(Re=E.find(ne=>String((ne==null?void 0:ne.gender)||"").toUpperCase()===ht)||E[0]),Re&&(!oe&&Array.isArray(Re.pars)&&Re.pars.length===18&&(oe=Re.pars),!xe&&Array.isArray(Re.sis)&&Re.sis.length===18&&(xe=Re.sis))}const Ye=Number.isFinite(Number(D==null?void 0:D.courseHandicap))?Number(D.courseHandicap):Number.isFinite(Number(D==null?void 0:D.handicap))?Number(D.handicap):0;for(let O=0;O<U;O++){const ht=Number(W[O]);if(!Number.isFinite(ht)||ht<=0){const Re=oe?oe[O]:4,ne=xe?xe[O]:O+1;W[O]=R(Re,Ye,ne),Fe[O]=!0,Number.isFinite(Number(A[O]))||(A[O]=0)}}D.perHole=A,D.grossPerHole=W,D.imputedMask=Fe,D.imputedGrossPerHole=W}}catch{}return{players:Ze,courseTees:E,courseName:ce}}function Qs({items:e}){return!e||!e.length?null:n.jsx("div",{className:"hide-print mb-3",children:n.jsx("div",{className:"flex flex-wrap items-center gap-1 text-xs text-neutral-500",children:e.map((t,r)=>n.jsxs("span",{className:"inline-flex items-center gap-1",children:[r>0&&n.jsx("span",{className:"text-neutral-300",children:"/"}),t.onClick?n.jsx("button",{className:"px-2 py-1 rounded-full bg-white/70 border border-squab-200 hover:bg-white transition",onClick:t.onClick,title:t.title,children:t.label}):n.jsx("span",{className:"px-2 py-1 rounded-full bg-neutral-100 border border-neutral-200",children:t.label})]},r))})})}function dl({active:e="progress",setView:t}){return null}function Kw({seasonModel:e,seasonPlayer:t,setSeasonPlayer:r,seasonYear:s,setSeasonYear:i,seasonLimit:a,setSeasonLimit:o,seasonYears:c,scoringMode:l,setScoringMode:u}){var w;const d=((e==null?void 0:e.players)||[]).filter(N=>N&&N.name&&!(typeof Yt=="function"&&Yt(N.name))),x=t||((w=d==null?void 0:d[0])==null?void 0:w.name)||"",h=s||"All",p=a||"All",y=l||"stableford";return[x||"",String(p).toLowerCase()==="all"?"All games":`Last ${p}`,String(h).toLowerCase()==="all"?"All years":String(h),y==="gross"?"Gross":"Stableford"].join("  "),null}function Yw({leagueHeaderTitle:e,eventName:t,statusMsg:r,courseName:s,view:i,setView:a}){return n.jsx("div",{className:"hide-print sticky top-0 z-40",style:{paddingTop:"env(safe-area-inset-top)"},children:n.jsx("div",{className:"glass-card app-topbar shadow-md",children:n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("h1",{className:"text-lg md:text-xl font-extrabold tracking-tight text-squab-900 truncate",children:e||"Den Society League  Ultimate Edition"}),n.jsx("div",{className:"text-[11px] text-neutral-500 truncate",children:t||"Untitled Event"})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[i!=="home"?n.jsxs("button",{className:"topbtn",onClick:()=>a("home"),title:"Back to Main Menu","aria-label":"Back to Main Menu",children:[n.jsx("span",{className:"ico",children:""}),"Home"]}):null,n.jsxs("span",{className:"topchip",children:[n.jsx("span",{className:"ico",children:""}),n.jsx("span",{className:"txt",children:t||"Untitled Event"})]})]})]})})})}function Jw({statusMsg:e,courseName:t}){const r=String(e||"").toLowerCase().includes("connected");return n.jsxs("div",{className:"status-mini","aria-label":"Connection status",children:[n.jsx("span",{className:"dot "+(r?"bg-emerald-500":"bg-rose-500"),"aria-hidden":"true"}),n.jsx("span",{className:"lbl",children:"Supabase"}),n.jsx("span",{className:"mono",children:e||""}),n.jsx("span",{className:"mx-2 text-neutral-300",children:""}),n.jsx("span",{className:"lbl",children:"Course"}),n.jsx("span",{className:t?"text-neutral-700":"text-neutral-400",children:t||""})]})}function on({setView:e,left:t=null,title:r=null,right:s=null}){return n.jsx("div",{className:"nav-wrap mb-4",children:n.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t,r?n.jsx("span",{className:"chip",children:r}):null]}),n.jsx("div",{className:"flex items-center gap-2",children:s})]})})}function X0({seasonsDef:e,seasonYear:t,setSeasonYear:r,leagueTitle:s}){var u;const i=d=>{const x=String(d&&d.label?d.label:"").trim(),h=String((d==null?void 0:d.season_id)??"").trim();let p=x;if(!p){const f=String((d==null?void 0:d.start_date)||(d==null?void 0:d.startDate)||"").slice(0,10),m=String((d==null?void 0:d.end_date)||(d==null?void 0:d.endDate)||"").slice(0,10),v=f?f.slice(0,4):"",E=m?m.slice(0,4):"";v&&E&&v!==E?p=`${v}-${E}`:v?p=v:p=h||""}const y=String(s||"Den Society League").trim(),w=p.toLowerCase(),N=y.toLowerCase();return y&&!w.includes(N)&&(p=`${y} ${p}`.trim()),p||h||""},a=(e||[]).map(d=>({id:String(d.season_id),label:i(d)})),o=String(t??""),c=(u=a[0])!=null&&u.id?String(a[0].id):"All",l=o&&(o.toLowerCase()==="all"||a.some(d=>d.id===o))?o:c;return ue.useEffect(()=>{const d=String(t??"");!(d&&(d.toLowerCase()==="all"||a.some(h=>h.id===d)))&&l&&l!==d&&r(l)},[e]),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs font-black tracking-widest uppercase text-neutral-500",children:"Season"}),n.jsxs("div",{className:"select-wrap",children:[n.jsxs("select",{className:"select-premium",value:String(l||""),onChange:d=>r(d.target.value),children:[n.jsx("option",{value:"All",children:"All"}),a.map(d=>n.jsx("option",{value:d.id,children:d.label},d.id))]}),n.jsx("svg",{className:"select-chevron",viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",children:n.jsx("path",{d:"M6 8l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]})}function Et({setView:e,hasEvent:t=!0}){const[r,s]=Q.useState(!1),i=Q.useRef(null);Q.useEffect(()=>{if(!r)return;const l=d=>{i.current&&(i.current.contains(d.target)||s(!1))},u=d=>{d.key==="Escape"&&s(!1)};return document.addEventListener("mousedown",l),document.addEventListener("touchstart",l,{passive:!0}),document.addEventListener("keydown",u),()=>{document.removeEventListener("mousedown",l),document.removeEventListener("touchstart",l),document.removeEventListener("keydown",u)}},[r]);const a=[{k:"event",label:" Game"},{k:"graphs",label:" Graphs"},{k:"scorecard",label:" Player Scorecard"},{k:"course_stats",label:" Course Stats"},{k:"ratings",label:" Ratings"},{sep:!0},{k:"banter",label:" Banter"},{k:"style",label:" Styles"},{k:"story",label:" Story"},{k:"replay",label:" Replay"},{k:"team_replay",label:" Teams"},{k:"casino",label:" Casino"},{k:"trophies",label:" Trophies"},{k:"partner",label:" Partners"},{k:"headtohead",label:" Rivalry"}],o=l=>{s(!1),e(l)},c=t?n.jsxs("div",{className:"relative z-[200]",ref:i,children:[n.jsx("button",{className:"btn-secondary",onClick:()=>s(l=>!l),"aria-haspopup":"menu","aria-expanded":r?"true":"false",title:"Open ingame menu",children:" Menu"}),r?n.jsxs("div",{className:"absolute left-0 mt-2 w-72 max-w-[85vw] rounded-2xl border border-squab-200 bg-white/95 shadow-xl backdrop-blur p-2 z-[200]",role:"menu",children:[n.jsx("div",{className:"px-2 pt-2 pb-1 text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Ingame tools"}),a.map((l,u)=>l.sep?n.jsx("div",{className:"my-2 h-px bg-neutral-200/80"},"sep"+u):n.jsxs("button",{className:"w-full text-left px-3 py-2 rounded-xl hover:bg-squab-50 active:bg-squab-100 transition flex items-center justify-between gap-3",onClick:()=>o(l.k),role:"menuitem",children:[n.jsx("span",{className:"font-extrabold text-neutral-900",children:l.label}),n.jsx("span",{className:"text-xs text-neutral-500",children:""})]},l.k)),n.jsx("div",{className:"mt-2 px-2 py-1 text-[11px] text-neutral-500",children:"League & Eclectic live on the Main Menu. Review Past Games and Guide are on Home."})]}):null]}):n.jsx("button",{className:"btn-secondary",onClick:()=>e("past"),children:" Review Your Past Games"});return n.jsx(on,{setView:e,left:c})}function Qw({activeRole:e,isSuperAdmin:t,setView:r,fileInputRef:s,importLocalCSV:i,runSeasonAnalysis:a,computed:o,addEventToSeason:c,removeEventFromSeason:l,clearSeason:u,user:d,handleLogin:x,handleLogout:h,handleSwitchSociety:p,openPlayersAdmin:y,visiblePlayersCount:w,totalPlayersCount:N}){const f=!!d,v=!!(d&&(d.is_admin||d.role==="admin"))?d.email||"Admin":"Not signed in",E=o&&(o.seasonEvents&&o.seasonEvents.length||o.events&&o.events.length||o.rounds&&o.rounds.length)||0,C=o&&(o.formatsCount||o.formats&&o.formats.length)||0,T=o&&(o.holesExplored||o.holeCount||o.holes&&o.holes.length)||0,B=E||C||T?`${E} rounds analyzed  ${C||0} formats  ${T||0} holes explored`:"Explore trends, surprises, and scoring patterns";return n.jsxs("section",{id:"player-report-top",className:"content-card",style:{padding:14},children:[n.jsx("style",{children:`
        /* Mobile menu CTA consistency (Home screen) */
        .hm-cta-row{ display:flex; flex-direction:column; gap:10px; align-items:stretch; margin-top:12px; }
        .hm-cta{ width:100%; justify-content:center; }
        .hm-stats{ font-size:12px; line-height:1.35; opacity:.92; }

        /* Make the smaller card action buttons behave like the main CTA on mobile */
        .hm-card-action{ display:flex; align-items:center; gap:10px; }
        .hm-linkbtn{ display:inline-flex; align-items:center; justify-content:center; white-space:nowrap; }
        @media (max-width: 640px){
          .hm-cta-row{ gap:12px; }
          .hm-cta{ width:100%; }
          .hm-card-inner{ display:flex; flex-direction:column; gap:12px; }
          .hm-card-action{ width:100%; }
          .hm-linkbtn{
            width:100%;
            padding:14px 16px;
            border-radius:18px;
            font-weight:900;
            letter-spacing:-0.01em;
            background: linear-gradient(180deg, rgba(255,212,75,1) 0%, rgba(245,166,35,1) 100%);
            color: rgba(23,17,0,0.96);
            box-shadow: 0 10px 24px rgba(0,0,0,0.18);
          }
          .hm-pill{ display:none; }
        }
        @media (min-width: 641px){
          .hm-cta-row{ flex-direction:row; align-items:center; justify-content:space-between; gap:12px; }
          .hm-cta{ width:auto; }
        }
      `}),n.jsx("style",{children:`
        /* Top sheet (front-most) gets the branded header + totals. Back sheets keep the subtle grid look. */
        .hm-sheet.s3{
          background-image:
            url("data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%22640%22%20height%3D%22360%22%20viewBox%3D%220%200%20640%20360%22%3E%0A%3Crect%20width%3D%22640%22%20height%3D%22360%22%20rx%3D%2212%22%20ry%3D%2212%22%20fill%3D%22rgba%28255%2C255%2C255%2C0.0%29%22/%3E%0A%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%22640%22%20height%3D%2256%22%20fill%3D%22rgba%2816%2C185%2C129%2C0.18%29%22/%3E%0A%3Ctext%20x%3D%2218%22%20y%3D%2226%22%20font-size%3D%2216%22%20font-family%3D%22Arial%22%20font-weight%3D%22900%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.70%29%22%3EChart%20Hills%3C/text%3E%0A%3Ctext%20x%3D%22622%22%20y%3D%2226%22%20font-size%3D%2216%22%20font-family%3D%22Arial%22%20font-weight%3D%22900%22%20text-anchor%3D%22end%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.70%29%22%3EBen%20Hogan%3C/text%3E%0A%3Ctext%20x%3D%2218%22%20y%3D%2246%22%20font-size%3D%2212%22%20font-family%3D%22Arial%22%20font-weight%3D%22700%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.55%29%22%3EStrokes%3A%2059%20%20%C2%B7%20%20Stableford%3A%2054%3C/text%3E%0A%3Cg%3E%0A%3Ctext%20x%3D%2260%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E6%3C/text%3E%3Ctext%20x%3D%22116%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E7%3C/text%3E%3Ctext%20x%3D%22172%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E8%3C/text%3E%3Ctext%20x%3D%22228%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E9%3C/text%3E%3Ctext%20x%3D%22284%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E1%3C/text%3E%3Ctext%20x%3D%22340%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E2%3C/text%3E%3Ctext%20x%3D%22396%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E3%3C/text%3E%3Ctext%20x%3D%22452%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E4%3C/text%3E%3Ctext%20x%3D%22508%22%20y%3D%2292%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E5%3C/text%3E%3Ctext%20x%3D%2260%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E9%3C/text%3E%3Ctext%20x%3D%22116%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E1%3C/text%3E%3Ctext%20x%3D%22172%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E2%3C/text%3E%3Ctext%20x%3D%22228%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E3%3C/text%3E%3Ctext%20x%3D%22284%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E4%3C/text%3E%3Ctext%20x%3D%22340%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E5%3C/text%3E%3Ctext%20x%3D%22396%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E6%3C/text%3E%3Ctext%20x%3D%22452%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E7%3C/text%3E%3Ctext%20x%3D%22508%22%20y%3D%22144%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E8%3C/text%3E%3Ctext%20x%3D%2260%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E3%3C/text%3E%3Ctext%20x%3D%22116%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E4%3C/text%3E%3Ctext%20x%3D%22172%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E5%3C/text%3E%3Ctext%20x%3D%22228%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E6%3C/text%3E%3Ctext%20x%3D%22284%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E7%3C/text%3E%3Ctext%20x%3D%22340%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E8%3C/text%3E%3Ctext%20x%3D%22396%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E9%3C/text%3E%3Ctext%20x%3D%22452%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E1%3C/text%3E%3Ctext%20x%3D%22508%22%20y%3D%22196%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E2%3C/text%3E%3Ctext%20x%3D%2260%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E6%3C/text%3E%3Ctext%20x%3D%22116%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E7%3C/text%3E%3Ctext%20x%3D%22172%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E8%3C/text%3E%3Ctext%20x%3D%22228%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E9%3C/text%3E%3Ctext%20x%3D%22284%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E1%3C/text%3E%3Ctext%20x%3D%22340%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E2%3C/text%3E%3Ctext%20x%3D%22396%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E3%3C/text%3E%3Ctext%20x%3D%22452%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E4%3C/text%3E%3Ctext%20x%3D%22508%22%20y%3D%22248%22%20font-size%3D%2218%22%20font-family%3D%22Arial%22%20fill%3D%22rgba%2815%2C23%2C42%2C0.35%29%22%3E5%3C/text%3E%0A%3C/g%3E%0A%3C/svg%3E"),
            linear-gradient(180deg, rgba(226,232,240,0.95) 0%, rgba(226,232,240,0.95) 16%, transparent 16%),
            repeating-linear-gradient(0deg, rgba(148,163,184,0.22) 0px, rgba(148,163,184,0.22) 1px, transparent 1px, transparent 12px),
            repeating-linear-gradient(90deg, rgba(148,163,184,0.18) 0px, rgba(148,163,184,0.18) 1px, transparent 1px, transparent 22px),
            linear-gradient(180deg, rgba(255,255,255,0.90), rgba(255,255,255,0.66));
          background-size: cover, auto, auto, auto, auto;
          background-blend-mode: normal, normal, normal, normal, normal;
        }
      `}),n.jsx("div",{className:"hm-stage",children:n.jsxs("div",{className:"hm-grid",children:[n.jsxs("div",{className:"hm-hero",children:[n.jsx("div",{className:"hm-glow"}),n.jsxs("div",{className:"hm-hero-inner",children:[n.jsxs("div",{children:[n.jsx("h2",{children:"Explore Your Games"}),n.jsx("p",{className:"hm-sub",children:"Dive into your rounds. Find patterns. Spot surprises."}),n.jsx("div",{style:{color:"rgba(255,255,255,0.84)",fontWeight:800,marginTop:8},children:"Inside youll find:"}),n.jsxs("div",{className:"hm-cta-row",children:[n.jsxs("button",{className:"hm-cta",onClick:()=>r("past"),children:[n.jsx("span",{className:"hm-arrow",children:""}),n.jsx("span",{children:"Enter Game Explorer"})]}),n.jsx("div",{className:"hm-stats",children:B})]}),n.jsx("div",{className:"hm-inline-menu","aria-label":"Menu options (visual)",children:n.jsxs("div",{className:"hm-inline-menu-grid",children:[n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Game"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Graphs"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Player Scorecard"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Course Stats"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Ratings"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Banter"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Styles"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Story"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Replay"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Teams"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Casino"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Trophies"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Partners"})]}),n.jsxs("div",{className:"hm-inline-item",children:[n.jsx("span",{className:"hm-ico",children:""}),n.jsx("span",{children:"Rivalry"})]})]})})]}),n.jsx("div",{className:"hm-hero-right",children:n.jsxs("div",{className:"hm-mini-stack","aria-hidden":"true",children:[n.jsx("div",{className:"hm-sheet s1"}),n.jsx("div",{className:"hm-sheet s2"}),n.jsx("div",{className:"hm-sheet s3"})]})})]})]}),n.jsx("button",{className:"hm-card heroish",onClick:()=>r("player_progress"),style:{textAlign:"left",cursor:"pointer"},children:n.jsxs("div",{className:"hm-card-inner",children:[n.jsxs("div",{style:{minWidth:0},children:[n.jsx("h3",{children:"Review & Improve"}),n.jsx("div",{className:"hm-desc",children:"Turn insight into better scores."}),n.jsxs("ul",{children:[n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"See what actually costs you points"})]}),n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"Find your biggest strengths vs the field"})]}),n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"Build simple game plans that work"})]})]})]}),n.jsxs("div",{className:"hm-card-action",children:[n.jsx("button",{className:"hm-linkbtn",onClick:Y=>{Y.stopPropagation(),r("player_progress")},children:n.jsx("span",{children:" Review Performance"})}),n.jsx("div",{className:"hm-pill",children:""})]})]})}),n.jsxs("div",{className:"hm-row2",children:[n.jsx("button",{className:"hm-card heroish",onClick:()=>r("standings"),style:{textAlign:"left",cursor:"pointer"},children:n.jsxs("div",{className:"hm-card-inner",children:[n.jsxs("div",{style:{minWidth:0},children:[n.jsx("h3",{children:"League Standings"}),n.jsx("div",{className:"hm-desc",children:"How the season is shaping up."}),n.jsxs("ul",{children:[n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"Current rankings"})]}),n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"Points gaps & momentum"})]}),n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"Whos climbing, whos slipping"})]})]})]}),n.jsxs("div",{className:"hm-card-action",children:[n.jsx("button",{className:"hm-linkbtn",onClick:Y=>{Y.stopPropagation(),r("standings")},children:n.jsx("span",{children:" View League"})}),n.jsx("div",{className:"hm-pill",children:""})]})]})}),n.jsx("button",{className:"hm-card heroish",onClick:()=>r("eclectic"),style:{textAlign:"left",cursor:"pointer"},children:n.jsxs("div",{className:"hm-card-inner",children:[n.jsxs("div",{style:{minWidth:0},children:[n.jsx("h3",{children:"Eclectic"}),n.jsx("div",{className:"hm-desc",children:"Your best golf, stitched together."}),n.jsxs("ul",{children:[n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"Best score on every hole"})]}),n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"What your perfect round looks like"})]}),n.jsxs("li",{children:[n.jsx("span",{className:"hm-ico2",children:""}),n.jsx("span",{children:"Where improvement still lives"})]})]})]}),n.jsxs("div",{className:"hm-card-action",children:[n.jsx("button",{className:"hm-linkbtn",onClick:Y=>{Y.stopPropagation(),r("eclectic")},children:n.jsx("span",{children:" View Eclectic"})}),n.jsx("div",{className:"hm-pill",children:""})]})]})})]}),n.jsx("button",{className:"hm-admin",onClick:()=>r("admin"),style:{textAlign:"left",cursor:"pointer"},children:n.jsxs("div",{className:"hm-admin-inner",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"hm-admin-title",children:[n.jsx("span",{className:"hm-gear",children:""}),n.jsx("span",{children:"Admin"})]}),n.jsxs("div",{className:"hm-admin-sub",children:["Settings, imports, season setup, players",N!=null?`  Players: ${w}/${N}`:"",f?`  Signed in as ${v}`:""]})]}),n.jsx("div",{className:"hm-pill",style:{background:"rgba(255,255,255,0.10)",borderColor:"rgba(255,255,255,0.18)"},children:""})]})}),n.jsx("div",{className:"hm-foot",children:"Most players discover something new every time they explore their games. "})]})})]})}function Xw({activeRole:e,isSuperAdmin:t,setView:r,fileInputRef:s,importLocalCSV:i,computed:a,addEventToSeason:o,removeEventFromSeason:c,clearSeason:l,user:u,handleLogin:d,handleLogout:x,handleSwitchSociety:h,openPlayersAdmin:p,visiblePlayersCount:y,totalPlayersCount:w}){const N=String(e||"").toLowerCase(),f=!!u&&(t||N==="admin"||N==="captain"),m=f?u.email||"Admin":"Not signed in",v=!!(a&&a.length);return n.jsxs("section",{className:"content-card p-4 md:p-6 hm-stage",children:[n.jsx(on,{setView:r,title:"Admin",left:n.jsx("button",{className:"btn-secondary",onClick:()=>r("home"),children:" Home"})}),n.jsx("div",{className:"glass-card p-4 border border-neutral-200",children:n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Access"}),n.jsx("div",{className:"mt-1 text-sm font-extrabold text-neutral-900 truncate",children:m}),n.jsx("div",{className:"text-xs text-neutral-500",children:"Sign in to upload/delete events and edit season standings."})]}),n.jsx("div",{className:"flex flex-wrap items-center gap-2",children:f?n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"btn-secondary",onClick:h,children:"Switch Society"}),n.jsx("button",{className:"btn-secondary",onClick:x,children:"Sign Out"})]}):n.jsx("button",{className:"btn-primary",onClick:d,children:"Sign In"})})]})}),n.jsxs("div",{className:"mt-4 grid md:grid-cols-2 gap-3",children:[n.jsx("button",{className:"btn-primary w-full "+(f?"":"opacity-50 cursor-not-allowed"),onClick:()=>f&&s.current&&s.current.click(),disabled:!f,title:f?"Load a new CSV event":"Sign in first",children:" Import New Games"}),n.jsxs("div",{className:"glass-card p-3 border border-neutral-200",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Loaded event"}),n.jsx("div",{className:"mt-1 text-sm font-extrabold text-neutral-900",children:v?"Ready":"None loaded"}),n.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:v?"You can add/remove this event from the season.":"Load an event before using Add/Remove."})]})]}),n.jsx("input",{ref:s,type:"file",accept:".csv",className:"hidden",onChange:async E=>{var B;const C=(B=E.target.files)==null?void 0:B[0];if(!C)return;const T=await C.text();i(T,C.name,C),E.target.value=""}}),n.jsxs("div",{className:"mt-4 grid md:grid-cols-3 gap-3",children:[n.jsx("button",{className:"btn-primary w-full "+(!f||!v?"opacity-50 cursor-not-allowed":""),onClick:()=>f&&v&&o&&o(),disabled:!f||!v,title:f?v?"Uploads the loaded event and updates standings":"Load an event first":"Sign in first",children:" Add Event to Season"}),n.jsx("button",{className:"btn-secondary w-full "+(v?"":"opacity-50 cursor-not-allowed"),onClick:()=>v&&c&&c(),disabled:!v,title:v?"Removes the loaded event's points from season standings":"Load an event first",children:" Remove Loaded Event"}),n.jsx("button",{className:"btn-secondary w-full "+(f?"":"opacity-50 cursor-not-allowed"),onClick:()=>f&&l&&l(),disabled:!f,title:f?"Deletes ALL season standings rows":"Sign in first",children:" Delete Season"})]}),n.jsx("div",{className:"mt-4 glass-card p-4 border border-neutral-200",children:n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Players"}),n.jsx("div",{className:"mt-1 text-sm font-extrabold text-neutral-900",children:"Manage Players"}),n.jsxs("div",{className:"text-xs text-neutral-500",children:["Show/hide players across leaderboards & reports.",Number.isFinite(y)&&Number.isFinite(w)&&w?n.jsxs("span",{className:"ml-2",children:["Showing ",n.jsx("span",{className:"font-black",children:y})," / ",n.jsx("span",{className:"font-black",children:w})]}):null]})]}),n.jsx("div",{className:"flex flex-wrap items-center gap-2",children:n.jsx("button",{className:"btn-primary "+(f?"":"opacity-50 cursor-not-allowed"),onClick:()=>f&&p&&p(),disabled:!f,title:f?"Choose which players are included for everyone":"Sign in first",children:" Manage Players"})})]})}),n.jsx("div",{className:"mt-3 text-xs text-neutral-500",children:"Tip: League & Eclectic are public  Admin is only for captains."})]})}function Zw({sharedGroups:e,loadShared:t,setView:r}){function s(N){let f=2166136261;for(let m=0;m<N.length;m++)f^=N.charCodeAt(m),f=Math.imul(f,16777619);return f>>>0}function i(N){try{return Number.isFinite(N)?new Date(N).toLocaleDateString("en-GB",{timeZone:"UTC",year:"numeric",month:"short",day:"2-digit"}):""}catch{return""}}function a(N){const f=s(N||"golf"),m=95+f%40,v=190+(f>>5)%40,E=35+(f>>9)%25,C=18+(f>>12)%14,T=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 360">
  <defs>
    <linearGradient id="sky" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="hsl(${v} 55% 72%)"/>
      <stop offset="1" stop-color="hsl(${v} 45% 86%)"/>
    </linearGradient>
    <linearGradient id="grass" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="hsl(${m} 45% 34%)"/>
      <stop offset="1" stop-color="hsl(${m} 55% 22%)"/>
    </linearGradient>
    <radialGradient id="sun" cx="78%" cy="22%" r="55%">
      <stop offset="0" stop-color="hsla(${E} 95% 75% .55)"/>
      <stop offset=".55" stop-color="hsla(${E} 95% 75% .18)"/>
      <stop offset="1" stop-color="hsla(${E} 95% 75% 0)"/>
    </radialGradient>
    <filter id="grain" x="-20%" y="-20%" width="140%" height="140%">
      <feTurbulence type="fractalNoise" baseFrequency=".9" numOctaves="2" stitchTiles="stitch"/>
      <feColorMatrix type="matrix" values="
        1 0 0 0 0
        0 1 0 0 0
        0 0 1 0 0
        0 0 0 .08 0"/>
    </filter>
  </defs>

  <rect width="640" height="360" fill="url(#sky)"/>
  <rect width="640" height="360" fill="url(#sun)"/>
  <path d="M0 ${170-C} C 110 ${155-C}, 240 ${190-C}, 330 ${175-C} C 450 ${155-C}, 530 ${195-C}, 640 ${180-C} L 640 360 L 0 360 Z"
        fill="url(#grass)"/>
  <path d="M-40 360 C 110 ${280+C}, 210 ${230+C}, 340 ${240+C} C 480 ${255+C}, 540 ${310+C}, 700 360 L 700 420 L -40 420 Z"
        fill="hsla(${m} 55% 46% .35)"/>
  <path d="M60 360 C 160 ${310+C}, 250 ${245+C}, 330 ${250+C} C 430 ${258+C}, 500 ${315+C}, 610 360"
        stroke="hsla(${m} 70% 62% .45)" stroke-width="16" stroke-linecap="round" fill="none"/>
  <path d="M86 360 C 175 ${312+C}, 255 ${260+C}, 330 ${258+C} C 420 ${265+C}, 490 ${322+C}, 585 360"
        stroke="hsla(${m} 65% 78% .25)" stroke-width="10" stroke-linecap="round" fill="none"/>
  <circle cx="520" cy="260" r="22" fill="hsla(0 0% 100% .22)"/>
  <circle cx="520" cy="260" r="10" fill="hsla(0 0% 100% .25)"/>
  <g opacity=".9">
    <rect x="118" y="146" width="3" height="86" rx="1.5" fill="hsla(0 0% 100% .65)"/>
    <path d="M121 148 L 165 158 L 121 170 Z" fill="hsla(${E} 95% 62% .9)"/>
  </g>
  <rect width="640" height="360" filter="url(#grain)" opacity=".55"/>
</svg>`;return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(T)}const o=ue.useRef(new Map),[c,l]=ue.useState(!1);ue.useEffect(()=>{let N=!1;async function f(){const m=new Set;e.forEach(v=>{v.events.forEach(E=>{const C=(E.courseName||E.name||"").replace(/\.csv$/i,""),T=d(C);T&&m.add(T)})});for(const v of m)o.current.has(v)||await x(v);N||l(!0)}return f(),()=>{N=!0}},[e]);const u=ue.useRef(new Map);function d(N){return(N||"").toLowerCase().replace(/\b(19|20)\d{2}\b/g,"").replace(/\b(golf\s*club|golf|club)\b/g,"").replace(/\bgc\b/g,"").replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/(^-|-$)/g,"").trim()}async function x(N){const f=(N||"").trim();if(!f)return null;const m=o.current;if(m.has(f))return m.get(f);const v=u.current;if(v.has(f))return await v.get(f);const E=(async()=>{try{if(!window.__supabase_client__)return null;const C=window.__supabase_client__,{data:T,error:B}=await C.from("courses").select("photo_urls").eq("slug",f).maybeSingle();if(B)return null;const Y=Array.isArray(T==null?void 0:T.photo_urls)?T.photo_urls:null;return m.set(f,Y),Y}catch{return null}finally{v.delete(f)}})();return v.set(f,E),await E}function h(N,f){if(!N||N.length===0)return null;const m=s(f||"golf");return N[m%N.length]}const[p,y]=ue.useState(0);function w(){y(N=>(N+1)%1e6)}return n.jsxs("section",{className:"rounded-2xl p-3 md:p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Qs,{items:[{label:"Analyse Game"}]}),n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("h2",{className:"text-lg font-semibold text-squab-900",children:"Analyse Game"})}),e.length===0&&n.jsx("div",{className:"text-sm text-neutral-600 p-2",children:"No shared CSVs yet."}),n.jsx("div",{className:"text-xs text-neutral-500 mb-3",children:"Pick an event by course image (name + date). No more boring filenames."}),e.map(N=>n.jsxs("div",{className:"mb-5",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-500",children:N.year}),n.jsxs("div",{className:"text-[11px] text-neutral-400",children:[N.events.length," event",N.events.length===1?"":"s"]})]}),n.jsx("div",{className:"event-grid",children:N.events.map(f=>{const m=(f.courseName||f.name||"").replace(/\.csv$/i,""),v=i(f.dateMs),E=(m||"")+"|"+String(f.dateMs||"")+"|"+String(f.path||"");let C=a(E);const T=d(m);console.log("COURSE:",m,"=> SLUG IT SEARCHES:",T);const B=o.current.get(T),Y=h(B,E);return Y?C=Y:T&&!u.current.has(T)&&!o.current.has(T)&&x(T).then(()=>w()),n.jsxs("button",{className:"event-card",onClick:async()=>{await t(f),r("event")},title:(v?v+"  ":"")+m,children:[n.jsx("div",{className:"event-thumb",style:{backgroundImage:`url("${C}")`}}),n.jsxs("div",{className:"event-overlay",children:[n.jsx("div",{className:"event-title",children:m||"Event"}),n.jsxs("div",{className:"event-meta",children:[n.jsx("span",{className:"pill-mini",children:v||"Date unknown"}),n.jsx("span",{className:"pill-mini subtle",children:(f.format||"").toUpperCase()||"ROUND"})]})]})]},f.path)})})]},N.year))]})}function eN({computed:e,courseTees:t,setView:r}){const[s,i]=Q.useState("");Q.useEffect(()=>{!s&&e&&e.length&&i(e[0].name)},[e,s]);const a=Q.useMemo(()=>gs(e),[e]);if(!e||!e.length)return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(on,{setView:r,title:"Player Scorecard",left:n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)})}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to see player scorecards."})]});const o=e.map(f=>f.name),c=e.find(f=>f.name===s)||e[0],l=en(c,t),u=Array.isArray(c.grossPerHole)?c.grossPerHole:Array(18).fill(NaN),d=Array.isArray(c.imputedMask)?c.imputedMask:Array(18).fill(!1),x=Array.isArray(c.perHole)?c.perHole:Array(18).fill(NaN),h=l&&Array.isArray(l.pars)&&l.pars.length===18?l.pars:Array(18).fill(""),p=l&&Array.isArray(l.yards)&&l.yards.length===18?l.yards:Array(18).fill(""),y=l&&Array.isArray(l.si)&&l.si.length===18?l.si:Array(18).fill(""),w=u.reduce((f,m)=>Number.isFinite(m)?f+m:f,0),N=x.reduce((f,m)=>Number.isFinite(Number(m))?f+Number(m):f,0);return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(on,{setView:r,title:"Player Scorecard",left:n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)})}),n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs text-neutral-600",children:"Player"}),n.jsx("select",{className:"rounded-2xl border border-squab-200 px-3 py-2 bg-white text-sm min-w-[220px]",value:c.name,onChange:f=>i(f.target.value),children:o.map(f=>n.jsx("option",{value:f,children:f},f))}),n.jsxs("div",{className:"text-[11px] text-neutral-500 mt-1",children:["Tee: ",n.jsx("span",{className:"font-semibold",children:c.teeLabel||(l?l.teeName:"")})]})]}),n.jsxs("div",{className:"flex gap-3 flex-wrap",children:[n.jsxs("div",{className:"px-3 py-2 rounded-2xl bg-white border border-squab-200",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Gross"}),n.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:w||""})]}),n.jsxs("div",{className:"px-3 py-2 rounded-2xl bg-white border border-squab-200",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Stableford"}),n.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:N||""})]})]})]}),l?null:n.jsx("div",{className:"p-3 rounded-2xl bg-amber-50 border border-amber-200 text-amber-900 text-sm",children:"No matching tee layout found for this player. Yards/SI may be blank."}),n.jsx("div",{className:"overflow-auto table-wrap",children:n.jsxs("table",{className:"min-w-full text-xs md:text-sm table-zebra",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-squab-200 bg-squab-50 text-left",children:[n.jsx("th",{children:"Hole"}),n.jsx("th",{className:"text-right px-3",children:"Par"}),n.jsx("th",{className:"text-right px-3",children:"Yards"}),n.jsx("th",{className:"text-right px-3",children:"SI"}),n.jsx("th",{className:"text-right px-3 border-l border-squab-200 pl-4",children:"Gross"}),n.jsx("th",{className:"text-right px-3",children:"Pts"})]})}),n.jsx("tbody",{children:Array.from({length:a},(f,m)=>n.jsxs("tr",{className:"border-b",children:[n.jsx("td",{children:m+1}),n.jsx("td",{className:"text-right px-3 tabular-nums",children:h[m]??""}),n.jsx("td",{className:"text-right px-3 tabular-nums",children:p[m]??""}),n.jsx("td",{className:"text-right px-3 tabular-nums",children:y[m]??""}),n.jsx("td",{className:"text-right px-3 tabular-nums border-l border-squab-200 pl-4 font-extrabold",children:(()=>{const v=u[m];return!!d[m]&&Number.isFinite(v)?n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-lg border border-amber-200 bg-amber-50 text-amber-900",children:[n.jsx("span",{className:"tabular-nums",children:v}),n.jsx("span",{className:"text-[10px] font-black uppercase tracking-wide",children:"NDB"})]}):Number.isFinite(v)?v:""})()}),n.jsx("td",{className:"text-right px-3 tabular-nums font-semibold",children:Number.isFinite(Number(x[m]))?Number(x[m]):""})]},m))})]})})]})}function tN({computed:e,setView:t,courseSlope:r,setCourseSlope:s,courseRating:i,setCourseRating:a,startHcapMode:o,setStartHcapMode:c,nextHcapMode:l,setNextHcapMode:u,seasonRoundsFiltered:d,seasonRoundsAll:x,seasonModelAll:h}){const[p,y]=Q.useState(!1),w=Q.useMemo(()=>{const N=(Array.isArray(e)?e:[]).filter(F=>F&&F.name),f=new Map;N.forEach(F=>{const G=Ot(String(F.name||""));G&&f.set(G,F)});const m=new Set,v=[],E=[],C=F=>{let G=Number((F==null?void 0:F.pts)??(F==null?void 0:F.points)??(F==null?void 0:F.stableford)??(F==null?void 0:F.sf)??(F==null?void 0:F.totalPoints)??(F==null?void 0:F.netPoints));if(!Number.isFinite(G)&&Array.isArray(F==null?void 0:F.perHole))try{G=F.perHole.reduce((H,Ne)=>H+(Number(Ne)||0),0)}catch{}return G};if(h&&Array.isArray(h.players)&&h.players.length){const F=new Map,G=[];for(const ae of h.players||[]){const ye=String((ae==null?void 0:ae.name)||"").trim(),Te=Ot(ye);if(!Te)continue;const et=Array.isArray(ae==null?void 0:ae.series)?ae.series:[];for(const Z of et){const ze=C(Z);if(!Number.isFinite(ze))continue;const it=Number.isFinite(Number(Z==null?void 0:Z.dateMs))?Number(Z.dateMs):null,ee=String((Z==null?void 0:Z.file)??""),ft=String((Z==null?void 0:Z.teeLabel)??(Z==null?void 0:Z.tee)??(Z==null?void 0:Z.tee_name)??(Z==null?void 0:Z.teeName)??"").toLowerCase().trim(),Rt=String((Z==null?void 0:Z.gender)??(Z==null?void 0:Z.sex)??(ae==null?void 0:ae.gender)??(ae==null?void 0:ae.sex)??"").toUpperCase(),rr=Rt==="F"||Rt==="FEMALE"||Rt==="W"||Rt==="WOMEN"?"F":"M",Fr=ft||rr,Gt=Number((Z==null?void 0:Z.hi)??(Z==null?void 0:Z.startExact)??(Z==null?void 0:Z.index)??(Z==null?void 0:Z.handicap)??(Z==null?void 0:Z.exact)??(ae==null?void 0:ae.hi)??(ae==null?void 0:ae.startExact));if(G.push({k:Te,name:ye,pts:ze,hi:Gt,dateMs:it,gender:rr,teeLabel:ft,groupKey:Fr,file:ee}),m.add(Te),ee){F.has(ee)||F.set(ee,{pts:[],byGroup:new Map,dateMs:it});const Wt=F.get(ee);Wt.pts.push(ze),Number.isFinite(it)&&!Number.isFinite(Number(Wt.dateMs))&&(Wt.dateMs=it),Wt.byGroup.has(Fr)||Wt.byGroup.set(Fr,[]),Wt.byGroup.get(Fr).push(ze)}}}const H=new Map,Ne=new Map;for(const[ae,ye]of F.entries()){const Te=ye.pts.length?ye.pts.reduce((et,Z)=>et+Z,0)/ye.pts.length:36;H.set(ae,Te),E.push({dateMs:Number.isFinite(Number(ye.dateMs))?Number(ye.dateMs):null,roundAvg:Te,n:ye.pts.length,file:ae});for(const[et,Z]of ye.byGroup.entries()){const ze=Z.length?Z.reduce((it,ee)=>it+ee,0)/Z.length:Te;Ne.set(ae+"|"+et,ze)}}for(const ae of G){const ye=ae.file?H.get(ae.file)??36:36,Te=ae.file?Ne.get(ae.file+"|"+ae.groupKey)??ye:ye;v.push({...ae,roundAvg:ye,groupAvg:Te})}}else(Array.isArray(x)?x:Array.isArray(d)?d:[]).forEach(G=>{const H=G&&G.parsed?G.parsed:G,Ne=H&&Array.isArray(H.players)?H.players:[],ae=Number.isFinite(G==null?void 0:G.dateMs)?G.dateMs:Number.isFinite(H==null?void 0:H.dateMs)?H.dateMs:null,ye=String((G==null?void 0:G.file)??(H==null?void 0:H.file)??""),Te=Ne.map(ee=>C(ee)).filter(Number.isFinite),et=Te.length?Te.reduce((ee,ft)=>ee+ft,0)/Te.length:36,Z=new Map,ze=new Map;for(const ee of Ne){const ft=C(ee);if(!Number.isFinite(ft))continue;const Rt=String((ee==null?void 0:ee.teeLabel)??(ee==null?void 0:ee.tee)??(ee==null?void 0:ee.tee_name)??(ee==null?void 0:ee.teeName)??"").toLowerCase().trim(),rr=String((ee==null?void 0:ee.gender)??(ee==null?void 0:ee.sex)??"").toUpperCase(),Gt=Rt||(rr==="F"||rr==="FEMALE"||rr==="W"||rr==="WOMEN"?"F":"M");Z.set(Gt,(Z.get(Gt)||0)+ft),ze.set(Gt,(ze.get(Gt)||0)+1)}const it=new Map;for(const[ee,ft]of Z.entries()){const Rt=ze.get(ee)||1;it.set(ee,ft/Rt)}Number.isFinite(ae)&&E.push({dateMs:ae,roundAvg:et,n:Te.length,file:ye}),Ne.forEach(ee=>{const ft=String((ee==null?void 0:ee.name)||(ee==null?void 0:ee.player)||(ee==null?void 0:ee.playerName)||"").trim(),Rt=Ot(ft);if(!Rt)return;const rr=C(ee),Fr=Number((ee==null?void 0:ee.startExact)??(ee==null?void 0:ee.index)??(ee==null?void 0:ee.hi)??(ee==null?void 0:ee.handicap)??(ee==null?void 0:ee.exact)??(ee==null?void 0:ee.hiExact)),Gt=String((ee==null?void 0:ee.teeLabel)??(ee==null?void 0:ee.tee)??(ee==null?void 0:ee.tee_name)??(ee==null?void 0:ee.teeName)??"").toLowerCase().trim(),Wt=String((ee==null?void 0:ee.gender)??(ee==null?void 0:ee.sex)??"").toUpperCase(),qr=Wt==="F"||Wt==="FEMALE"||Wt==="W"||Wt==="WOMEN"?"F":"M",Ut=Gt||qr,ns=it.get(Ut)??et;v.push({k:Rt,name:ft,pts:rr,hi:Fr,dateMs:ae,roundAvg:et,gender:qr,teeLabel:Gt,groupKey:Ut,groupAvg:ns,file:ye}),m.add(Rt)})});f.forEach((F,G)=>m.add(G));const T=new Map;for(const F of v)T.has(F.k)||T.set(F.k,[]),T.get(F.k).push(F);for(const F of T.values())F.sort((G,H)=>{const Ne=Number.isFinite(G.dateMs)?G.dateMs:-1/0,ae=Number.isFinite(H.dateMs)?H.dateMs:-1/0;return Ne-ae});const B=E.filter(F=>Number.isFinite(F==null?void 0:F.dateMs)&&Number.isFinite(F==null?void 0:F.roundAvg)).sort((F,G)=>F.dateMs-G.dateMs).slice(-20),Y=.9;let le=0,J=0;for(let F=0;F<B.length;F++){const G=B.length-1-F,H=Math.pow(Y,G);le+=H,J+=H*B[F].roundAvg}const De=le>0?J/le:36;let nt=0,Ke=0;for(let F=0;F<B.length;F++){const G=B.length-1-F,H=Math.pow(Y,G);nt+=H,Ke+=H*Math.pow(B[F].roundAvg-De,2)}const He=Math.max(.8,Math.min(4,nt>0?Math.sqrt(Ke/nt):1.6));let Ze=.75;try{let F=0,G=0,H=0;for(let Ne=0;Ne<v.length;Ne++){const ae=v[Ne],ye=Number(ae.hi),Te=Number(ae.pts)-Number(ae.roundAvg);!Number.isFinite(ye)||!Number.isFinite(Te)||(F+=1,G+=ye,H+=Te)}if(F>=20){G/=F,H/=F;let Ne=0,ae=0;for(let ye=0;ye<v.length;ye++){const Te=v[ye],et=Number(Te.hi),Z=Number(Te.pts)-Number(Te.roundAvg);if(!Number.isFinite(et)||!Number.isFinite(Z))continue;const ze=et-G,it=Z-H;Ne+=ze*ze,ae+=ze*it}Ne>1e-6&&(Ze=ae/Ne,Ze=Math.max(0,Math.min(2,Ze)))}}catch{}const ce=Array.from(m).map(F=>{const G=f.get(F),H=T.get(F)||[],Ne=G?String(G.name||""):H.length?String(H[H.length-1].name||""):"",ye=H.map(at=>{const Ge=Number(at.pts),lt=Number(at.groupAvg??at.roundAvg);return!Number.isFinite(Ge)||!Number.isFinite(lt)?null:{res:Ge-lt,pts:Ge,ra:lt,dateMs:at.dateMs,hi:at.hi,groupKey:at.groupKey,gender:at.gender,teeLabel:at.teeLabel}}).filter(Boolean).slice(-12),Te=.85;let et=0,Z=0;for(let at=0;at<ye.length;at++){const Ge=ye.length-1-at,lt=Math.pow(Te,Ge);et+=lt,Z+=lt*ye[at].res}const ze=et>0?Z/et:0,it=ye.length,ee=it/(it+6),ft=ze*ee;let Rt=0,rr=0;for(let at=0;at<ye.length;at++){const Ge=ye.length-1-at,lt=Math.pow(Te,Ge);Rt+=lt,rr+=lt*Math.pow(ye[at].res-ze,2)}const Fr=Rt>0?Math.sqrt(rr/Rt):3.8,Gt=Math.max(1.2,Math.min(7.5,Fr*(.6+.4*ee)+(1-ee)*3));let Wt=0;if(it>=3){let at=0,Ge=0,lt=0,Ie=0,Xe=0;for(let Nt=0;Nt<it;Nt++){const It=it-1-Nt,cr=Math.pow(Te,It),Wr=Nt,bs=ye[Nt].res;at+=cr,Ge+=cr*Wr,lt+=cr*bs,Ie+=cr*Wr*Wr,Xe+=cr*Wr*bs}const Je=at*Ie-Ge*Ge;Math.abs(Je)>1e-9&&(Wt=(at*Xe-Ge*lt)/Je,Wt=Math.max(-2.5,Math.min(2.5,Wt)))}const qr=H.length?H[H.length-1]:null,Ut=Number(G?G.startExact??G.index??G.hi??0:(qr==null?void 0:qr.hi)??0),ns=Us(Ut,0,36),Eo=G?Number(G.nextExactNum??G.nextExact??G.nextExactRaw??G.nextExactDisplay??ns):ns,xs=Us(Eo,0,36),Gr=String(l||"").toLowerCase(),Fs=Gr==="same"||Gr==="nochange"||Gr==="no-change"||Gr==="no_change"?ns:xs;let un=ns,dn=Ze;try{let at=0,Ge=0,lt=0;for(let Ie=0;Ie<ye.length;Ie++){const Xe=ye.length-1-Ie,Je=Math.pow(Te,Xe),Nt=Number(ye[Ie].hi),It=Number(ye[Ie].res);!Number.isFinite(Nt)||!Number.isFinite(It)||(at+=Je,Ge+=Je*Nt,lt+=Je*It)}if(at>0){const Ie=Ge/at,Xe=lt/at;un=Ie;let Je=0,Nt=0,It=0;for(let Os=0;Os<ye.length;Os++){const ma=ye.length-1-Os,sr=Math.pow(Te,ma),Ln=Number(ye[Os].hi),Ir=Number(ye[Os].res);if(!Number.isFinite(Ln)||!Number.isFinite(Ir))continue;const ys=Ln-Ie,nr=Ir-Xe;Je+=sr*ys*ys,Nt+=sr*ys*nr,It+=1}const Wr=Je>1e-6?Nt/(Je+1.25):Ze,bs=It/(It+4);dn=Wr*bs+Ze*(1-bs),dn=Math.max(0,Math.min(2,dn))}}catch{}const hi=ft+dn*(Fs-un),Mn=Us(De+hi,18,56),fa=xs-Fs,fi=Mn-36,Is=Math.sqrt(He*He+Gt*Gt),zs=Math.max(1.5,Math.min(9,Is));return{name:Ne,startExact:Fs,nextExactNum:xs,deltaHI:fa,expPts:Mn,formMu:fi,formSigma:zs,formTrend:Wt,modelBaseMu:De,modelBaseSigma:He,leagueHiSlope:Ze,modelResMu:hi,modelResSigma:Gt,roundsUsed:it}}).filter(F=>F&&F.name),$=JSON.stringify({mode:l,rows:ce.map(F=>({n:String(F.name||""),mu:Number(F.formMu||0),tr:Number(F.formTrend||0),sg:Number(F.formSigma||0),ex:Number(F.expPts||36),st:Number(F.startExact||0),nx:Number(F.nextExactNum||F.startExact||0)}))}),R=F=>{let G=1779033703^F.length;for(let H=0;H<F.length;H++)G=Math.imul(G^F.charCodeAt(H),3432918353),G=G<<13|G>>>19;return()=>(G=Math.imul(G^G>>>16,2246822507),G=Math.imul(G^G>>>13,3266489909),G^=G>>>16,G>>>0)},U=F=>()=>{let G=F+=1831565813;return G=Math.imul(G^G>>>15,G|1),G^=G+Math.imul(G^G>>>7,G|61),((G^G>>>14)>>>0)/4294967296},D=R($)(),A=U(D),W=()=>{let F=0,G=0;for(;F===0;)F=A();for(;G===0;)G=A();return Math.sqrt(-2*Math.log(F))*Math.cos(2*Math.PI*G)},Fe=8e3,de=new Array(ce.length).fill(0),oe=new Array(ce.length).fill(0),xe=new Array(ce.length).fill(0),Ye=ce[0]&&Number.isFinite(Number(ce[0].modelBaseMu))?Number(ce[0].modelBaseMu):36,O=ce[0]&&Number.isFinite(Number(ce[0].modelBaseSigma))?Number(ce[0].modelBaseSigma):1.6,ht=ce.map(F=>Number.isFinite(Number(F.modelResMu))?Number(F.modelResMu):0),Re=ce.map(F=>{const G=Number.isFinite(Number(F.modelResSigma))?Number(F.modelResSigma):4;return Math.max(1,Math.min(8,G))});for(let F=0;F<Fe;F++){const G=Ye+W()*O,Ne=ce.map((ae,ye)=>{const Te=G+ht[ye]+W()*Re[ye];return Math.max(0,Math.min(60,Te))}).map((ae,ye)=>({i:ye,p:ae,t:A()})).sort((ae,ye)=>ye.p-ae.p||ae.t-ye.t);if(Ne.length){de[Ne[0].i]++;for(let ae=0;ae<Math.min(3,Ne.length);ae++)oe[Ne[ae].i]++;for(let ae=0;ae<Math.min(4,Ne.length);ae++)xe[Ne[ae].i]++}}const ne=ce.map((F,G)=>{const H=de[G]/Fe*100,Ne=oe[G]/Fe*100,ae=xe[G]/Fe*100,ye=Number.isFinite(Number(F.formMu))?Number(F.formMu):0,Te=Number.isFinite(Number(F.formTrend))?Number(F.formTrend):0,et=Number.isFinite(Number(F.formSigma))?Number(F.formSigma):4,Z=et<=2.2?"Steady":et<=3.6?"Normal":"Volatile",ze=Te>=.25?"":Te<=-.25?"":"",it=Number.isFinite(Number(F.startExact))?Number(F.startExact):0,ee=Number.isFinite(Number(F.nextExactNum))?Number(F.nextExactNum):it,ft=Math.max(0,Math.min(36,ee)),Rt=ft-it;return{name:F.name,startHI:it,deltaHI:Rt,nextHI:ft,winPct:H,top3Pct:Ne,top4Pct:ae,expPts:Number.isFinite(Number(F.expPts))?Number(F.expPts):Math.max(18,Math.min(56,Ye+ht[G])),muAdj:ye,trend:Te,trendTag:ze,sigma:et,tag:Z,nextDisplay:F.nextDisplay??(Number.isFinite(ft)?ft.toFixed(1):""),nextDisplayNum:ft,roundsUsed:Number.isFinite(Number(F.oddsRoundsUsed))?Number(F.oddsRoundsUsed):Number.isFinite(Number(F.formN))?Number(F.formN):0,similarRounds:Number.isFinite(Number(F.oddsSimilarRounds))?Number(F.oddsSimilarRounds):0,usedSimilar:!!F.oddsUsedSimilar}}),Ue=[...ne].sort((F,G)=>G.winPct-F.winPct),q=[...ne].sort((F,G)=>G.top4Pct-F.top4Pct),L=q.map(F=>F.top4Pct/100),X=(L[0]||0)+(L[1]||0)+(L[2]||0)+(L[3]||0),fe=(L[3]||0)-(L[4]||0),Ee=X>=2.35&&fe>=.06?"High":X>=2.1&&fe>=.03?"Medium":"Low";try{const F=Array.from(new Set(v.map(H=>String(H.groupKey||"").toLowerCase()).filter(Boolean))).sort(),G=typeof window<"u"&&window.__ODDS_DEBUG&&typeof window.__ODDS_DEBUG=="object"?window.__ODDS_DEBUG:{};window.__ODDS_DEBUG={...G,ts:Date.now(),seasonRoundsCount:Array.isArray(E)?E.length:0,seasonRoundDates:(()=>{try{const H=(Array.isArray(E)?E:[]).map(Ne=>Number(Ne==null?void 0:Ne.dateMs)).filter(Number.isFinite).map(Ne=>new Date(Ne).toISOString().slice(0,10));return Array.from(new Set(H)).sort()}catch{return[]}})(),seasonPlayerRowsCount:v.length,leagueBaseMu:De,leagueBaseSigma:He,leagueHiSlope:Ze,leagueWithinSigma:ce&&ce.length?Math.sqrt(ce.reduce((H,Ne)=>H+Math.pow(Number(Ne.formSigma||0),2),0)/Math.max(1,ce.length)):null,groups:F,sample:v.slice(-120).map(H=>({name:H.name,pts:H.pts,roundAvg:H.roundAvg,roundStd:null,teeLabel:H.teeLabel,dateMs:H.dateMs,gender:H.gender,groupKey:H.groupKey,groupAvg:H.groupAvg,hi:H.hi})),model:{sims:Fe,confidence:Ee,c4:X,gap:fe,rows:Ue.slice(0,60),top4:q.slice(0,4)}}}catch(F){try{window.__ODDS_DEBUG={error:String(F)}}catch{}}return{sims:Fe,rows:Ue,top4:q.slice(0,4),confidence:Ee,c4:X,gap:fe}},[e,l,x,d]);return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Qs,{items:[{label:"Round Leaderboard"}]}),n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"mb-6 bg-neutral-50 rounded-2xl border border-neutral-200 overflow-hidden shadow-sm",children:[n.jsxs("div",{className:"bg-neutral-100 p-3 border-b border-neutral-200 flex flex-wrap gap-2 justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsx("h3",{className:"font-bold text-neutral-800 text-xs uppercase tracking-wider",children:"Handicap Calculator"})]}),n.jsxs("div",{className:"flex gap-4 text-xs",children:[n.jsxs("div",{className:"flex items-center gap-2 bg-white px-2 py-1 rounded border border-neutral-200 shadow-sm",children:[n.jsx("label",{className:"text-neutral-500 font-bold uppercase text-[10px]",children:"Slope"}),n.jsx("input",{type:"number",className:"w-12 font-bold text-neutral-900 text-center outline-none bg-transparent",value:r||"",placeholder:"-",onChange:N=>s(Number(N.target.value))})]}),n.jsxs("div",{className:"flex items-center gap-2 bg-white px-2 py-1 rounded border border-neutral-200 shadow-sm",children:[n.jsx("label",{className:"text-neutral-500 font-bold uppercase text-[10px]",children:"Rating"}),n.jsx("input",{type:"number",className:"w-12 font-bold text-neutral-900 text-center outline-none bg-transparent",value:i||"",placeholder:"-",onChange:N=>a(Number(N.target.value))})]})]})]}),n.jsxs("div",{className:"p-4 grid md:grid-cols-2 gap-8",children:[n.jsxs("div",{children:[n.jsx("span",{className:"block font-bold text-neutral-700 mb-2 text-sm",children:"1. Today's Handicap Mode"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>c("raw"),className:`flex-1 py-2 rounded-lg text-xs font-bold border transition-colors ${o==="raw"?"bg-emerald-700 text-white border-emerald-800 shadow-inner":"bg-white text-neutral-700 hover:bg-neutral-100 border-neutral-200"}`,children:"Original"}),n.jsx("button",{onClick:()=>c("calc"),className:`flex-1 py-2 rounded-lg text-xs font-bold border transition-colors ${o==="calc"?"bg-emerald-700 text-white border-emerald-800 shadow-inner":"bg-white text-neutral-700 hover:bg-neutral-100 border-neutral-200"}`,children:"Apply Slope"})]}),n.jsx("p",{className:"text-[10px] text-neutral-400 mt-2",children:o==="calc"?`Calculating: HI  (${r||0}  113) + (${i||0}  Par) = Course Hcap (ref)`:"Using exact playing handicap from the CSV file."})]}),n.jsxs("div",{children:[n.jsx("span",{className:"block font-bold text-neutral-700 mb-2 text-sm",children:"2. Next Handicap Preview"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>u("den"),className:`flex-1 py-2 rounded-lg text-xs font-bold border transition-colors ${l==="den"?"bg-neutral-900 text-white border-neutral-900 shadow-inner":"bg-white text-neutral-700 hover:bg-neutral-100 border-neutral-200"}`,children:"Legacy Formula"}),n.jsx("button",{onClick:()=>u("whs"),className:`flex-1 py-2 rounded-lg text-xs font-bold border transition-colors ${l==="whs"?"bg-neutral-900 text-white border-neutral-900 shadow-inner":"bg-white text-neutral-700 hover:bg-neutral-100 border-neutral-200"}`,children:"WHS Diff"}),n.jsx("button",{onClick:()=>u("same"),className:`flex-1 py-2 rounded-lg text-xs font-bold border transition-colors ${l==="same"?"bg-neutral-900 text-white border-neutral-900 shadow-inner":"bg-white text-neutral-700 hover:bg-neutral-100 border-neutral-200"}`,children:"No Change"})]}),n.jsx("p",{className:"text-[10px] text-neutral-400 mt-2",children:l==="den"?"Applies Cuts & Buffers to Starting Index.":l==="whs"?"Calculates differential from score.":"Keeps handicap exactly the same."})]})]})]}),n.jsx("div",{className:"overflow-auto table-wrap",children:n.jsxs("table",{className:"min-w-full text-sm table-zebra",children:[n.jsx("thead",{className:"bg-neutral-50",children:n.jsxs("tr",{className:"text-left text-xs uppercase tracking-wide text-neutral-500 font-bold border-b border-squab-200",children:[n.jsx("th",{className:"py-3 px-3",children:"#"}),n.jsx("th",{className:"py-3 px-3",children:"Name"}),n.jsx("th",{className:"py-3 px-3 text-center",children:"Index"}),n.jsx("th",{className:"py-3 px-3 bg-squab-50 text-squab-800 border-x border-squab-200 text-center w-24",children:"Playing"}),n.jsx("th",{className:"py-3 px-3 text-center",children:"Pts"}),n.jsx("th",{className:"py-3 px-3 text-center",children:"Back9"}),n.jsx("th",{className:"py-3 px-3 text-center",children:"League"}),n.jsx("th",{className:"py-3 px-3 bg-neutral-100 border-l border-neutral-200 text-neutral-700 text-right",children:l==="whs"?"Diff":"Next"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-100",children:e.map((N,f)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors "+(N.isWinner?"ring-2 ring-emerald-400/60 ring-inset bg-emerald-50/10":""),children:[n.jsx("td",{className:"py-3 px-3 font-bold text-squab-600",children:N.position}),n.jsx("td",{className:"py-3 px-3 font-medium text-neutral-900",children:N.name}),n.jsx("td",{className:"py-3 px-3 text-center text-neutral-400 font-mono text-xs",children:N.startExact}),n.jsx("td",{className:"py-3 px-3 text-center font-bold bg-squab-50 text-squab-900 border-x border-squab-100 text-lg",children:o==="calc"?N.playingHcapRef??N.playingHcap:N.playingHcap}),n.jsx("td",{className:"py-3 px-3 text-center font-bold text-neutral-800",children:N.points}),n.jsx("td",{className:"py-3 px-3 text-center text-neutral-500 text-xs",children:N.back9}),n.jsx("td",{className:"py-3 px-3 text-center font-bold text-emerald-600",children:N.leaguePoints}),n.jsx("td",{className:"py-3 px-3 text-right bg-neutral-50 border-l border-neutral-200 font-mono text-neutral-700 font-bold",children:N.nextDisplay})]},f))})]})}),n.jsxs("div",{className:"mt-5 panel-core p-4",children:[n.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs uppercase tracking-wider text-neutral-500 font-bold",children:"Next Society Stableford"}),n.jsx("div",{className:"text-lg font-black text-neutral-900",children:"Winner odds (next HI)"}),n.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:["Based on each players last up to ",n.jsx("b",{children:"12"})," rounds in the current filters, using ",n.jsx("b",{children:"points  36"})," form + volatility."]})]}),n.jsxs("div",{className:"flex items-center gap-3 text-xs text-neutral-500",children:[n.jsxs("div",{children:["Sims: ",n.jsx("span",{className:"font-mono font-bold",children:w.sims})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-neutral-500",children:"Model internals"}),n.jsx("button",{onClick:()=>y(N=>!N),className:`pill-mini ${p?"success":""}`,title:"Show Start HI and HI used by the model",children:p?"On":"Off"})]})]})]}),n.jsxs("div",{className:"mt-3 grid md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"md:col-span-2 p-3 rounded-2xl border border-neutral-200 bg-white/80",children:[n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[n.jsx("div",{className:"text-xs uppercase tracking-wider text-neutral-500 font-black",children:"Top-4 prediction"}),n.jsxs("span",{className:`pill-mini ${w.confidence==="High"?"subtle":w.confidence==="Medium"?"bg-amber-50 border-amber-200 text-amber-900":"bg-neutral-100 border-neutral-200 text-neutral-700"}`,children:["Confidence: ",n.jsx("b",{children:w.confidence})]})]}),n.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(w.top4||[]).map(N=>n.jsxs("span",{className:"pill-mini subtle",children:[N.name,"  ",n.jsxs("span",{className:"font-mono",children:[N.top4Pct.toFixed(1),"%"]})]},N.name))}),n.jsxs("div",{className:"mt-2 text-xs text-neutral-500",children:["If confidence is ",n.jsx("b",{children:"Low"}),", treat this as a contenders list  society golf is noisy and the 4th spot isnt clearly separated."]})]}),n.jsxs("div",{className:"p-3 rounded-2xl border border-neutral-200 bg-white/70",children:[n.jsx("div",{className:"text-xs uppercase tracking-wider text-neutral-500 font-black",children:"Model confidence"}),n.jsxs("div",{className:"mt-1 text-sm text-neutral-700",children:["Top-4 concentration: ",n.jsx("span",{className:"font-mono font-black",children:(w.c4||0).toFixed(2)})," / 4"]}),n.jsxs("div",{className:"mt-1 text-sm text-neutral-700",children:["#4 vs #5 gap: ",n.jsxs("span",{className:"font-mono font-black",children:[((w.gap||0)*100).toFixed(1),"%"]})]}),n.jsx("div",{className:"mt-2 text-xs text-neutral-500",children:"Higher concentration + a clear gap means we can call the Top-4 with more confidence."})]})]}),n.jsx("div",{className:"mt-3 table-wrap",children:n.jsxs("table",{className:"w-full table-zebra",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"py-2 px-3 text-left",children:"#"}),n.jsx("th",{className:"py-2 px-3 text-left",children:"Player"}),n.jsx("th",{className:"py-2 px-3 text-right",children:"Win%"}),n.jsx("th",{className:"py-2 px-3 text-right",children:"Top 3%"}),n.jsx("th",{className:"py-2 px-3 text-right",children:"Top 4%"}),n.jsx("th",{className:"py-2 px-3 text-right",children:"Expected Pts"}),n.jsx("th",{className:"py-2 px-3 text-right",children:"Rounds (4)"}),n.jsx("th",{className:"py-2 px-3 text-right",children:"Volatility"}),p&&n.jsx("th",{className:"py-2 px-3 text-right",children:"Start HI"}),p&&n.jsx("th",{className:"py-2 px-3 text-right",children:"HI"}),n.jsx("th",{className:"py-2 px-3 text-right",children:"Next HI"})]})}),n.jsx("tbody",{children:(w.rows||[]).slice(0,12).map((N,f)=>n.jsxs("tr",{children:[n.jsx("td",{className:"py-2 px-3 text-neutral-500 font-mono text-xs",children:f+1}),n.jsx("td",{className:"py-2 px-3 font-bold text-neutral-900",children:N.name}),n.jsxs("td",{className:"py-2 px-3 text-right font-black text-neutral-900",children:[N.winPct.toFixed(1),"%"]}),n.jsxs("td",{className:"py-2 px-3 text-right font-bold text-neutral-700",children:[N.top3Pct.toFixed(1),"%"]}),n.jsxs("td",{className:"py-2 px-3 text-right font-bold text-neutral-700",children:[N.top4Pct.toFixed(1),"%"]}),n.jsx("td",{className:"py-2 px-3 text-right font-mono font-bold text-neutral-800",children:N.expPts.toFixed(1)}),n.jsx("td",{className:"py-2 px-3 text-right font-mono text-neutral-700",children:N.usedSimilar?N.similarRounds:`${N.similarRounds} (fb)`}),n.jsx("td",{className:"py-2 px-3 text-right",children:n.jsxs("span",{className:`pill-mini ${N.tag==="Steady"?"subtle":""}`,children:[N.tag,"   ",N.sigma.toFixed(1)]})}),p&&n.jsx("td",{className:"py-2 px-3 text-right font-mono text-neutral-700",children:Number.isFinite(Number(N.startHI))?Number(N.startHI).toFixed(1):""}),p&&n.jsx("td",{className:"py-2 px-3 text-right font-mono text-neutral-700",children:Number.isFinite(Number(N.deltaHI))?(Number(N.deltaHI)>=0?"+":"")+Number(N.deltaHI).toFixed(1):""}),n.jsx("td",{className:"py-2 px-3 text-right font-mono text-neutral-700",children:N.nextDisplay??""})]},N.name))})]})}),n.jsxs("div",{className:"mt-3 text-sm text-neutral-700",children:[n.jsx("b",{children:"How to use this:"})," if your ",n.jsx("span",{className:"font-mono",children:"Expected Pts"})," is close to the leaders but your volatility is high, the fastest win is usually ",n.jsx("b",{children:"cutting one wipe/double+"}),"."]})]})]})}function rN({computed:e,courseTees:t,setView:r}){const s=l=>l>=3?"Excellent":l>=2.5?"Good":l>=2?"Solid":l>=1.5?"Needs Work":"Struggle",i=l=>l>=3?"bg-emerald-100 text-emerald-800":l>=2.5?"bg-emerald-50 text-emerald-700":l>=2?"bg-neutral-100 text-neutral-800":l>=1.5?"bg-amber-100 text-amber-800":"bg-red-100 text-red-800",a=ue.useMemo(()=>gs(e),[e]),o=(l,u)=>{const d={3:{s:0,c:0},4:{s:0,c:0},5:{s:0,c:0}};for(let h=0;h<a;h++){const p=u[h];if(!p||!d[p])continue;const y=la(l[h],NaN);Number.isFinite(y)&&(d[p].s+=y,d[p].c++)}const x=h=>d[h].c?d[h].s/d[h].c:0;return{p3:x(3),p4:x(4),p5:x(5)}},c=Q.useMemo(()=>e.map(l=>{const u=en(l,t);if(!u)return{name:l.name,p3:0,p4:0,p5:0};const d=o(l.perHole||[],u.pars);return{name:l.name,p3:cl(d.p3),p4:cl(d.p4),p5:cl(d.p5),total:cl(d.p3+d.p4+d.p5)}}).sort((l,u)=>u.total-l.total),[e,t]);return n.jsxs("section",{className:"content-card p-3 md:p-5",children:[n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)}),n.jsx("h2",{className:"section-title mb-3",children:"Player Ratings"}),n.jsx("div",{className:"overflow-auto table-wrap",children:n.jsxs("table",{className:"min-w-full text-sm table-zebra",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-squab-200 text-left",children:[n.jsx("th",{children:"Name"}),n.jsx("th",{children:"Par-3 Avg"}),n.jsx("th",{children:"Rating"}),n.jsx("th",{children:"Par-4 Avg"}),n.jsx("th",{children:"Rating"}),n.jsx("th",{children:"Par-5 Avg"}),n.jsx("th",{children:"Rating"})]})}),n.jsxs("tbody",{children:[c.map(l=>n.jsxs("tr",{className:"border-b border-squab-200",children:[n.jsx("td",{className:"font-medium",children:l.name}),n.jsx("td",{children:l.p3.toFixed(1)}),n.jsx("td",{children:n.jsx("span",{className:`px-2 py-0.5 rounded-lg text-xs ${i(l.p3)}`,children:s(l.p3)})}),n.jsx("td",{children:l.p4.toFixed(1)}),n.jsx("td",{children:n.jsx("span",{className:`px-2 py-0.5 rounded-lg text-xs ${i(l.p4)}`,children:s(l.p4)})}),n.jsx("td",{children:l.p5.toFixed(1)}),n.jsx("td",{children:n.jsx("span",{className:`px-2 py-0.5 rounded-lg text-xs ${i(l.p5)}`,children:s(l.p5)})})]},l.name)),c.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"py-3 text-neutral-600",children:"Load an event to see ratings."})})]})]})})]})}function sN({season:e,setView:t,seasonsDef:r,seasonYear:s,setSeasonYear:i}){const a=Object.values(e).filter(o=>!Yt(o.name)).sort((o,c)=>c.totalPoints-o.totalPoints||o.name.localeCompare(c.name));return n.jsxs("section",{className:"content-card p-3 md:p-5 hm-stage",children:[n.jsx(on,{setView:t,right:n.jsx(X0,{seasonsDef:r,seasonYear:s,setSeasonYear:i,leagueTitle:Wi})}),n.jsx("h2",{className:"section-title mb-3",children:"League"}),n.jsx("div",{className:"overflow-auto table-wrap",children:n.jsxs("table",{className:"min-w-full text-sm table-zebra",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-squab-200 text-left",children:[n.jsx("th",{children:"Rank"}),n.jsx("th",{children:"Name"}),n.jsx("th",{children:"Events"}),n.jsx("th",{children:"Total"}),n.jsx("th",{children:"Best Event"}),n.jsx("th",{children:"Best Hole"}),n.jsx("th",{children:"Eclectic"})]})}),n.jsxs("tbody",{className:"[&_tr:nth-child(even)]:bg-squab-50/50",children:[a.map((o,c)=>n.jsxs("tr",{className:"border-b border-squab-200 "+(c===0?"bg-emerald-50":c<3?"bg-squab-50":""),children:[n.jsx("td",{className:"font-semibold",children:c===0?"":c===1?"":c===2?"":c+1}),n.jsx("td",{children:o.name}),n.jsx("td",{children:o.events}),n.jsx("td",{children:o.totalPoints}),n.jsx("td",{children:o.bestEventPoints}),n.jsx("td",{children:o.bestHolePoints}),n.jsx("td",{children:o.eclecticTotal})]},o.name)),a.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"7",className:"py-3 text-neutral-600",children:"No season data yet."})})]})]})})]})}function nN({season:e,setView:t,seasonsDef:r,seasonYear:s,setSeasonYear:i}){const a=Object.values(e).filter(c=>!Yt(c.name)).sort((c,l)=>(l.eclecticTotal||0)-(c.eclecticTotal||0)),o=c=>c>=4?"bg-purple-100 text-purple-700 font-bold":c===3?"bg-emerald-100 text-emerald-800 font-semibold":c===2?"text-neutral-800":c===1?"bg-orange-50 text-orange-800":c===0?"bg-red-50 text-red-300":"";return n.jsxs("section",{className:"content-card p-3 md:p-5 hm-stage",children:[n.jsx(on,{setView:t,right:n.jsx(X0,{seasonsDef:r,seasonYear:s,setSeasonYear:i,leagueTitle:Wi})}),n.jsx("h2",{className:"section-title mb-3",children:"Eclectic"}),n.jsx("div",{className:"overflow-auto table-wrap",children:n.jsxs("table",{className:"min-w-full text-xs md:text-sm table-zebra",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-squab-200 text-left",children:[n.jsx("th",{children:"Rank"}),n.jsx("th",{children:"Name"}),n.jsx("th",{children:"Eclectic Total"}),Array.from({length:18},(c,l)=>n.jsxs("th",{children:["H",l+1]},l))]})}),n.jsxs("tbody",{className:"[&_tr:nth-child(even)]:bg-squab-50/50",children:[a.map((c,l)=>n.jsxs("tr",{className:"border-b border-squab-200 "+(l===0?"bg-emerald-50":l<3?"bg-squab-50":""),children:[n.jsx("td",{className:"font-semibold",children:l===0?"":l===1?"":l===2?"":l+1}),n.jsx("td",{children:c.name}),n.jsx("td",{children:c.eclecticTotal}),(c.bestPerHole||Array(18).fill(0)).map((u,d)=>n.jsx("td",{className:`text-center ${o(u)}`,children:u},d))]},c.name)),a.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:21,className:"py-3 text-neutral-600",children:"No eclectic data yet."})})]})]})})]})}function iN({computed:e,setView:t}){if(!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Qs,{items:[{label:"Game",onClick:()=>t("event"),title:"Round Leaderboard"},{label:"Fun & Banter"}]}),n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to see analysis."})]});const r=ue.useMemo(()=>gs(e),[e]),s=Math.max(0,r-4),i=e.map(l=>{const u=(l.perHole||[]).slice(0,r).map(h=>Number(h)||0);let d=0,x=0;for(let h=0;h<r-1;h++)u[h]<=1&&(d++,u[h+1]>=2&&x++);return{name:l.name,ratio:d?x/d*100:0,bounces:x,opportunities:d}}).sort((l,u)=>u.ratio-l.ratio),a=e.map(l=>{const u=(l.perHole||[]).slice(0,r).map(p=>Number(p)||0),d=u.reduce((p,y)=>p+y,0)/r,x=u.reduce((p,y)=>p+Math.pow(y-d,2),0)/r,h=Math.sqrt(x);return{name:l.name,stdDev:h}}).sort((l,u)=>l.stdDev-u.stdDev),o=e.map(l=>{const u=(l.perHole||[]).slice(s,r).reduce((d,x)=>d+(Number(x)||0),0);return{name:l.name,pts:u}}).sort((l,u)=>u.pts-l.pts),c=e.map(l=>{const d=(l.perHole||[]).slice(0,r).map(h=>Number(h)||0).filter(h=>h===0).length,x=l.points+d;return{name:l.name,actual:l.points,potential:x,diff:d}}).sort((l,u)=>u.diff-l.diff);return n.jsxs("section",{className:"content-card p-0 space-y-0",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"panel-head",children:[n.jsx("h2",{className:"text-xl font-bold text-squab-900",children:"Banter & Analysis"}),n.jsx("p",{className:"text-sm text-neutral-500",children:"The mental game, the chokes, and the excuses."})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"border border-squab-200 rounded-2xl overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"bg-blue-50 p-3 border-b border-blue-100",children:[n.jsx("h3",{className:"font-bold text-blue-900 text-sm uppercase",children:' The "Bounce Back" King'}),n.jsx("p",{className:"text-xs text-blue-700",children:"Resilience: Scoring 2+ pts immediately after a bad hole (0-1 pts)."})]}),n.jsx("div",{className:"overflow-auto max-h-[300px]",children:n.jsxs("table",{className:"w-full text-xs text-left",children:[n.jsx("thead",{className:"bg-white sticky top-0",children:n.jsxs("tr",{className:"border-b border-neutral-100 text-neutral-500",children:[n.jsx("th",{className:"p-2",children:"Name"}),n.jsx("th",{className:"p-2",children:"Success Rate"})]})}),n.jsx("tbody",{children:i.map((l,u)=>n.jsxs("tr",{className:"border-b border-neutral-50 hover:bg-neutral-50",children:[n.jsxs("td",{className:"p-2 font-medium",children:[u===0?" ":"",l.name]}),n.jsx("td",{className:"p-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-bold",children:[l.ratio.toFixed(0),"%"]}),n.jsxs("span",{className:"text-neutral-400",children:["(",l.bounces,"/",l.opportunities,")"]})]})})]},l.name))})]})})]}),n.jsxs("div",{className:"border border-squab-200 rounded-2xl overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"bg-purple-50 p-3 border-b border-purple-100",children:[n.jsx("h3",{className:"font-bold text-purple-900 text-sm uppercase",children:" Rollercoaster vs Steady Eddie"}),n.jsx("p",{className:"text-xs text-purple-700",children:"Based on standard deviation. Low = Consistent. High = Wild."})]}),n.jsx("div",{className:"overflow-auto max-h-[300px]",children:n.jsxs("table",{className:"w-full text-xs text-left",children:[n.jsx("thead",{className:"bg-white sticky top-0",children:n.jsxs("tr",{className:"border-b border-neutral-100 text-neutral-500",children:[n.jsx("th",{className:"p-2",children:"Name"}),n.jsx("th",{className:"p-2",children:"Type"}),n.jsx("th",{className:"p-2",children:"Dev"})]})}),n.jsx("tbody",{children:a.map((l,u)=>n.jsxs("tr",{className:"border-b border-neutral-50 hover:bg-neutral-50",children:[n.jsx("td",{className:"p-2 font-medium",children:l.name}),n.jsx("td",{className:"p-2",children:u<3?n.jsx("span",{className:"text-emerald-600 font-bold",children:"Robot "}):u>a.length-4?n.jsx("span",{className:"text-orange-600 font-bold",children:"Chaos "}):n.jsx("span",{className:"text-neutral-400",children:"-"})}),n.jsx("td",{className:"p-2 font-mono",children:l.stdDev.toFixed(2)})]},l.name))})]})})]}),n.jsxs("div",{className:"border border-squab-200 rounded-2xl overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"bg-orange-50 p-3 border-b border-orange-100",children:[n.jsxs("h3",{className:"font-bold text-orange-900 text-sm uppercase",children:[" The Closer (Holes ",s+1,"-",r,")"]}),n.jsx("p",{className:"text-xs text-orange-700",children:"Total stableford points scored on the final 4 holes."})]}),n.jsx("div",{className:"overflow-auto max-h-[300px]",children:n.jsxs("table",{className:"w-full text-xs text-left",children:[n.jsx("thead",{className:"bg-white sticky top-0",children:n.jsxs("tr",{className:"border-b border-neutral-100 text-neutral-500",children:[n.jsx("th",{className:"p-2",children:"Name"}),n.jsx("th",{className:"p-2",children:"Finish Pts"})]})}),n.jsx("tbody",{children:o.map((l,u)=>n.jsxs("tr",{className:"border-b border-neutral-50 hover:bg-neutral-50",children:[n.jsxs("td",{className:"p-2 font-medium",children:[u===0?" ":"",l.name]}),n.jsx("td",{className:"p-2 font-bold text-orange-800",children:l.pts})]},l.name))})]})})]}),n.jsxs("div",{className:"border border-squab-200 rounded-2xl overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"bg-emerald-50 p-3 border-b border-emerald-100",children:[n.jsx("h3",{className:"font-bold text-emerald-900 text-sm uppercase",children:' The "Shoulda Woulda" Index'}),n.jsx("p",{className:"text-xs text-emerald-700",children:'"If I just played for bogey..." (Recalculated assuming 0pt holes were 1pt).'})]}),n.jsx("div",{className:"overflow-auto max-h-[300px]",children:n.jsxs("table",{className:"w-full text-xs text-left",children:[n.jsx("thead",{className:"bg-white sticky top-0",children:n.jsxs("tr",{className:"border-b border-neutral-100 text-neutral-500",children:[n.jsx("th",{className:"p-2",children:"Name"}),n.jsx("th",{className:"p-2",children:"Cost"}),n.jsx("th",{className:"p-2",children:"Potential"})]})}),n.jsx("tbody",{children:c.map((l,u)=>n.jsxs("tr",{className:"border-b border-neutral-50 hover:bg-neutral-50",children:[n.jsx("td",{className:"p-2 font-medium",children:l.name}),n.jsxs("td",{className:"p-2 text-red-600 font-bold",children:["-",l.diff," pts"]}),n.jsx("td",{className:"p-2 text-neutral-400",children:l.potential})]},l.name))})]})})]})]})]})}function aN({computed:e,setView:t,courseTees:r}){const s=ue.useMemo(()=>gs(e),[e]),[i,a]=ue.useState(""),[o,c]=ue.useState("stableford"),[l,u]=ue.useState("field");if(ue.useEffect(()=>{e.length&&!i&&a(e[0].name)},[e,i]),!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to see graphs."})]});const d=e.find($=>$.name===i)||e[0],x=Math.round(d.startExact??d.handicap??0),h=ca(x),p=$=>{if(o==="stableford")return($.perHole||[]).map(U=>{const D=Number(U);return Number.isFinite(D)?D:0});const R=Array.isArray($.grossPerHole)?$.grossPerHole:[];return Array.from({length:18},(U,D)=>{const A=Number(R[D]);return Number.isFinite(A)&&A>0?A:NaN})},y=p(d),w=Array(18).fill(0),N=Array(18).fill(0),f=Array(18).fill(0),m=Array(18).fill(0);e.forEach($=>{const R=p($),U=Math.round($.startExact??$.handicap??0),D=ca(U)===h;R.forEach((A,W)=>{A>0&&(w[W]+=A,N[W]+=1,D&&(f[W]+=A,m[W]+=1))})});const v=w.map(($,R)=>N[R]?$/N[R]:0),E=f.map(($,R)=>m[R]?$/m[R]:v[R]),C=l==="field"?v:E,T=Math.max(...y,...C,o==="gross"?6:4),B=Math.max(4,Math.ceil(T+1)),Y=280,le=800,J={top:20,right:20,bottom:40,left:40},De=Y-J.top-J.bottom,nt=(le-J.left-J.right)/18,Ke=nt*.35,He=nt*.1,Ze=$=>De-$/B*De,ce=($,R)=>o==="gross"?$>0&&$<R-.5?"fill-emerald-500 hover:fill-emerald-600":$>R+.5?"fill-rose-500 hover:fill-rose-600":"fill-neutral-400 hover:fill-neutral-500":$>R+.5?"fill-emerald-500 hover:fill-emerald-600":$<R-.5?"fill-rose-500 hover:fill-rose-600":"fill-neutral-400 hover:fill-neutral-500";return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-squab-900",children:"Hole-by-Hole Comparison"}),n.jsx("div",{className:"text-xs text-neutral-500",children:o==="gross"?"Strokes per hole (lower is better). Missing gross shown as blank.":"Points per hole (higher is better)."})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 justify-center w-full",children:[n.jsxs("div",{className:"flex bg-neutral-100 rounded-lg p-1 border border-neutral-200",children:[n.jsx("button",{onClick:()=>c("stableford"),className:`px-3 py-1 rounded-md text-xs font-bold transition-all ${o==="stableford"?"bg-white shadow-sm text-squab-900":"text-neutral-500"}`,children:"Pts"}),n.jsx("button",{onClick:()=>c("gross"),className:`px-3 py-1 rounded-md text-xs font-bold transition-all ${o==="gross"?"bg-white shadow-sm text-squab-900":"text-neutral-500"}`,children:"Gross"})]}),n.jsx("select",{className:"rounded-2xl border border-squab-200 px-3 py-1.5 text-xs bg-white",value:i,onChange:$=>a($.target.value),children:e.map($=>n.jsx("option",{value:$.name,children:$.name},$.name))}),n.jsxs("select",{className:"rounded-2xl border border-squab-200 px-3 py-1.5 text-xs bg-white",value:l,onChange:$=>u($.target.value),children:[n.jsx("option",{value:"field",children:"vs Field"}),n.jsxs("option",{value:"handicap",children:["vs ",h," Grp"]})]})]})]}),n.jsx("div",{className:"w-full overflow-x-auto pb-2",children:n.jsx("div",{className:"min-w-[600px]",children:n.jsxs("svg",{viewBox:`0 0 ${le} ${Y}`,className:"w-full h-auto font-sans",children:[Array.from({length:B+1}).map(($,R)=>{if(B>10&&R%2!==0)return null;const U=Ze(R)+J.top;return n.jsxs("g",{children:[n.jsx("line",{x1:J.left,y1:U,x2:le-J.right,y2:U,stroke:"#e5e7eb",strokeDasharray:R===0?"":"4 4"}),n.jsx("text",{x:J.left-8,y:U+4,textAnchor:"end",className:"text-[10px] fill-neutral-400",children:R})]},R)}),Array.from({length:s}).map(($,R)=>{const U=y[R]??0,D=C[R]??0,A=J.left+R*nt+nt/2,W=A-Ke-He/2,Fe=A+He/2,de=Ze(U)+J.top,oe=De-(de-J.top),xe=Ze(D)+J.top,Ye=De-(xe-J.top),O=ce(U,D);return n.jsxs("g",{children:[n.jsx("text",{x:A,y:Y-5,textAnchor:"middle",className:"text-[10px] font-semibold fill-neutral-600",children:R+1}),n.jsx("rect",{x:W,y:de,width:Ke,height:Math.max(0,oe),className:`transition-colors ${O}`,rx:2,children:n.jsx("title",{children:`Hole ${R+1}: ${U} (${o})`})}),n.jsx("text",{x:W+Ke/2,y:de-4,textAnchor:"middle",className:"text-[9px] font-bold fill-neutral-600",children:U>0?Number.isInteger(U)?U:U.toFixed(1):""}),n.jsx("rect",{x:Fe,y:xe,width:Ke,height:Math.max(0,Ye),className:"fill-neutral-200",rx:2,children:n.jsx("title",{children:`Avg: ${Number.isFinite(D)?D.toFixed(2):""}`})})]},R)})]})})})]})}function oN({computed:e,courseTees:t,courseSlope:r,courseRating:s,startHcapMode:i,setView:a}){const o=Q.useMemo(()=>(e||[]).map(ne=>ne.name),[e]),[c,l]=Q.useState(""),[u,d]=Q.useState(""),[x,h]=Q.useState(""),[p,y]=Q.useState(""),w="Team 1",N="Team 2",[f,m]=Q.useState(0),[v,E]=Q.useState(!1),[C,T]=Q.useState(1200),B=Q.useMemo(()=>gs(e),[e]),[Y,le]=Q.useState(0),[J,De]=Q.useState([]),[nt,Ke]=Q.useState(""),[He,Ze]=Q.useState(!1),[ce,$]=Q.useState(null),[R,U]=Q.useState(null),[D,A]=Q.useState(null),W=ne=>(e||[]).find(Ue=>Ue.name===ne),Fe=(ne,Ue)=>{var fe,Ee;const q=W(ne);if(!q)return{pts:0,method:"noPlayer"};const L=Number((fe=q==null?void 0:q.bestBallPerHole)==null?void 0:fe[Ue]);if(Number.isFinite(L))return{pts:L,method:"bestBall"};const X=Number((Ee=q==null?void 0:q.perHole)==null?void 0:Ee[Ue]);return Number.isFinite(X)?{pts:X,method:"stableford"}:{pts:0,method:"missingPoints"}},de=(ne,Ue)=>{const q=Fe(ne[0],Ue),L=Fe(ne[1],Ue);return{pts:Math.max(Number(q.pts)||0,Number(L.pts)||0),a:q,b:L}},oe=Q.useMemo(()=>{const ne=[c,u,x,p].filter(Boolean);return ne.length===4&&new Set(ne).size===4},[c,u,x,p]),xe=Q.useMemo(()=>{const ne=[c,u,x,p].filter(Boolean);if(ne.length!==4)return!1;for(const Ue of ne){const q=W(Ue),L=q==null?void 0:q.bestBallPerHole;if(!Array.isArray(L)||L.length<18)return!0}return!1},[c,u,x,p,e]),Ye=()=>{m(0),le(0),De([]),Ke(""),Ze(!1),$(null),U(null),A(null),E(!1)},O=(ne,Ue)=>{const q=B-Ue,L=Math.abs(ne),X=ne===0?"":ne>0?w:N;return L>q&&L>0?{text:`Match Closed  ${X} wins`,closed:!0}:L===q&&L>0?{text:`Dormie  ${X}`,closed:!1}:{text:"",closed:!1}},ht=()=>{if(!oe||He||f>=B)return;const ne=f+1,Ue=ne-1,q=de([c,u],Ue),L=de([x,p],Ue),X=q.pts,fe=L.pts;$(ne),U(X),A(fe),window.setTimeout(()=>{let Ee=0,F="Halved";X>fe?(Ee=1,F="$Team 1 wins"):fe>X&&(Ee=-1,F="$Team 2 wins");const G=Y+Ee,H=ne,Ne={hole:ne,delta:Ee,diffVal:G,t1:X,t2:fe,res:F,match:G===0?"All Square":`${Math.abs(G)} Up (${G>0?w:N})`,detail:{mode:"Best Ball if available, else Stableford",t1Players:[{name:c,...q.a},{name:u,...q.b}],t2Players:[{name:x,...L.a},{name:p,...L.b}]}};De(ye=>[...ye,Ne]),le(G),m(H);const ae=O(G,H);Ke(ae.text),Ze(ae.closed),$(null)},450)};if(Q.useEffect(()=>{if(!v)return;if(He||f>=B){E(!1);return}const ne=window.setTimeout(()=>ht(),C);return()=>window.clearTimeout(ne)},[v,C,f,He,oe,c,u,x,p,w,N,e,Y]),!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:a,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event CSV to watch the team matchplay replay."})]});const Re=Y===0?"All Square":`${Math.abs(Y)} Up (${Y>0?w:N})`;return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Et,{setView:a,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 border-b border-squab-100 pb-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-squab-900",children:" Team Matchplay Live Replay"}),n.jsxs("p",{className:"text-sm text-neutral-500",children:["2v2 Better-Ball Stableford  uses the ",n.jsx("span",{className:"font-semibold",children:"Best Ball"})," row from the Squabbit CSV."]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[n.jsx("button",{className:"btn border "+(v?"bg-emerald-600 text-white border-emerald-700":"bg-white border-squab-200"),onClick:()=>{if(!oe){bt("Pick 4 different players first.");return}E(ne=>!ne)},children:v?"Pause":f===0?"Start":"Resume"}),n.jsx("button",{className:"btn border border-squab-200 bg-white",onClick:ht,disabled:!oe||He||f>=B,children:"Step"}),n.jsx("button",{className:"btn border border-squab-200 bg-white",onClick:Ye,children:"Reset"}),n.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[n.jsx("span",{className:"text-xs text-neutral-500",children:"Speed"}),n.jsx("input",{type:"range",min:"450",max:"2200",step:"50",value:C,onChange:ne=>T(Number(ne.target.value))})]})]})]}),xe&&n.jsx("div",{className:"mb-4 rounded-2xl border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-900",children:"Heads up: one or more selected players dont have a Best Ball row in this CSV  this will revert to Stableford points on any holes where Best Ball is missing."}),n.jsx("div",{className:"tm-viz-card mb-4",children:(()=>{const ne=(J||[]).map(H=>({h:H.hole,d:H.diffVal??0,res:H.res,match:H.match})),Ue=ne.length?ne[ne.length-1].h:0,q=Math.min(B,Math.max(1,typeof ce=="number"&&ce>0?ce:Ue||1)),L=ne.find(H=>H.h===q)||{d:0,res:"Halved"},X=L.d===0?"All Square":L.d>0?`${Math.abs(L.d)} Up (Team 1)`:`${Math.abs(L.d)} Up (Team 2)`,fe=L.res?L.res:"",Ee=Math.max(2,...ne.map(H=>Math.abs(H.d))),F=Math.min(6,Math.max(3,Ee)),G=[];for(let H=F;H>=-F;H--){const Ne=H===0?"AS":H>0?`${H} UP`:`${Math.abs(H)} DN`,ae=H===0?"All Square":H>0?"Team 1 leading":"Team 2 leading";G.push({v:H,label:Ne,sub:ae})}return n.jsxs("div",{className:"tm-sky",children:[n.jsxs("div",{className:"tm-ladder",children:[n.jsx("div",{className:"tm-ladder-title",children:"Match Position"}),G.map((H,Ne)=>n.jsxs("div",{className:"tm-rung "+(H.v===L.d?"current":""),children:[n.jsxs("div",{children:[n.jsx("div",{className:"label",children:H.label}),n.jsx("div",{className:"sub",children:H.sub})]}),n.jsx("span",{className:"pip"})]},Ne))]}),n.jsxs("div",{className:"tm-broadcast",children:[n.jsxs("div",{className:"tm-broadcast-top",children:[n.jsx("div",{className:"tm-bigstate",children:n.jsxs("div",{children:[n.jsxs("div",{className:"hole",children:["Hole ",q]}),n.jsx("div",{className:"state",children:X}),n.jsxs("div",{className:"result",children:["Result: ",fe]})]})}),n.jsxs("div",{className:"text-xs text-neutral-500",children:[Re,"  Holes completed: ",f,"/",B," ",He?" Match Closed":""]})]}),n.jsxs("div",{className:"tm-barwrap",children:[n.jsx("div",{className:"tm-bars","aria-label":"Match position bar graph by hole",children:Array.from({length:B}).map((H,Ne)=>{const ae=Ne+1,ye=(J||[]).find(rr=>rr.hole===ae),Te=ye?ye.diffVal??0:0,et=Math.min(F,Math.abs(Te)),Z=F?et/F*50:0,ze=Te>0,it=Te<0,ee=ze?"up":it?"down":"as",ft=q===ae,Rt=ze?{height:`${Z}%`,bottom:"50%"}:it?{height:`${Z}%`,bottom:`${50-Z}%`}:{height:"2%",bottom:"49%"};return n.jsxs("div",{className:`tm-barcell ${ft?"current":""}`,title:ye?`Hole ${ae}: ${ye.res}  ${ye.match}`:`Hole ${ae}: not played yet`,children:[n.jsx("div",{className:"tm-midline"}),n.jsx("div",{className:`tm-bar ${ee}`,style:Rt})]},ae)})}),n.jsx("div",{className:"tm-tape-num","aria-hidden":"true",children:Array.from({length:B}).map((H,Ne)=>n.jsx("div",{children:Ne+1},Ne))})]}),n.jsxs("div",{className:"mt-4 rounded-2xl border border-squab-200 bg-white/85 backdrop-blur px-4 py-3 shadow-sm",children:[n.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-[11px] font-black uppercase tracking-widest text-neutral-400",children:"Pick the players"}),n.jsxs("div",{className:"text-sm font-semibold text-neutral-800",children:["Choose ",n.jsx("span",{className:"font-black",children:"2 players"})," for ",n.jsx("span",{className:"font-black",children:"Team 1"})," and ",n.jsx("span",{className:"font-black",children:"Team 2"})," to replay the match"]}),n.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:"The match replay needs all 4 players selected."})]}),n.jsx("span",{className:"chip special",children:"Required"})]}),n.jsxs("div",{className:"mt-3",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-0",children:[n.jsxs("div",{className:"rounded-2xl border border-squab-200 p-3 bg-neutral-50",children:[n.jsx("div",{className:"text-xs text-neutral-500 font-bold uppercase mb-2",children:"Team 1"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("select",{className:"rounded-2xl border border-squab-200 px-3 py-2 bg-white ring-2 ring-emerald-200 focus:ring-emerald-400",value:c,onChange:H=>l(H.target.value),children:[n.jsx("option",{value:"",children:"Player 1"}),o.map(H=>n.jsx("option",{value:H,children:H},"t1p1-"+H))]}),n.jsxs("select",{className:"rounded-2xl border border-squab-200 px-3 py-2 bg-white ring-2 ring-emerald-200 focus:ring-emerald-400",value:u,onChange:H=>d(H.target.value),children:[n.jsx("option",{value:"",children:"Player 2"}),o.map(H=>n.jsx("option",{value:H,children:H},"t1p2-"+H))]})]})]}),n.jsxs("div",{className:"rounded-2xl border border-squab-200 p-3 bg-neutral-50",children:[n.jsx("div",{className:"text-xs text-neutral-500 font-bold uppercase mb-2",children:"Team 2"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("select",{className:"rounded-2xl border border-squab-200 px-3 py-2 bg-white ring-2 ring-emerald-200 focus:ring-emerald-400",value:x,onChange:H=>h(H.target.value),children:[n.jsx("option",{value:"",children:"Player 1"}),o.map(H=>n.jsx("option",{value:H,children:H},"t2p1-"+H))]}),n.jsxs("select",{className:"rounded-2xl border border-squab-200 px-3 py-2 bg-white ring-2 ring-emerald-200 focus:ring-emerald-400",value:p,onChange:H=>y(H.target.value),children:[n.jsx("option",{value:"",children:"Player 2"}),o.map(H=>n.jsx("option",{value:H,children:H},"t2p2-"+H))]})]})]})]}),n.jsxs("div",{className:"rounded-2xl border border-squab-200 p-4 bg-white mb-0 ring-2 ring-emerald-200 focus:ring-emerald-400",children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-neutral-500 font-bold uppercase",children:"Match"}),n.jsx("div",{className:"text-2xl font-black text-squab-900",children:Re}),n.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:["Holes completed: ",f,"/",B]})]}),nt&&n.jsx("div",{className:"px-4 py-2 rounded-2xl border text-sm font-bold "+(He?"bg-emerald-50 border-emerald-300 text-emerald-800":"bg-amber-50 border-amber-300 text-amber-800"),children:nt})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[n.jsxs("div",{className:"rounded-2xl border border-squab-200 bg-neutral-50 p-3",children:[n.jsx("div",{className:"text-xs text-neutral-500 font-bold uppercase mb-1",children:w.toUpperCase()}),n.jsx("div",{className:"flip "+(ce?"flip-active":""),children:n.jsxs("div",{className:"flip-inner",children:[n.jsx("div",{className:"flip-front text-4xl font-black text-squab-900",children:R??""}),n.jsx("div",{className:"flip-back text-4xl font-black text-squab-900",children:R??""})]})})]}),n.jsxs("div",{className:"rounded-2xl border border-squab-200 bg-neutral-50 p-3",children:[n.jsx("div",{className:"text-xs text-neutral-500 font-bold uppercase mb-1",children:N.toUpperCase()}),n.jsx("div",{className:"flip "+(ce?"flip-active":""),children:n.jsxs("div",{className:"flip-inner",children:[n.jsx("div",{className:"flip-front text-4xl font-black text-squab-900",children:D??""}),n.jsx("div",{className:"flip-back text-4xl font-black text-squab-900",children:D??""})]})})]})]}),n.jsx("div",{className:"text-xs text-neutral-500 mt-3",children:ce?`Hole ${ce}: points flip... then match updates.`:"Waiting for next hole..."})]})]})]}),n.jsxs("div",{className:"tm-story",children:[n.jsx("div",{className:"kicker",children:"What just happened"}),n.jsxs("div",{className:"line",children:["Hole ",q,": ",fe]}),n.jsxs("div",{className:"line2",children:["Match moves to ",n.jsx("b",{children:X})]})]})]})]})})()}),n.jsxs("div",{className:"rounded-2xl border border-squab-200 overflow-hidden",children:[n.jsx("div",{className:"px-4 py-2 bg-neutral-50 border-b border-squab-200 text-xs font-bold uppercase text-neutral-500",children:"Hole-by-hole  Better-ball Stableford  Matchplay hole result"}),n.jsx("div",{className:"overflow-auto table-wrap",children:n.jsxs("table",{className:"min-w-full text-sm table-zebra",children:[n.jsx("thead",{className:"bg-white sticky top-0",children:n.jsxs("tr",{className:"text-left text-xs uppercase tracking-wide text-neutral-500 font-bold border-b border-neutral-100",children:[n.jsx("th",{className:"py-2 px-3",children:"Hole"}),n.jsx("th",{className:"py-2 px-3",children:"Team 1 (best)"}),n.jsx("th",{className:"py-2 px-3",children:"Team 2 (best)"}),n.jsx("th",{className:"py-2 px-3",children:"Result"}),n.jsx("th",{className:"py-2 px-3",children:"Match"})]})}),n.jsxs("tbody",{className:"divide-y divide-neutral-100",children:[J.map(ne=>n.jsxs(ue.Fragment,{children:[n.jsxs("tr",{className:"hover:bg-neutral-50",children:[n.jsx("td",{className:"py-2 px-3",children:n.jsx("span",{className:"tm-holebadge",children:ne.hole})}),n.jsx("td",{className:"py-2 px-3",children:n.jsx("span",{className:"tm-scorepill",children:ne.t1})}),n.jsx("td",{className:"py-2 px-3",children:n.jsx("span",{className:"tm-scorepill",children:ne.t2})}),n.jsx("td",{className:"py-2 px-3",children:n.jsx("span",{className:"tm-resultpill",children:ne.res})}),n.jsx("td",{className:"py-2 px-3",children:n.jsx("span",{className:"tm-matchpill",children:ne.match})})]}),n.jsx("tr",{className:"bg-neutral-50/60",children:n.jsx("td",{className:"py-2 px-3 text-xs text-neutral-500",colSpan:5,children:n.jsxs("div",{className:"flex flex-col md:flex-row md:gap-6 gap-2",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-[10px] uppercase font-bold text-neutral-400 mb-1",children:"Team 1 details"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:ne.detail.t1Players.map((Ue,q)=>n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-white px-2 py-1",children:[n.jsx("div",{className:"font-semibold text-neutral-800 text-xs",children:Ue.name}),n.jsxs("div",{className:"text-[11px] text-neutral-600",children:["Pts: ",n.jsx("span",{className:"font-bold",children:Ue.pts})," ",n.jsxs("span",{className:"text-neutral-400",children:["(",Ue.method==="bestBall"?"Best Ball":Ue.method==="missingBestBall"?"Missing Best Ball":Ue.method,")"]})]})]},"t1d-"+ne.hole+"-"+q))})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-[10px] uppercase font-bold text-neutral-400 mb-1",children:"Team 2 details"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:ne.detail.t2Players.map((Ue,q)=>n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-white px-2 py-1",children:[n.jsx("div",{className:"font-semibold text-neutral-800 text-xs",children:Ue.name}),n.jsxs("div",{className:"text-[11px] text-neutral-600",children:["Pts: ",n.jsx("span",{className:"font-bold",children:Ue.pts})," ",n.jsxs("span",{className:"text-neutral-400",children:["(",Ue.method==="bestBall"?"Best Ball":Ue.method==="missingBestBall"?"Missing Best Ball":Ue.method,")"]})]})]},"t2d-"+ne.hole+"-"+q))})]})]})})}),n.jsx("tr",{className:"tm-spacer",children:n.jsx("td",{colSpan:5})})]},"row-"+ne.hole)),J.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"py-4 px-3 text-sm text-neutral-600",children:"Pick teams, then press Start."})})]})]})})]})]})}function lN({value:e,onChange:t,options:r}){return n.jsx("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 justify-center w-full",children:r.map(s=>{const i=String(s.value)===String(e);return n.jsx("button",{onClick:()=>t(s.value),className:"px-3 py-1.5 rounded-full text-sm font-black border transition "+(i?"bg-neutral-900 text-white border-neutral-900":"bg-white text-neutral-800 border-neutral-200 hover:border-neutral-400"),children:s.label},s.value)})})}function cN({a:e,b:t,labels:r,height:s=180}){const i=(e||[]).map(Number),a=(t||[]).map(Number),o=Math.max(i.length,a.length,0);if(o<2)return n.jsx("div",{className:"text-sm text-neutral-600",children:"Not enough games to chart yet."});const c=[...i,...a].filter(Number.isFinite),l=c.length?Math.min(...c):0,u=c.length?Math.max(...c):1,d=680,x=s,h=34,p=(d-2*h)/(o-1),y=m=>{if(!Number.isFinite(m))return NaN;if(u===l)return x/2;const v=(m-l)/(u-l);return x-h-v*(x-2*h)},w=m=>{let v="";for(let E=0;E<o;E++){const C=Number(m[E]);if(!Number.isFinite(C))continue;const T=h+E*p,B=y(C);Number.isFinite(B)&&(v+=(v?" L ":"M ")+T+" "+B)}return v||""},N=w(i),f=w(a);return n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("svg",{viewBox:`0 0 ${d} ${x}`,className:"w-full min-w-[680px]",children:[(()=>{if(u===l){const v=x/2,E=Math.round(l*10)/10;return n.jsxs("g",{children:[n.jsx("line",{x1:h,y1:v,x2:d-h,y2:v,stroke:"rgba(0,0,0,0.10)"}),n.jsx("text",{x:h-8,y:v+4,textAnchor:"end",fontSize:"10",fill:"rgba(0,0,0,0.45)",children:String(E)})]},"yt-flat")}const m=4;return Array.from({length:m+1}).map((v,E)=>{const C=l+(u-l)*(E/m),T=y(C),B=Math.round(C*10)/10;return n.jsxs("g",{children:[n.jsx("line",{x1:h,y1:T,x2:d-h,y2:T,stroke:"rgba(0,0,0,0.08)"}),n.jsx("text",{x:h-8,y:T+4,textAnchor:"end",fontSize:"10",fill:"rgba(0,0,0,0.45)",children:String(B)})]},"yt"+E)})})(),n.jsx("line",{x1:h,y1:x-h,x2:d-h,y2:x-h,stroke:"rgba(0,0,0,0.18)"}),n.jsx("line",{x1:h,y1:h,x2:h,y2:x-h,stroke:"rgba(0,0,0,0.18)"}),f?n.jsx("path",{d:f,fill:"none",stroke:"rgba(0,0,0,0.25)",strokeWidth:"3"}):null,N?n.jsx("path",{d:N,fill:"none",stroke:"currentColor",strokeWidth:"4"}):null,Array.from({length:o}).map((m,v)=>{const E=h+v*p,C=i[v],T=a[v],B=y(C),Y=y(T);return n.jsxs("g",{children:[Number.isFinite(Y)?n.jsx("circle",{cx:E,cy:Y,r:"4",fill:"rgba(0,0,0,0.25)"}):null,Number.isFinite(B)?n.jsx("circle",{cx:E,cy:B,r:"5",fill:"currentColor"}):null,r!=null&&r[v]?n.jsx("text",{x:E,y:x-10,textAnchor:"middle",fontSize:"10",fill:"rgba(0,0,0,0.5)",children:r[v]}):null]},v)})]})})}function uN({seasonModel:e,scoringMode:t,setScoringMode:r,grossCompare:s,setGrossCompare:i,seasonFiles:a,reportNextHcapMode:o,setReportNextHcapMode:c,seasonPlayer:l,setSeasonPlayer:u,seasonYear:d,setSeasonYear:x,seasonLimit:h,setSeasonLimit:p,seasonYears:y,seasonLoading:w,seasonProgress:N,seasonError:f,runSeasonAnalysis:m,setView:v}){var wa,yi,Na,Xt;const[E,C]=ue.useState(()=>{try{const b=window.__dslUiState&&window.__dslUiState.cohortMode||localStorage.getItem("dsl_cohortMode")||"field";return b==="field"||b==="band"?b:"field"}catch{return"field"}});ue.useEffect(()=>{try{window.__dslUiState=window.__dslUiState||{},window.__dslUiState.cohortMode=E;try{localStorage.setItem("dsl_cohortMode",E)}catch{}window.__dslUiState.seasonYear=d,window.__dslUiState.seasonLimit=h}catch{}},[E,d,h]);const[T,B]=ue.useState(!1),[Y,le]=ue.useState("all"),[J,De]=ue.useState(()=>{try{return localStorage.getItem("dsl_lens")||"pointsField"}catch{return"pointsField"}}),nt=J==="strokesPar"?"par":"field";ue.useEffect(()=>{J==="pointsField"?t!=="stableford"&&r("stableford"):t!=="gross"&&r("gross"),J==="strokesPar"&&E!=="field"&&C("field")},[J]);const Ke=ue.useMemo(()=>[{key:"pointsField_field",label:"Stableford Points  vs Field",pp:"pointsField",cohort:"field",rgb:"124,58,237",hint:"Stableford points ranked across everyone (overall view)."},{key:"pointsField_band",label:"Stableford Points  vs Handicap band",pp:"pointsField",cohort:"band",rgb:"124,58,237",hint:"Stableford points vs players with similar handicaps (fairer comparison)."},{key:"strokesField_field",label:"Score (Strokes)  vs Field",pp:"strokesField",cohort:"field",rgb:"37,99,235",hint:"Gross strokes compared across everyone (lower is better)."},{key:"strokesField_band",label:"Score (Strokes)  vs Handicap band",pp:"strokesField",cohort:"band",rgb:"37,99,235",hint:"Gross strokes vs similar handicaps (lower is better)."},{key:"strokesPar",label:"Score (Strokes)  vs Par",pp:"strokesPar",cohort:"field",rgb:"249,115,22",hint:"Absolute score relative to par (no field/band comparison)."}],[]),He=ue.useMemo(()=>{const b=Ke.find(g=>g.pp===J&&g.cohort===E);return b||J==="strokesPar"&&Ke.find(g=>g.key==="strokesPar")||Ke[0]},[Ke,J,E]),Ze=(He==null?void 0:He.key)||"pointsField_field",ce=ue.useMemo(()=>({background:`rgba(${(He==null?void 0:He.rgb)||"124,58,237"}, 1)`}),[He]);ue.useEffect(()=>{try{localStorage.setItem("dsl_lens",J)}catch{}try{window.dispatchEvent(new Event("dsl_lens_change"))}catch{}},[J]),ue.useEffect(()=>{const b=()=>{try{const g=localStorage.getItem("dsl_lens")||"pointsField";(g==="pointsField"||g==="strokesField"||g==="strokesPar")&&De(j=>j===g?j:g)}catch{}};return window.addEventListener("dsl_lens_change",b),window.addEventListener("storage",b),()=>{window.removeEventListener("dsl_lens_change",b),window.removeEventListener("storage",b)}},[]);const[$,R]=ue.useState(8),[U,D]=ue.useState(!1);ue.useEffect(()=>{try{if(!U)return;const b=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=b}}catch{}},[U]);const A=(b,g=NaN)=>Ve(b,g),W=b=>{const g=(b||[]).map(Number).filter(Number.isFinite);return g.length?g.reduce((j,_)=>j+_,0)/g.length:NaN},Fe=b=>{const g=(b||[]).map(Number).filter(Number.isFinite);if(g.length<2)return NaN;const j=W(g);let _=0;for(const S of g){const P=S-j;_+=P*P}return Math.sqrt(_/(g.length-1))},de=(b,g=1)=>cs(b,g),oe=(b,g=0)=>Number.isFinite(b)?`${de(b*100,g)}%`:"",xe=b=>oe(b,0),Ye=Hw,O=ue.useMemo(()=>{const b=(e==null?void 0:e.players)||[];return b.find(g=>g.name===l)||b[0]||null},[e,l]),ht=ue.useMemo(()=>O&&Array.isArray(O.series)?O.series:[],[O]),Re=ue.useMemo(()=>{try{return Uw(ht)}catch{return{ok:!1,reason:"error"}}},[ht]),ne=String((O==null?void 0:O.name)||"").trim().split(/\s+/).filter(Boolean),Ue=ne[0]||"",q=ne.slice(1).join(" "),L=(e==null?void 0:e.players)||[],X=(e==null?void 0:e.field)||{},fe=ue.useMemo(()=>{const b=ca(dm(O)),g=(L||[]).filter(j=>ca(dm(j))===b);return{byPar:Pi(g,"byPar"),bySI:Pi(g,"bySI"),byYards:Pi(g,"byYards"),byParGross:Pi(g,"byParGross"),bySIGross:Pi(g,"bySIGross"),byYardsGross:Pi(g,"byYardsGross")}},[Dw,X,L,O]),Ee=t==="gross";ue.useMemo(()=>ea({scoringMode:t,dim:"Par",mapObj:Ee?O==null?void 0:O.byParGross:O==null?void 0:O.byPar,fieldObj:Ee?fe==null?void 0:fe.byParGross:fe==null?void 0:fe.byPar}),[O,X,t]),ue.useMemo(()=>ea({scoringMode:t,dim:"SI",mapObj:Ee?O==null?void 0:O.bySIGross:O==null?void 0:O.bySI,fieldObj:Ee?fe==null?void 0:fe.bySIGross:fe==null?void 0:fe.bySI,limit:6}),[O,X,t]),ue.useMemo(()=>{const b=Ee?O==null?void 0:O.byYardsGross:(O==null?void 0:O.byYards)||(O==null?void 0:O.byParYards),g=Ee?fe==null?void 0:fe.byYardsGross:(X==null?void 0:X.byYards)||(X==null?void 0:X.byParYards);return ea({scoringMode:t,dim:"Yd",mapObj:b,fieldObj:g,limit:8})},[O,X,t]);const[F,G]=ue.useState("stableford"),[H,Ne]=ue.useState(!0),ae=b=>b&&b.holes?Number(b.pts)/Number(b.holes):NaN,ye=b=>b&&b.holes?Number(b.val)/Number(b.holes):NaN,Te=b=>b&&b.name&&!(typeof Yt=="function"&&Yt(b.name)),et=ue.useMemo(()=>{const b=(Array.isArray(L)?L:[]).filter(Te),g=_=>{const S=b.map(P=>{var k,I;if(F==="gross"){const z=(k=P==null?void 0:P.byParGross)==null?void 0:k[_],V=z&&Number.isFinite(Number(z.holes))?Number(z.holes):NaN,K=ye(z);return{name:P.name,v:K,holes:V}}else{const z=(I=P==null?void 0:P.byPar)==null?void 0:I[_],V=z&&Number.isFinite(Number(z.holes))?Number(z.holes):NaN,K=ae(z);return{name:P.name,v:K,holes:V}}}).filter(P=>Number.isFinite(P.v));return S.sort((P,k)=>F==="gross"?P.v-k.v:k.v-P.v),S.slice(0,20)};return{all:(()=>{const _=["Par 3","Par 4","Par 5"],S=b.map(P=>{if(F==="gross"){let k=0,I=0;_.forEach(V=>{var ge;const K=(ge=P==null?void 0:P.byParGross)==null?void 0:ge[V],M=K&&Number.isFinite(Number(K.holes))?Number(K.holes):0,re=K&&Number.isFinite(Number(K.val))?Number(K.val):0;k+=M,I+=re});const z=k?I/k:NaN;return{name:P.name,v:z,holes:k}}else{let k=0,I=0;_.forEach(V=>{var ge;const K=(ge=P==null?void 0:P.byPar)==null?void 0:ge[V],M=K&&Number.isFinite(Number(K.holes))?Number(K.holes):0,re=K&&Number.isFinite(Number(K.pts))?Number(K.pts):0;k+=M,I+=re});const z=k?I/k:NaN;return{name:P.name,v:z,holes:k}}}).filter(P=>Number.isFinite(P.v));return S.sort((P,k)=>F==="gross"?P.v-k.v:k.v-P.v),S.slice(0,20)})(),p3:g("Par 3"),p4:g("Par 4"),p5:g("Par 5")}},[L,F]),Z=ue.useMemo(()=>{if(!O)return{label:"Field",players:L,fieldAgg:X};if(E==="field")return{label:"Field",players:L,fieldAgg:X};const b=Array.isArray(O.series)?O.series:[],g=W(b.map(K=>A(K.hcap,NaN))),j=Number.isFinite(g)?g>=18?6:g>=10?4:3:4,_=L.filter(K=>{if(!K||K.name===O.name)return!1;const M=Array.isArray(K.series)?K.series:[],re=W(M.map(ge=>A(ge.hcap,NaN)));return Number.isFinite(g)&&Number.isFinite(re)&&Math.abs(re-g)<=j});if(_.length<3)return{label:"Field (band too small)",players:L,fieldAgg:X};const S=()=>({holes:0,pts:0,wipes:0}),P=(K,M)=>{if(!K||!M)return;const re=A(M.holes,0);re&&(K.holes+=re,Number.isFinite(A(M.pts,NaN))&&(K.pts+=A(M.pts,0)),Number.isFinite(A(M.wipes,NaN))&&(K.wipes+=A(M.wipes,0)))},k=()=>({holes:0,val:0,bogeyPlus:0,parOrBetter:0,birdieOrBetter:0,doublePlus:0,eaglePlus:0,birdies:0,pars:0,bogeys:0,doubles:0,triplesPlus:0}),I=(K,M)=>{if(!K||!M)return;const re=A(M.holes,0);re&&(K.holes+=re,K.val+=A(M.val,0),["bogeyPlus","parOrBetter","birdieOrBetter","doublePlus","eaglePlus","birdies","pars","bogeys","doubles","triplesPlus"].forEach(ge=>{K[ge]+=A(M[ge],0)}))},z={totals:S(),totalsGross:k(),byPar:{"Par 3":S(),"Par 4":S(),"Par 5":S(),Unknown:S()},byParGross:{"Par 3":k(),"Par 4":k(),"Par 5":k(),Unknown:k()},bySI:{"16":S(),"712":S(),"1318":S(),Unknown:S()},bySIGross:{"16":k(),"712":k(),"1318":k(),Unknown:k()},byYards:{},byYardsGross:{}},V=(K,M,re)=>{M&&Object.keys(M).forEach(ge=>{K[ge]||(K[ge]=re?k():S()),re?I(K[ge],M[ge]):P(K[ge],M[ge])})};return _.forEach(K=>{P(z.totals,K.totals),I(z.totalsGross,K.totalsGross),["Par 3","Par 4","Par 5","Unknown"].forEach(M=>{var re,ge;P(z.byPar[M],(re=K.byPar)==null?void 0:re[M]),I(z.byParGross[M],(ge=K.byParGross)==null?void 0:ge[M])}),["16","712","1318","Unknown"].forEach(M=>{var re,ge;P(z.bySI[M],(re=K.bySI)==null?void 0:re[M]),I(z.bySIGross[M],(ge=K.bySIGross)==null?void 0:ge[M])}),V(z.byYards,K.byYards,!1),V(z.byYardsGross,K.byYardsGross,!0)}),{label:`Handicap band (${j})`,players:_,fieldAgg:z}},[O,E,L,X]),ze=Z.fieldAgg||X;ue.useEffect(()=>{try{const b=String(E||"field")==="field"?"field":"band",g=Array.isArray(Z==null?void 0:Z.players)?Z.players:[],j=Array.isArray(O==null?void 0:O.series)?O.series:[],_=W(j.map(z=>A(z==null?void 0:z.hcap,NaN))),S=Number.isFinite(_)?_>=18?6:_>=10?4:3:4;let P="Field";if(b==="band")if(Number.isFinite(_)){const z=_-S,V=_+S;P=`Handicap band (${z.toFixed(1)}${V.toFixed(1)})`}else P=`Handicap band (${S})`;else P="Field";/Field \(band too small\)/.test(String((Z==null?void 0:Z.label)||""))&&(P="Field (band too small)");let k=1/0,I=-1/0;for(const z of g){const V=Array.isArray(z==null?void 0:z.series)?z.series:[],K=W(V.map(M=>A(M==null?void 0:M.hcap,NaN)));Number.isFinite(K)&&(k=Math.min(k,K),I=Math.max(I,K))}window.__dslOverviewReport={playerName:String((O==null?void 0:O.name)||""),yearLabel:d,seasonLimit:h,scoringMode:t,lensMode:localStorage.getItem("dsl_lens")||"pointsField",comparatorMode:J==="strokesPar"?"par":b,cohortLabel:J==="strokesPar"?"Par baseline":String((Z==null?void 0:Z.label)||P),peerBand:J==="strokesPar"?"Par baseline":P,peerPlayersN:J==="strokesPar"?0:g.length,peerMin:J==="strokesPar"?NaN:k!==1/0?k:NaN,peerMax:J==="strokesPar"?NaN:I!==-1/0?I:NaN,peerContextBand:P,peerContextPlayersN:g.length,peerContextMin:k!==1/0?k:NaN,peerContextMax:I!==-1/0?I:NaN,playerAgg:O,peerAgg:J==="strokesPar"?null:ze,peerContextAgg:ze};try{window.dispatchEvent(new Event("dsl_overview_report_change"))}catch{}}catch{}},[O,Z,ze,E,d,h,t,J]);const it=b=>{const g=A(b==null?void 0:b.holes,0),j=A(b==null?void 0:b.pts,NaN);return g?j/g:NaN},ee=b=>{const g=A(b==null?void 0:b.holes,0),j=A(b==null?void 0:b.val,NaN);return g?j/g:NaN},ft=b=>{const g=Array.isArray(b==null?void 0:b.series)?b.series.slice():[];return g.sort((j,_)=>(Number(j.dateMs)||Number(j.idx)||0)-(Number(_.dateMs)||Number(_.idx)||0)),g},rr=(()=>{const b=ft(O),g=Number.isFinite(A(O==null?void 0:O.games,NaN))?Number(O.games):b.length;return g&&g>0?g:b.length})()===1,Fr=b=>{const g=ft(b);if(!g.length)return NaN;const j=t==="gross"?g.map(_=>{const S=A(_.gross,NaN),P=A(_.parTotal,NaN);return Number.isFinite(S)&&Number.isFinite(P)?S-P:NaN}).filter(Number.isFinite):g.map(_=>A(_.pts,NaN)).filter(Number.isFinite);return j.length?rr?j[j.length-1]:W(j):NaN},Gt=Fr(O),Wt=(()=>{const g=((Z==null?void 0:Z.players)||[]).filter(j=>j&&O&&j.name!==O.name).map(j=>Fr(j)).filter(Number.isFinite);return g.length?g.reduce((j,_)=>j+_,0)/g.length:NaN})(),qr=Ye(t,Gt,Wt);(()=>{const b=Number(O==null?void 0:O.games);return Number.isFinite(b)&&b>0?b:(Array.isArray(O==null?void 0:O.series)?O.series.length:0)||0})(),(()=>{const b=(O==null?void 0:O.byParGross)||(O==null?void 0:O.byPar)||{};return Object.values(b).reduce((g,j)=>g+Ve((j==null?void 0:j.holes)||(j==null?void 0:j.n)||(j==null?void 0:j.count)||0,0),0)})();const Ut=Array.isArray(O==null?void 0:O.series)?O.series.slice():[],ns=(Number.isFinite(O==null?void 0:O.games)?Number(O.games):Ut.length)||0;Ut.sort((b,g)=>{const j=Number.isFinite(b==null?void 0:b.dateMs)&&Number(b.dateMs)>0?Number(b.dateMs):Number((b==null?void 0:b.idx)||0),_=Number.isFinite(g==null?void 0:g.dateMs)&&Number(g.dateMs)>0?Number(g.dateMs):Number((g==null?void 0:g.idx)||0);return j-_});const xs=String(h||"").toLowerCase()==="all"?0:Number(h),Gr=xs&&xs>0?Ut.slice(-xs):Ut.slice(),$n=b=>{if(!b)return NaN;if(t==="gross"){const g=A(b.gross,NaN),j=A(b.parTotal,NaN);return Number.isFinite(g)&&Number.isFinite(j)?g-j:NaN}return A(b.pts,NaN)},Fs=Gr.map($n),un=Gr.map((b,g)=>{if(Number.isFinite(Number(b==null?void 0:b.dateMs))&&Number(b.dateMs)>0){const j=new Date(Number(b.dateMs));return`${j.getDate()}/${j.getMonth()+1}`}return`G${(Number(b==null?void 0:b.idx)||g)+1}`}),dn=(()=>{const g=(Array.isArray(Z==null?void 0:Z.players)?Z.players:Array.isArray(e==null?void 0:e.players)?e.players:[]).filter(j=>j&&j.name!==(O==null?void 0:O.name));return Gr.map(j=>{const _=j==null?void 0:j.file;if(!_)return NaN;const S=[];for(const P of g){const I=lm(P==null?void 0:P.series).find(V=>(V==null?void 0:V.file)===_),z=$n(I);Number.isFinite(z)&&S.push(z)}return S.length?W(S):NaN})})(),hi=Gr.map(()=>t==="gross"?0:36),Mn=Gr.slice(),fa=t==="gross"?Mn.map(b=>A(b.gross,NaN)-A(b.parTotal,NaN)).filter(Number.isFinite):Mn.map(b=>A(b.pts,NaN)).filter(Number.isFinite),fi=W(fa),Is=Fe(t==="gross"?Ut.map(b=>A(b.gross,NaN)-A(b.parTotal,NaN)):Ut.map(b=>A(b.pts,NaN))),zs=(()=>{const b=t==="gross"?Ut.map(j=>A(j.gross,NaN)-A(j.parTotal,NaN)):Ut.map(j=>A(j.pts,NaN)),g=om(b.filter(Number.isFinite));return Number.isFinite(g)?t==="gross"?-g:g:NaN})(),at=t==="gross"?A((wa=X==null?void 0:X.metrics)==null?void 0:wa.volGross,NaN):A((yi=X==null?void 0:X.metrics)==null?void 0:yi.volPts,NaN);t==="gross"?A((Na=X==null?void 0:X.metrics)==null?void 0:Na.grossVelocity,NaN):A((Xt=X==null?void 0:X.metrics)==null?void 0:Xt.velocity,NaN);const Ge=(()=>{const g=(Array.isArray(e==null?void 0:e.players)?e.players:[]).map(j=>{const _=Array.isArray(j==null?void 0:j.series)?j.series.slice():[];if(!_.length)return NaN;_.sort((P,k)=>{const I=Number.isFinite(P==null?void 0:P.dateMs)&&Number(P.dateMs)>0?Number(P.dateMs):Number((P==null?void 0:P.idx)||0),z=Number.isFinite(k==null?void 0:k.dateMs)&&Number(k.dateMs)>0?Number(k.dateMs):Number((k==null?void 0:k.idx)||0);return I-z});const S=t==="gross"?_.map(P=>A(P.gross,NaN)-A(P.parTotal,NaN)):_.map(P=>A(P.pts,NaN));return Fe(S.filter(Number.isFinite))}).filter(Number.isFinite);return g.length?g.reduce((j,_)=>j+_,0)/g.length:NaN})();(()=>{const g=(Array.isArray(e==null?void 0:e.players)?e.players:[]).map(j=>{const _=Array.isArray(j==null?void 0:j.series)?j.series.slice():[];if(!_.length)return NaN;_.sort((k,I)=>{const z=Number.isFinite(k==null?void 0:k.dateMs)&&Number(k.dateMs)>0?Number(k.dateMs):Number((k==null?void 0:k.idx)||0),V=Number.isFinite(I==null?void 0:I.dateMs)&&Number(I.dateMs)>0?Number(I.dateMs):Number((I==null?void 0:I.idx)||0);return z-V});const S=t==="gross"?_.map(k=>A(k.gross,NaN)-A(k.parTotal,NaN)):_.map(k=>A(k.pts,NaN)),P=om(S.filter(Number.isFinite));return Number.isFinite(P)?t==="gross"?-P:P:NaN}).filter(Number.isFinite);return g.length?g.reduce((j,_)=>j+_,0)/g.length:NaN})();const lt=Number.isFinite(at)?at:Ge,Ie=ue.useMemo(()=>{const b=ft(O),j=String(h||"").toLowerCase()==="all"?0:Number(h);return j&&j>0?b.slice(-j):b},[O,h]),Xe=ue.useMemo(()=>{try{return tc({scoringMode:t,windowSeries:Ie})}catch{return{birdiePlusRate:NaN,parRate:NaN,bogeyRate:NaN,badRate:NaN}}},[t,Ie]),Je=ue.useMemo(()=>{const b=(L||[]).flatMap(_=>Array.isArray(_==null?void 0:_.series)?_.series:[]).filter(Boolean);b.sort((_,S)=>(Number(_==null?void 0:_.dateMs)||Number(_==null?void 0:_.idx)||0)-(Number(S==null?void 0:S.dateMs)||Number(S==null?void 0:S.idx)||0));const j=String(h||"").toLowerCase()==="all"?0:Number(h);return j&&j>0?b.slice(-j):b},[L,h]),Nt=ue.useMemo(()=>{try{return tc({scoringMode:t,windowSeries:Je})}catch{return{birdiePlusRate:NaN,parRate:NaN,bogeyRate:NaN,badRate:NaN}}},[t,Je]),It=b=>{const g=(b||[]).map(Number).filter(Number.isFinite);return g.length?g.reduce((j,_)=>j+_,0)/g.length:NaN},cr=It(Ie.map(b=>A(b==null?void 0:b.pts,A(b==null?void 0:b.points,NaN)))),Wr=It(Ie.map(b=>A(b==null?void 0:b.gross,NaN))),bs=It(Ie.map(b=>A(b==null?void 0:b.frontPts,NaN))),Os=It(Ie.map(b=>A(b==null?void 0:b.backPts,NaN))),ma=(()=>{let b=bs,g=Os;if(!Number.isFinite(b)||!Number.isFinite(g)){const j=[],_=[];for(const S of Ie){const P=Array.isArray(S==null?void 0:S.perHole)?S.perHole:null;if(!P)continue;const k=P.slice(0,9).reduce((z,V)=>z+A(V,0),0),I=P.slice(9,18).reduce((z,V)=>z+A(V,0),0);Number.isFinite(k)&&j.push(k),Number.isFinite(I)&&_.push(I)}b=It(j),g=It(_)}return!Number.isFinite(b)||!Number.isFinite(g)?"No clear front/back split.":Math.abs(b-g)<.5?"Front and back 9 are basically even.":b>g?"You score stronger on the front 9.":"You score stronger on the back 9."})(),sr=Number.isFinite(zs)?zs>.05?"Getting better":zs<-.05?"Getting worse":"Flat":"Not enough data",Ln=!Number.isFinite(Is)||!Number.isFinite(lt)?"Not enough data":Is<lt?"More consistent":"Less consistent",Ir=(b,g=1,j=!1)=>{const _=Number(b);if(!Number.isFinite(_))return"";const S=j?-_:_;return(S>0?"+":"")+cs(S,g)},ys=b=>{const g=(Array.isArray(L)?L:[]).filter(M=>M&&M.name&&M.name!==(O==null?void 0:O.name)&&!(typeof Yt=="function"&&Yt(M.name))),j=Ie,_=It(b==="gross"?j.map(M=>A(M==null?void 0:M.gross,NaN)):j.map(M=>A(M==null?void 0:M.pts,A(M==null?void 0:M.points,NaN)))),S=g.map(M=>{const re=(()=>{const ie=ft(M),Se=String(h||"").toLowerCase()==="all"?0:Number(h);return Se&&Se>0?ie.slice(-Se):ie})(),ge=It(b==="gross"?re.map(ie=>A(ie==null?void 0:ie.gross,NaN)):re.map(ie=>A(ie==null?void 0:ie.pts,A(ie==null?void 0:ie.points,NaN))));return{name:M.name,v:ge}}).filter(M=>Number.isFinite(M.v)),P=[{name:(O==null?void 0:O.name)||"You",v:_},...S].filter(M=>Number.isFinite(M.v)),k=(M,re)=>b==="gross"?M.v-re.v:re.v-M.v;P.sort(k);const I=P.findIndex(M=>String(M.name)===String((O==null?void 0:O.name)||"You"))+1,z=P.length||0,V=S.length?S.reduce((M,re)=>M+re.v,0)/S.length:NaN,K=Number.isFinite(_)&&Number.isFinite(V)?_-V:NaN;return{pos:I||NaN,total:z,selfVal:_,fieldAvg:V,delta:K}},nr=ue.useMemo(()=>ys("stableford"),[O,L,h,d]),ur=ue.useMemo(()=>ys("gross"),[O,L,h,d]),Qt=b=>Ew(b),pa=b=>{const g=Array.isArray(b==null?void 0:b.imputedGrossPerHole)?b.imputedGrossPerHole.map(Number):Array.isArray(b==null?void 0:b.grossPerHole)?b.grossPerHole.map(Number):null;if(!g||!g.length)return NaN;const{pArr:j,sArr:_}=Qt(b);if(!j||!_||j.length<9||_.length<9)return NaN;const S=Number((b==null?void 0:b.slope)||(b==null?void 0:b.slopeRating)||(b==null?void 0:b.courseSlope)||(b==null?void 0:b.teeSlope)||0),P=Number((b==null?void 0:b.rating)||(b==null?void 0:b.courseRating)||(b==null?void 0:b.teeRating)||0),k=Number.isFinite(Number(b==null?void 0:b.parTotal))?Number(b==null?void 0:b.parTotal):j.reduce((K,M)=>K+(Number(M)||0),0),I=Number((b==null?void 0:b.startExact)??(b==null?void 0:b.index)??(b==null?void 0:b.handicapIndex)??(b==null?void 0:b.hi)??(O==null?void 0:O.startExact)??(O==null?void 0:O.hcap)??NaN);if(!Number.isFinite(S)||S<=0||!Number.isFinite(P)||!Number.isFinite(k)||k<=0||!Number.isFinite(I))return NaN;const V=gd(g,{pars:j,si:_},I,S,P);return Number.isFinite(V)?xd(V,S,P,0):NaN},Po=b=>{const g=Array.isArray(b)?b.slice():[];g.sort((_,S)=>(Number(_==null?void 0:_.dateMs)||Number(_==null?void 0:_.idx)||0)-(Number(S==null?void 0:S.dateMs)||Number(S==null?void 0:S.idx)||0));const j=g.map(pa).filter(Number.isFinite);return j.length<3?NaN:Q0(j.slice(-20))},Un=ue.useMemo(()=>Po(Ie),[Ie]),hn=Number.isFinite(Un)?Us(Un,0,36):Un,jt=ue.useMemo(()=>{const b=Ie.slice().sort((g,j)=>(Number(g==null?void 0:g.dateMs)||Number(g==null?void 0:g.idx)||0)-(Number(j==null?void 0:j.dateMs)||Number(j==null?void 0:j.idx)||0));return b.length?b[b.length-1]:null},[Ie]),Co=ue.useMemo(()=>{if(typeof(jt==null?void 0:jt.isWinner)=="boolean")return jt.isWinner;try{const b=(jt==null?void 0:jt.file)||null;if(!b)return!1;const g=[];for(const k of Array.isArray(L)?L:[]){if(!k||!k.name||typeof Yt=="function"&&Yt(k.name))continue;const z=ft(k).find(M=>M&&M.file===b);if(!z)continue;const V=A(z==null?void 0:z.pts,A(z==null?void 0:z.points,NaN)),K=Array.isArray(z==null?void 0:z.perHole)?z.perHole:[];Number.isFinite(V)&&g.push({name:k.name,points:V,perHole:K})}if(!g.length)return!1;g.sort((k,I)=>I.points-k.points||compareByCountback(k,I));const j=g[0].points,_=g.filter(k=>k.points===j);let S=_.length?[_[0]]:[];for(let k=1;k<_.length;k++){const I=compareByCountback(_[k],S[0]);I>0?S=[_[k]]:I===0&&S.push(_[k])}return new Set(S.map(k=>String(k.name||"").trim())).has(String((O==null?void 0:O.name)||"").trim())}catch{return!1}},[jt,L,O]),vs=A(jt==null?void 0:jt.startExact,A(O==null?void 0:O.startExact,A(O==null?void 0:O.hcap,NaN))),mi=A(jt==null?void 0:jt.pts,A(jt==null?void 0:jt.points,NaN)),qs=String((jt==null?void 0:jt.gender)||(O==null?void 0:O.gender)||"M"),ga=Number.isFinite(vs)&&Number.isFinite(mi)?J0(vs,qs,mi,A(jt==null?void 0:jt.back9,0),Co).nextExact:NaN,Gs=A(O==null?void 0:O.hcap,A(O==null?void 0:O.startExact,A(O==null?void 0:O.handicapExact,A(O==null?void 0:O.handicapIndex,A(O==null?void 0:O.index,A(O==null?void 0:O.hi,A(vs,NaN))))))),Ao=o==="same"?Number.isFinite(Gs)?Gs:NaN:o==="den"?ga:o==="whs"?hn:NaN,Bn=(b,g,j)=>{if(!Number.isFinite(b))return"text-neutral-500";const _=Number.isFinite(j)?j:.1;return Math.abs(b)<=_?"text-neutral-500":(g?b>0:b<0)?"text-emerald-700":"text-rose-700"};(()=>{const g=Ut.slice(-12).map(k=>t==="gross"?A(k.gross,NaN)-A(k.parTotal,NaN):A(k.pts,NaN)).filter(Number.isFinite);if(!g.length)return"";const j=Math.min(...g),S=Math.max(...g)-j||1;return g.map((k,I)=>{const z=g.length===1?100:I*(200/(g.length-1)),V=34-(k-j)/S*28;return`${z.toFixed(1)},${V.toFixed(1)}`}).join(" ")})();const Ro=ue.useMemo(()=>{const b=fi;if(!Number.isFinite(b))return NaN;const j=(E==="field"?L:Z.players).filter(S=>S&&S.name!==O.name).map(S=>{const P=lm(S==null?void 0:S.series),I=Gr.map(V=>V==null?void 0:V.file).filter(Boolean).map(V=>{const K=P.find(re=>(re==null?void 0:re.file)===V),M=t==="gross"?A(K==null?void 0:K.gross,NaN)-A(K==null?void 0:K.parTotal,NaN):A(K==null?void 0:K.pts,NaN);return Number.isFinite(M)?M:NaN}).filter(Number.isFinite),z=W(I);return Number.isFinite(z)?z:null}).filter(S=>S!=null);return j.length?j.filter(S=>t==="gross"?b<=S:b>=S).length/j.length:NaN},[fi,E,L,Z.players,t]),pi=W(Ut.map(b=>A(b.hcap,NaN))),gi=(b,g,j,_,S=8)=>{const P=[],k=(()=>{const z=Array.isArray(Ut)?Ut.length:Number(Ut);if(Number.isFinite(z)&&z>0)return z;const V=Object.values(g||{}).reduce((K,M)=>K+A(M==null?void 0:M.holes,0),0);return V>0?V/18:0})();return Object.keys(g||{}).forEach(z=>{const V=g==null?void 0:g[z],K=j==null?void 0:j[z],M=A(V==null?void 0:V.holes,0);if(!M)return;const re=_?ee(V):it(V),ge=_?ee(K):it(K),ie=Ye(_?"gross":"stableford",re,ge),he=k>0?k:1,Se=he>0?M/he:0,We=ie*Se;P.push({key:z,label:`${b} ${z}`,holes:M,mePH:re,fldPH:ge,dGood:ie,impactRd:We})}),P.sort((z,V)=>Math.abs(V.impactRd)-Math.abs(z.impactRd)),P},is=J!=="pointsField",xa=J==="strokesPar"?"par":"field",ba=b=>{const g={};return Object.keys(b||{}).forEach(j=>{var S;const _=A((S=b==null?void 0:b[j])==null?void 0:S.holes,0);_&&(g[j]={holes:_,val:0})}),g},To=is?(O==null?void 0:O.byParGross)||{}:(O==null?void 0:O.byPar)||{},Fo=xa==="par"?ba(To):is?(ze==null?void 0:ze.byParGross)||{}:(ze==null?void 0:ze.byPar)||{},Io=gi("Par",To,Fo,is,6),Oo=is?(O==null?void 0:O.bySIGross)||{}:(O==null?void 0:O.bySI)||{},Do=xa==="par"?ba(Oo):is?(ze==null?void 0:ze.bySIGross)||{}:(ze==null?void 0:ze.bySI)||{},ya=gi("SI",Oo,Do,is,6),xi=is?(O==null?void 0:O.byYardsGross)||{}:(O==null?void 0:O.byYards)||{},wc=xa==="par"?ba(xi):is?(ze==null?void 0:ze.byYardsGross)||{}:(ze==null?void 0:ze.byYards)||{},bi=gi("Yds",xi,wc,is,8),fn=[...Io,...ya,...bi].filter(b=>Number.isFinite(b==null?void 0:b.impactRd)),as=fn.filter(b=>Number.isFinite(b==null?void 0:b.impactRd)&&b.impactRd<0).slice().sort((b,g)=>b.impactRd-g.impactRd).slice(0,3),ir=fn.filter(b=>Number.isFinite(b==null?void 0:b.impactRd)&&b.impactRd>0).slice().sort((b,g)=>g.impactRd-b.impactRd).slice(0,3),Nc=({row:b})=>{const g=Number(b==null?void 0:b.dGood),j=Number(b==null?void 0:b.impactRd),_=Number.isFinite(g)&&g>0,S=Number.isFinite(g)&&g<0,P=_?"text-emerald-700":S?"text-rose-700":"text-neutral-700",k=Math.max(-1,Math.min(1,Number.isFinite(j)?j/2.5:0)),I=k>=0?50:50+k*50,z=Math.abs(k)*50,[V,K]=ue.useState(!1);ue.useEffect(()=>{const ge=setTimeout(()=>K(!0),20);return()=>clearTimeout(ge)},[]);const M=V?I:50,re=V?z:0;return n.jsx("div",{className:"flex items-center gap-3 py-1",children:n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("div",{className:"truncate font-extrabold text-neutral-900",children:b.label}),n.jsxs("div",{className:`text-xs font-black tabular-nums ${P}`,children:[Number.isFinite(j)?(j>=0?"+":"")+de(j,2):"",n.jsx("span",{className:"text-neutral-400 font-semibold",children:" /rd"})]})]}),n.jsxs("div",{className:"mt-1 text-[11px] text-neutral-500",children:[b.holes," holes  ",J==="pointsField"?`${de(b.mePH,2)} vs ${de(b.fldPH,2)} pts/hole`:J==="strokesPar"?`${de(b.mePH,2)} over/par (vs par)`:`${de(b.mePH,2)} vs ${de(b.fldPH,2)} over/par`]}),n.jsxs("div",{className:"mt-2 flex-1 relative h-8 bg-neutral-100 rounded-lg overflow-hidden shadow-inner border border-neutral-200/50",children:[n.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-neutral-300 z-10 opacity-50"}),n.jsx("div",{className:"bar-anim absolute top-0 bottom-0 transition-all duration-500 ease-out "+(_?"bg-gradient-to-r from-emerald-400 to-emerald-500":S?"bg-gradient-to-l from-rose-400 to-rose-500":"bg-neutral-300"),style:{left:`${M}%`,width:`${re}%`}})]})]})})},$o=({rows:b,title:g="Impact Waterfall"})=>{const _=(Array.isArray(b)?b.filter(me=>Number.isFinite(Number(me==null?void 0:me.impactRd))):[]).slice().sort((me,Oe)=>Math.abs(Oe.impactRd)-Math.abs(me.impactRd)).slice(0,8),S=[{label:"Baseline",v:0}];_.forEach(me=>S.push({label:me.label,v:Number(me.impactRd)})),S.push({label:"Now",v:0});let P=0;const k=S.map((me,Oe)=>{if(Oe===0)return{...me,start:0,end:0,cum:0,kind:"base"};if(Oe===S.length-1)return{...me,start:0,end:P,cum:P,kind:"end"};const ct=P;return P+=me.v,{...me,start:ct,end:P,cum:P,kind:"step"}}),I=Math.max(1,...k.map(me=>Math.max(Math.abs(me.start),Math.abs(me.end)))),z=720,V=140,K=36,M=18,re=z-K*2,ge=V-M*2,ie=k.length,he=re/Math.max(1,ie-1),Se=M+ge/2,We=me=>Se-me/I*(ge/2);return n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-gradient-to-b from-white to-neutral-50 p-4","data-reveal":!0,children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:g}),n.jsxs("div",{className:"text-sm text-neutral-600 mt-1",children:["A quick visual of your biggest movers. Buckets overlap across lenses, so treat this as a ",n.jsx("span",{className:"font-semibold",children:"story of momentum"}),", not an exact addup."]})]}),n.jsxs("span",{className:"chip border-neutral-200 bg-white text-neutral-700",children:["Top ",_.length," movers"]})]}),n.jsx("div",{className:"mt-3 overflow-x-auto",children:n.jsxs("svg",{viewBox:`0 0 ${z} ${V}`,className:"w-full min-w-[680px]",children:[n.jsx("line",{x1:K,y1:Se,x2:z-K,y2:Se,stroke:"rgba(0,0,0,0.15)",strokeWidth:"1"}),k.map((me,Oe)=>{const ct=K+Oe*he,Pt=We(me.start),dr=We(me.end),Or=me.end>=me.start,Vt=Math.abs(dr-Pt),Dr=18,yr=Or?dr:Pt,kr=me.kind==="base"||me.kind==="end"?"rgba(59,130,246,0.35)":me.v>=0?"rgba(16,185,129,0.55)":"rgba(244,63,94,0.55)";return n.jsxs("g",{children:[Oe>0&&n.jsx("line",{x1:K+(Oe-1)*he,y1:We(k[Oe-1].end),x2:ct,y2:Pt,stroke:"rgba(0,0,0,0.25)",strokeWidth:"1.25"}),n.jsx("rect",{x:ct-Dr/2,y:yr,width:Dr,height:Math.max(2,Vt),rx:"4",fill:kr}),n.jsx("circle",{cx:ct,cy:dr,r:"2.5",fill:"rgba(0,0,0,0.35)"}),n.jsx("text",{x:ct,y:V-6,textAnchor:"middle",fontSize:"10",fill:"rgba(0,0,0,0.65)",children:me.label.length>12?me.label.slice(0,11)+"...":me.label})]},Oe)}),n.jsxs("text",{x:z-K,y:14,textAnchor:"end",fontSize:"11",fill:"rgba(0,0,0,0.55)",children:["Overall trend: ",k.length?(k[k.length-1].end>=0?"+":"")+de(k[k.length-1].end,2)+" /rd":""]})]})})]})},va=b=>{const g=A(b==null?void 0:b.holes,0);return g>=80?{label:"High",cls:"border-emerald-200 bg-emerald-50 text-emerald-800"}:g>=40?{label:"Medium",cls:"border-amber-200 bg-amber-50 text-amber-900"}:{label:"Low",cls:"border-neutral-200 bg-neutral-50 text-neutral-700"}};if((fn||[]).slice().sort((b,g)=>Math.abs(g.impactRd)-Math.abs(b.impactRd)),(fn||[]).slice().sort((b,g)=>b.impactRd-g.impactRd)[0],w){const b=(N==null?void 0:N.done)||0,g=(N==null?void 0:N.total)||0,j=g?Math.round(b/g*100):0;return n.jsxs("section",{className:"glass-card pm-scope p-4 md:p-6",children:[n.jsx("div",{className:"pm-accent-rail","aria-hidden":"true"}),n.jsx("div",{className:"flex items-center justify-between gap-3",children:n.jsx(Qs,{items:[{label:"How Well Am I Playing"}]})}),n.jsxs("div",{className:"mt-4 rounded-3xl border border-amber-200 bg-amber-50 p-4",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-black text-amber-900",children:"Loading Previous Games..."}),n.jsx("div",{className:"text-sm text-amber-900/80 mt-1",children:"Were loading your previous games and building same-course / same-tee comparisons to spot patterns. This can take a moment  especially the first time."})]}),n.jsxs("span",{className:"inline-flex items-center rounded-full bg-amber-100 px-3 py-1 text-xs font-bold text-amber-900 tabular-nums",children:[j,"%"]})]}),n.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-amber-100 overflow-hidden",children:n.jsx("div",{className:"h-full bg-amber-400",style:{width:`${j}%`}})}),n.jsxs("div",{className:"mt-2 text-xs text-amber-900/80 tabular-nums",children:["Progress: ",b,"/",g]})]})]})}if(f)return n.jsxs("section",{className:"glass-card p-4 md:p-6 hm-stage",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx(Qs,{items:[{label:"Overview"}]}),n.jsx(dl,{active:"progress",setView:v})]}),n.jsx("div",{className:"mt-4 rounded-2xl border border-rose-200 bg-rose-50 p-3 text-sm text-rose-800",children:f}),n.jsx("button",{className:"btn-primary mt-3",onClick:m,children:"Try again"})]});if(!e)return n.jsxs("section",{className:"glass-card p-4 md:p-6",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx(Qs,{items:[{label:"Overview"}]}),n.jsx(dl,{active:"progress",setView:v})]}),n.jsxs("div",{className:"mt-4 rounded-2xl border border-neutral-200 bg-white p-4",children:[n.jsx("div",{className:"font-black text-neutral-900",children:"Season analysis"}),n.jsx("div",{className:"text-sm text-neutral-600 mt-1",children:"Load all season CSVs and well build a proper player breakdown."}),n.jsx("button",{className:"btn-primary mt-3",onClick:m,children:"Run season analysis"})]})]});if(!L.length){const b=d&&String(d).toLowerCase()!=="all"?String(d):"this selection";return n.jsxs("section",{className:"glass-card p-4 md:p-6",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx(Qs,{items:[{label:"Overview"}]}),n.jsx(dl,{active:"progress",setView:v})]}),n.jsxs("div",{className:"mt-4 rounded-2xl border border-neutral-200 bg-white p-4",children:[n.jsx("div",{className:"font-black text-neutral-900",children:"No games yet"}),n.jsxs("div",{className:"text-sm text-neutral-600 mt-1",children:["There arent any games loaded for ",b,". Your League/Eclectic can still show standings (if youve added events), but Performance analysis needs at least one round."]}),n.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[n.jsx("button",{className:"btn-secondary",onClick:()=>x&&x("All"),children:"Show all years"}),n.jsx("button",{className:"btn-secondary",onClick:()=>v("home"),children:"Back to Home"}),n.jsx("button",{className:"btn-primary",onClick:m,children:"Re-scan season files"})]})]})]})}return O?n.jsxs("section",{className:"glass-card p-4 md:p-6",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx(Qs,{items:[{label:"Overview"}]}),n.jsx(dl,{active:"progress",setView:v})]}),n.jsx(Kw,{seasonModel:e,seasonPlayer:l,setSeasonPlayer:u,seasonYear:d,setSeasonYear:x,seasonLimit:h,setSeasonLimit:p,seasonYears:y,scoringMode:t,setScoringMode:r}),n.jsxs("div",{className:"mt-4 hm-stage",children:[n.jsxs("div",{className:"glass-card p-4 md:p-6",children:[n.jsxs("div",{className:"flex flex-col gap-4",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3",children:["  ",n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Performance Mirror"}),"  ",n.jsxs("div",{className:"flex items-center gap-2",children:["    ",n.jsx("button",{className:"btn-primary",onClick:()=>{try{const b=e,g=localStorage.getItem("dsl_lens")||"pointsField",j=window.__dslUiState&&window.__dslUiState.cohortMode?window.__dslUiState.cohortMode:null,_=j?j==="field"?"field":"band":window.__dslSeasonReportParams&&window.__dslSeasonReportParams.comparatorMode?window.__dslSeasonReportParams.comparatorMode:"band";window.__dslSeasonReportParams={model:e,playerName:l,yearLabel:d,seasonLimit:h,scoringMode:t,lensMode:g,comparatorMode:_};const S=eg({model:e,playerName:l,yearLabel:d,seasonLimit:h,scoringMode:t,lensMode:g,comparatorMode:_});if(!S||!S.ok){alert((S==null?void 0:S.error)||"Could not generate report.");return}Z0(S.htmlFragment||S.html)}catch(b){console.error(b),alert("Could not generate report.")}},title:"Open the season report",children:"Generate Report"}),"    ",n.jsx("button",{className:"btn-secondary",onClick:()=>{try{const b=document.getElementById("pp-problem-holes-details");b&&(b.open=!0);const g=document.getElementById("pp-problem-holes");g&&g.scrollIntoView&&g.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},title:"Jump to problem holes",children:"Problem Holes"}),"  "]})]}),n.jsxs("div",{className:"mt-1 break-words leading-tight",children:[n.jsx("span",{className:"text-4xl md:text-5xl font-black tracking-tight text-neutral-900",children:Ue}),q?n.jsx("span",{className:"ml-2 text-2xl md:text-3xl font-black tracking-tight text-neutral-800",children:q}):null]}),n.jsxs("div",{className:"mt-1 text-sm text-neutral-600",children:["Comparator:"," ",n.jsx("span",{className:"font-extrabold text-neutral-900",children:E==="band"?"Handicap band":"Field"}),n.jsx("span",{className:"mx-2 text-neutral-300",children:""}),"Mode:"," ",n.jsx("span",{className:"font-extrabold text-neutral-900",children:t==="gross"?"Gross":"Stableford"})]})]}),n.jsx("div",{id:"pp-problem-holes",className:"w-full",children:n.jsxs("details",{id:"pp-problem-holes-details",className:"rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm",children:[n.jsx("summary",{className:"cursor-pointer select-none",children:n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Problem holes"}),n.jsx("div",{className:"mt-1 text-lg md:text-xl font-black text-neutral-900",children:"Where you leak points on the same setup"}),n.jsx("div",{className:"mt-1 text-sm text-neutral-600",children:"Uses your most-played Course + Tee within the current window."})]}),n.jsx("div",{className:"text-xs font-black text-neutral-500 mt-1",children:""})]})}),n.jsx("div",{className:"mt-4",children:Re&&Re.ok?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-sm text-neutral-700",children:["Using: ",n.jsx("span",{className:"font-black text-neutral-900",children:Re.courseName||""}),Re.teeName?n.jsxs("span",{className:"text-neutral-600",children:["  ",Re.teeName]}):null,n.jsxs("span",{className:"text-neutral-500",children:["  ",Re.rounds||0," rounds"]})]}),n.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:(Re.flagged&&Re.flagged.length?Re.flagged:Re.rows||[]).slice(0,6).map(b=>n.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-black "+(Number(b.vsOverall)<=-.5?"border-rose-200 bg-rose-50 text-rose-700":"border-neutral-200 bg-neutral-50 text-neutral-700"),children:["Hole ",b.hole,": ",de(b.avg,2)," pts"]},"phchip"+b.hole))}),n.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-neutral-200",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-neutral-50",children:n.jsxs("tr",{className:"text-left",children:[n.jsx("th",{className:"px-4 py-3 font-black text-neutral-600",children:"HOLE"}),n.jsx("th",{className:"px-4 py-3 font-black text-neutral-600",children:"AVG PTS"}),n.jsx("th",{className:"px-4 py-3 font-black text-neutral-600",children:"VS YOUR OVERALL"}),n.jsx("th",{className:"px-4 py-3 font-black text-neutral-600",children:"SAMPLES"})]})}),n.jsx("tbody",{children:(Re.rows||[]).slice(0,10).map(b=>n.jsxs("tr",{className:"border-t border-neutral-200",children:[n.jsx("td",{className:"px-4 py-3 font-black text-neutral-900",children:b.hole}),n.jsx("td",{className:"px-4 py-3 text-neutral-900",children:de(b.avg,2)}),n.jsx("td",{className:"px-4 py-3 font-black "+(Number(b.vsOverall)<=-.5?"text-rose-700":"text-neutral-700"),children:Number.isFinite(Number(b.vsOverall))?(b.vsOverall>=0?"+":"")+de(b.vsOverall,2):""}),n.jsx("td",{className:"px-4 py-3 text-neutral-700",children:b.n||""})]},"phr"+b.hole))})]})})]}):n.jsx("div",{className:"text-sm text-neutral-700",children:"Not enough repeated rounds on the same Course + Tee in the current window to identify problem holes."})})]})}),n.jsx("div",{className:"w-full",children:n.jsx("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-3",children:n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500 mb-1",children:"PLAYER"}),n.jsxs("div",{className:"select-wrap",children:[n.jsx("select",{className:"select-premium",value:l,onChange:b=>u(b.target.value),children:(L||[]).map(b=>n.jsx("option",{value:b.name,children:b.name},b.name))}),n.jsx("svg",{className:"select-chevron",viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",children:n.jsx("path",{d:"M6 8l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500 mb-1",children:"YEAR"}),n.jsxs("div",{className:"select-wrap",children:[n.jsxs("select",{className:"select-premium",value:d,onChange:b=>x(b.target.value),children:[n.jsx("option",{value:"All",children:"All"}),["All"].concat(y||[]).map(b=>n.jsx("option",{value:b,children:b},b))]}),n.jsx("svg",{className:"select-chevron",viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",children:n.jsx("path",{d:"M6 8l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500 mb-1",children:"MOST RECENT GAMES"}),n.jsxs("div",{className:"select-wrap",children:[n.jsxs("select",{className:"select-premium",value:h,onChange:b=>p(b.target.value),children:[n.jsx("option",{value:"All",children:"All"}),["1","5","10","15","20","30"].map(b=>n.jsx("option",{value:b,children:b},b))]}),n.jsx("svg",{className:"select-chevron",viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",children:n.jsx("path",{d:"M6 8l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500 mb-1",children:"VIEW MODE"}),n.jsxs("div",{className:"select-wrap",children:[n.jsx("span",{className:"select-dot",style:ce,"aria-hidden":"true"}),n.jsx("select",{className:"select-premium",style:{paddingLeft:"2.25rem"},value:Ze,onChange:b=>{const g=b.target.value,j=Ke.find(_=>_.key===g)||Ke[0];De(j.pp),C(j.cohort)},"aria-label":"Leaderboard view mode",children:Ke.map(b=>n.jsx("option",{value:b.key,children:b.label},b.key))}),n.jsx("svg",{className:"select-chevron",viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",children:n.jsx("path",{d:"M6 8l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),n.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:(He==null?void 0:He.hint)||""})]})]})})})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-1 xl:grid-cols-2 gap-3",children:[n.jsx("div",{className:"flex flex-wrap items-center gap-2"}),n.jsx("div",{className:"flex flex-wrap items-center gap-2 xl:justify-end",children:n.jsxs("div",{className:"mode-context-row",children:[n.jsx("div",{className:"mode-context-text",children:J==="pointsField"&&E==="field"?n.jsxs(n.Fragment,{children:["Stableford points compared to the field average. ",n.jsx("b",{children:"Higher is better."})]}):J==="pointsField"&&E==="band"?n.jsxs(n.Fragment,{children:["Stableford points compared to golfers in the same handicap band. ",n.jsx("b",{children:"Higher is better."})]}):J==="strokesField"&&E==="field"?n.jsxs(n.Fragment,{children:["Gross score compared to the field average. ",n.jsx("b",{children:"Lower is better."})]}):J==="strokesField"&&E==="band"?n.jsxs(n.Fragment,{children:["Gross score compared to golfers in the same handicap band. ",n.jsx("b",{children:"Lower is better."})]}):n.jsxs(n.Fragment,{children:["Gross score relative to par (absolute). ",n.jsx("b",{children:"Lower is better."})]})}),n.jsx("div",{className:"text-xs font-semibold text-neutral-400 px-2",children:J==="strokesPar"?n.jsx(n.Fragment,{children:"Comparator: Par"}):n.jsxs(n.Fragment,{children:["Comparator: ",E==="band"?"Handicap band":"Field"]})})]})})]})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4 pro-overview-grid pro-overview-stage",children:[n.jsxs("div",{className:"rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm lg:col-span-1 report-handicap-preview",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Report handicap preview"}),n.jsx("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:n.jsxs("div",{className:"toggle-group",role:"tablist","aria-label":"Handicap preview mode",children:[n.jsx("button",{className:"toggle-btn "+(o==="den"?"active":""),onClick:()=>c("den"),role:"tab","aria-selected":o==="den",children:"Legacy"}),n.jsx("button",{className:"toggle-btn "+(o==="whs"?"active":""),onClick:()=>c("whs"),role:"tab","aria-selected":o==="whs",children:"WHS"}),n.jsx("button",{className:"toggle-btn "+(o==="same"?"active":""),onClick:()=>c("same"),role:"tab","aria-selected":o==="same",children:"No change"})]})}),n.jsxs("div",{className:"mt-4",children:[n.jsx("div",{className:"text-3xl font-black text-neutral-900 tabular-nums",children:Number.isFinite(Ao)?cs(Ao,1):""}),n.jsxs("div",{className:"text-sm text-neutral-600 mt-1",children:["Calculated Hcap ",n.jsx("span",{className:"text-neutral-400",children:"vs"})," Card ",Number.isFinite(Gs)?cs(Gs,1):""]}),n.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:["Avg handicap ",n.jsx("span",{className:"font-semibold text-neutral-700",children:Number.isFinite(pi)?cs(pi,1):""})]}),n.jsxs("details",{className:"mt-3 rounded-2xl border border-neutral-200 bg-neutral-50/60 px-3 py-2",children:[n.jsxs("summary",{className:"no-marker flex cursor-pointer select-none items-center gap-2 text-xs font-semibold text-neutral-700","aria-label":"How to read this",title:"How to read this",children:[n.jsx("span",{"aria-hidden":"true",className:"text-base",children:""}),n.jsx("span",{className:"sr-only",children:"How to read this"})]}),n.jsxs("div",{className:"mt-2 text-xs text-neutral-500 space-y-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold text-neutral-700",children:"What this is showing:"})," ","a preview of the handicap number this report would use"," ",n.jsx("span",{className:"font-semibold text-neutral-700",children:"if you updated it from the rounds you selected"}),". It's an explanation layer only  all scoring and Insights maths stay exactly the same."]}),o==="den"&&n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold text-neutral-700",children:"League handicap"})," ","is a society system designed so more members have a fair shot at winning. This preview uses your ",n.jsx("span",{className:"font-semibold text-neutral-700",children:"latest selected round"})," ","and your ",n.jsx("span",{className:"font-semibold text-neutral-700",children:"Stableford points"}),": score ",n.jsx("span",{className:"font-semibold text-neutral-700",children:"35+ points"})," and your handicap tightens; score ",n.jsx("span",{className:"font-semibold text-neutral-700",children:"31 or fewer"})," and it loosens. The size of the change depends on your current handicap band, and winners get an extra small cut. The result is kept within sensible bounds (and capped for playing handicap: 28 for men, 36 for women)."]}),o==="whs"&&n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold text-neutral-700",children:"WHS handicap index"})," ","is the standard system based on ",n.jsx("span",{className:"font-semibold text-neutral-700",children:"score differentials"}),". In this file, each selected round is turned into a differential by: (1) taking your hole-by-hole gross scores, (2) applying the WHS per-hole cap (net double bogey) to get an adjusted gross score, then (3) converting that to a differential using"," ",n.jsx("span",{className:"font-semibold text-neutral-700",children:"(Adjusted Gross  Course Rating)  113  Slope"})," ","(PCC assumed 0 here). Your next WHS index is then the average of the lowest differentials from your most recent up to 20 rounds (with the standard fewer than 20 scores rules), rounded to 1 decimal. This needs slope/rating + pars/SI + hole scores to be present."]}),o==="same"&&n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold text-neutral-700",children:"No change"})," ","means: use the handicap already on the player record / card, with no recalculation from the selected rounds."]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold text-neutral-700",children:"Card"})," ","is the handicap number recorded for the round (the one used to compute your points on the day).",n.jsx("span",{className:"font-semibold text-neutral-700",children:" Avg handicap"})," ","is simply the average of the handicap values across the rounds you've selected."]})]})]})]})]}),n.jsx("div",{className:"rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm lg:col-span-2",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-4",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-500",children:"Rounds analysed"}),n.jsx("div",{className:"mt-2 text-2xl font-black text-neutral-900 tabular-nums",children:ns||0}),n.jsx("div",{className:"mt-2 text-sm text-neutral-600",children:"Avg Points / Avg Strokes"}),n.jsxs("div",{className:"text-lg font-extrabold text-neutral-900 tabular-nums",children:[Number.isFinite(cr)?`${cs(cr,1)} pts`:""," ",n.jsx("span",{className:"text-neutral-300",children:"/"})," ",Number.isFinite(Wr)?`${cs(Wr,1)} str`:""]})]}),n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-4",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-500",children:"Performance & Rank"}),n.jsxs("div",{className:"mt-2",children:[n.jsx("div",{className:"text-sm text-neutral-600",children:"Stableford Rank"}),n.jsxs("div",{className:"text-lg font-extrabold text-neutral-900 tabular-nums",children:[Number.isFinite(nr==null?void 0:nr.pos)&&(nr!=null&&nr.total)?`${nr.pos} of ${nr.total}`:"",n.jsxs("span",{className:"ml-2 "+Bn(nr==null?void 0:nr.delta,!0,.2),children:["(",Ir(nr==null?void 0:nr.delta,1)," pts vs field)"]})]}),n.jsxs("div",{className:"text-xs text-neutral-500 mt-1",children:["Percentile (",String(h||"").toLowerCase()==="all"?"all selected rounds":`last ${h} rounds`," avg): ",Number.isFinite(Ro)?oe(Ro,0):""]})]}),n.jsxs("div",{className:"mt-2",children:[n.jsx("div",{className:"text-sm text-neutral-600",children:"Gross Rank"}),n.jsxs("div",{className:"text-lg font-extrabold text-neutral-900 tabular-nums",children:[Number.isFinite(ur==null?void 0:ur.pos)&&(ur!=null&&ur.total)?`${ur.pos} of ${ur.total}`:"",n.jsxs("span",{className:"ml-2 "+Bn(ur==null?void 0:ur.delta,!1,.5),children:["(",Ir(ur==null?void 0:ur.delta,1,!0)," str vs field)"]})]})]})]}),n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-4",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-500",children:"Whats happening"}),n.jsx("div",{className:"mt-2 text-sm text-neutral-600",children:"Improving or worse?"}),n.jsx("div",{className:"text-lg font-extrabold "+(sr==="Getting better"?"text-emerald-700":sr==="Getting worse"?"text-rose-700":"text-neutral-900"),children:sr}),n.jsx("div",{className:"mt-3 text-sm text-neutral-600",children:"Consistency"}),n.jsxs("div",{className:"text-lg font-extrabold text-neutral-900",children:[Ln," ",n.jsxs("span",{className:"text-sm font-bold text-neutral-500",children:[" ( ",Number.isFinite(Is)?cs(Is,1):""," vs ",Number.isFinite(lt)?cs(lt,1):"",")"]})]}),n.jsx("div",{className:"mt-3 text-sm text-neutral-600",children:"Better early or late"}),n.jsx("div",{className:"text-sm font-extrabold text-neutral-900",children:ma})]})]})})]}),n.jsxs("div",{className:"rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Par leaders"}),n.jsx("span",{className:"inline-flex items-center gap-1 rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-[11px] font-black text-amber-700",children:" Leaders"})]}),n.jsx("div",{className:"text-lg font-extrabold text-neutral-900",children:"Who dominates Par 3s, Par 4s, and Par 5s"}),n.jsx("div",{className:"text-sm text-neutral-600 mt-1",children:F==="gross"?"Gross mode: fewer strokes on each hole type = better scoring.":"Stableford mode: more points on each hole type = better scoring."}),H?n.jsxs("div",{className:"mt-3 rounded-2xl border border-neutral-200 bg-neutral-50 p-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Quick podium"}),n.jsx("div",{className:"text-[11px] font-black text-neutral-500",children:F==="gross"?"lower wins":"higher wins"})]}),n.jsx("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm",children:[{k:"all",label:"All holes",ico:"",desc:"Best overall scoring across the course"},{k:"p3",label:"Par 3",ico:"",desc:"Short holes  accuracy & distance control"},{k:"p4",label:"Par 4",ico:"",desc:"The backbone  tee shot + approach quality"},{k:"p5",label:"Par 5",ico:"",desc:"Scoring chances  smart aggression pays"}].map(b=>{const g=et!=null&&et[b.k]&&et[b.k][0]?et[b.k][0]:null,j=g?g.v:NaN,_=F==="gross"?"sop/ho":"pts/ho";return n.jsx("div",{className:"rounded-2xl border border-neutral-200 bg-white p-3",children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg leading-none",children:b.ico}),n.jsx("div",{className:"font-extrabold text-neutral-900 truncate",children:b.label})]}),n.jsx("div",{className:"text-xs text-neutral-500 mt-0.5",children:b.desc})]}),n.jsx("div",{className:"text-right",children:g?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-[11px] font-black text-neutral-500 uppercase tracking-wide",children:"Leader"}),n.jsx("div",{className:"font-black text-neutral-900",children:g.name}),n.jsx("div",{className:"text-xs text-neutral-500 tabular-nums",children:Number.isFinite(j)?`${Bw(j,2)} ${_}`:""})]}):n.jsx("div",{className:"text-xs text-neutral-500",children:"No data"})})]})},b.k)})}),n.jsxs("div",{className:"mt-2 text-xs text-neutral-500",children:["Tap ",n.jsx("b",{children:"View leaders"})," to see full boards and sample sizes."]})]}):null]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsx("button",{className:"chip special "+(H?"ring-2 ring-emerald-200 shadow-sm":""),onClick:()=>Ne(b=>!b),children:H?"View leaders ":"Hide leaders "}),n.jsx("button",{className:"px-3 py-1.5 rounded-xl text-sm font-extrabold border "+(F==="stableford"?"bg-neutral-900 text-white border-neutral-900":"bg-white text-neutral-700 border-neutral-200"),onClick:()=>G("stableford"),children:"Stableford"}),n.jsx("button",{className:"px-3 py-1.5 rounded-xl text-sm font-extrabold border "+(F==="gross"?"bg-neutral-900 text-white border-neutral-900":"bg-white text-neutral-700 border-neutral-200"),onClick:()=>G("gross"),children:"Gross"})]})]}),!H&&n.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-4 gap-3",children:[{key:"all",title:"All holes",ico:""},{key:"p3",title:"Par 3",ico:""},{key:"p4",title:"Par 4",ico:""},{key:"p5",title:"Par 5",ico:""}].map(b=>n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-3",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"text-sm font-extrabold text-neutral-900",children:[n.jsx("span",{className:"mr-1",children:b.ico}),b.title]}),n.jsx("div",{className:"text-[11px] font-black text-neutral-500 uppercase tracking-wide",children:F==="gross"?"lower wins":"higher wins"})]}),n.jsxs("div",{className:"mt-2 space-y-1",children:[(et[b.key]||[]).map((g,j)=>{const _=j===0?"":j===1?"":j===2?"":`${j+1}.`;return n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsxs("div",{className:"min-w-0 flex items-center gap-2",children:[n.jsx("span",{className:"text-neutral-500 tabular-nums font-black w-7 text-center",children:_}),n.jsx("span",{className:"font-semibold text-neutral-900 truncate",children:g.name})]}),n.jsxs("div",{className:"flex items-baseline justify-end gap-2",children:[n.jsx("span",{className:"font-black tabular-nums text-neutral-900",children:cs(g.v,2)}),Number.isFinite(g.holes)&&n.jsxs("span",{className:"text-[10px] font-black tabular-nums text-neutral-400",children:["n=",Math.round(g.holes)]})]})]},g.name)}),(!et[b.key]||et[b.key].length===0)&&n.jsx("div",{className:"text-sm text-neutral-500",children:"No data yet."})]})]},b.key))})]}),n.jsxs("div",{className:"mt-6 rounded-3xl border border-neutral-200 bg-white p-4 md:p-5 shadow-sm","data-reveal":!0,children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 mb-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-[11px] uppercase tracking-widest font-black text-neutral-500",children:"Trend over time"}),n.jsx("div",{className:"text-sm text-neutral-700 mt-1",children:J==="pointsField"?"Stableford points per round  compared to the field average. Higher is better.":J==="strokesField"?"Score per round  compared to the field average. Lower is better.":"Strokes over par per round  no field comparison. Lower is better."})]}),n.jsx("div",{className:"flex items-center gap-3",children:n.jsx(lN,{value:h,onChange:b=>p(String(b)),options:[{label:"1",value:"1"},{label:"5",value:"5"},{label:"10",value:"10"},{label:"20",value:"20"},{label:"30",value:"30"},{label:"All",value:"All"}]})})]}),n.jsxs("div",{className:"text-neutral-900",children:[n.jsx(cN,{a:Fs,b:nt==="par"?hi:dn,labels:un}),n.jsx("div",{className:"mt-2 text-xs text-neutral-500",children:nt==="par"?t==="gross"?"Vs Par: 0 = level par (negative is under par).":"Vs Par: 36 points is par for 18 holes (2 pts/hole).":t==="gross"?"Gross line uses strokes-over-par per round (lower is better).":"Stableford line uses total points per round (higher is better)."})]})]}),n.jsx("div",{className:"mt-6 rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm","data-reveal":!0,children:n.jsx("div",{className:"flex flex-col lg:flex-row lg:items-start justify-between gap-4",children:n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Player progress"}),n.jsx("div",{className:"mt-1 text-2xl md:text-3xl font-black tracking-tight text-neutral-900",children:Number.isFinite(qr)?qr>=0?`Ahead of ${Z.label} by +${de(qr,1)}${t==="gross"?" strokes/rd":" pts/rd"}`:`Behind ${Z.label} by ${de(Math.abs(qr),1)}${t==="gross"?" strokes/rd":" pts/rd"}`:""}),n.jsxs("div",{className:"mt-1 text-sm text-neutral-600",children:["A quick read of ",n.jsx("b",{children:"where your score is coming from"}),": one place you consistently outperform the comparison (",n.jsx("b",{children:"Best edge"}),") and one place that consistently costs you the most (",n.jsx("b",{children:"Biggest leak"}),")."]}),n.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[(()=>{const b=(ir==null?void 0:ir[0])||null,g=(as==null?void 0:as[0])||null,j=va(b),_=va(g);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-4",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-anchored text-neutral-500",children:"Best edge"}),n.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-[11px] font-black text-emerald-700",children:[" Gain vs ",Z.label]})]}),n.jsx("div",{className:"mt-1 text-xs text-neutral-500",children:"The bucket where you help your score the most compared to the field (your strongest advantage)."}),n.jsx("div",{className:"mt-2 text-lg font-black text-neutral-900 truncate",children:b?b.label:""}),n.jsx("div",{className:"mt-1 text-sm text-neutral-700",children:b&&Number.isFinite(b.impactRd)?t==="gross"?n.jsxs(n.Fragment,{children:["About ",n.jsx("b",{children:de(Math.abs(b.impactRd),1)})," ",n.jsx("b",{children:"shots saved"})," per round vs ",Z.label,"."]}):n.jsxs(n.Fragment,{children:["About ",n.jsx("b",{children:de(Math.abs(b.impactRd),1)})," ",n.jsx("b",{children:"points gained"})," per round vs ",Z.label,"."]}):""}),n.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[n.jsxs("span",{className:`chip ${j.cls}`,children:["Confidence: ",j.label]}),n.jsx("span",{className:"chip",children:"Per round"}),n.jsx("span",{className:"chip",children:"Vs field"})]}),n.jsxs("div",{className:"mt-1 text-[11px] text-neutral-500",children:[n.jsx("b",{children:"High"})," = lots of holes/rounds and a stable pattern. ",n.jsx("b",{children:"Low"})," = limited evidence (treat as a hint)."]})]}),n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-4",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Biggest leak"}),n.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-rose-200 bg-rose-50 px-2 py-0.5 text-[11px] font-black text-rose-700",children:[" Cost vs ",Z.label]})]}),n.jsx("div",{className:"mt-1 text-xs text-neutral-500",children:"The bucket that hurts your scoring the most compared to the field (where big numbers tend to come from)."}),n.jsx("div",{className:"mt-2 text-lg font-black text-neutral-900 truncate",children:g?g.label:""}),n.jsx("div",{className:"mt-1 text-sm text-neutral-700",children:g&&Number.isFinite(g.impactRd)?t==="gross"?n.jsxs(n.Fragment,{children:["About ",n.jsx("b",{children:de(Math.abs(g.impactRd),1)})," ",n.jsx("b",{children:"extra shots"})," per round vs ",Z.label,"."]}):n.jsxs(n.Fragment,{children:["About ",n.jsx("b",{children:de(Math.abs(g.impactRd),1)})," ",n.jsx("b",{children:"points lost"})," per round vs ",Z.label,"."]}):""}),n.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[n.jsxs("span",{className:`chip ${_.cls}`,children:["Confidence: ",_.label]}),n.jsx("span",{className:"chip",children:"Per round"}),n.jsx("span",{className:"chip",children:"Vs field"})]}),n.jsxs("div",{className:"mt-1 text-[11px] text-neutral-500",children:[n.jsx("b",{children:"High"})," = shows up repeatedly. ",n.jsx("b",{children:"Medium"})," = pretty consistent. ",n.jsx("b",{children:"Low"})," = could be noise  needs more rounds."]})]})]})})(),n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-neutral-50 p-4",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Wipe / Double+ rate"}),n.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-neutral-900 px-2 py-0.5 text-[11px] font-black text-white",children:" Card protection"})]}),(()=>{const b=Number(Xe==null?void 0:Xe.holes),g=Number(Xe==null?void 0:Xe.badRate),j=Number(Xe==null?void 0:Xe.bogeyRate),_=Number(Xe==null?void 0:Xe.parRate),S=Number(Xe==null?void 0:Xe.birdiePlusRate),P=Number(Nt==null?void 0:Nt.badRate),k=Number(Nt==null?void 0:Nt.bogeyRate),I=Number(Nt==null?void 0:Nt.parRate),z=Number(Nt==null?void 0:Nt.birdiePlusRate),V=Number.isFinite(g)?g*18:NaN,K=Number.isFinite(P)?P*18:NaN;return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mt-2 flex items-baseline justify-between",children:[n.jsx("div",{className:"text-2xl font-black text-neutral-900",children:xe(g)}),n.jsx("div",{className:"text-sm font-black text-neutral-700",children:Number.isFinite(V)?de(V,1)+" per 18":""})]}),n.jsxs("div",{className:"mt-1 text-[11px] text-neutral-600",children:["Field: ",xe(P),"  ",Number.isFinite(K)?de(K,1)+" /18":""]}),n.jsxs("div",{className:"mt-2 text-xs text-neutral-600",children:["Goal: ",n.jsx("b",{children:"0.2 per 18"})," (",n.jsx("b",{children:"1%"}),") over the next ",n.jsx("b",{children:"5 rounds"}),"  basically remove one disaster hole."]}),n.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"rounded-lg bg-white border border-neutral-200 p-2",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Bogey rate"}),n.jsxs("div",{className:"mt-0.5 flex items-baseline justify-between",children:[n.jsx("div",{className:"text-sm font-black",children:xe(j)}),n.jsxs("div",{className:"text-[11px] text-neutral-600",children:["Field: ",xe(k)]})]})]}),n.jsxs("div",{className:"rounded-lg bg-white border border-neutral-200 p-2",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Par rate"}),n.jsxs("div",{className:"mt-0.5 flex items-baseline justify-between",children:[n.jsx("div",{className:"text-sm font-black",children:xe(_)}),n.jsxs("div",{className:"text-[11px] text-neutral-600",children:["Field: ",xe(I)]})]})]}),n.jsxs("div",{className:"rounded-lg bg-white border border-neutral-200 p-2",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Birdie+ rate"}),n.jsxs("div",{className:"mt-0.5 flex items-baseline justify-between",children:[n.jsx("div",{className:"text-sm font-black",children:xe(S)}),n.jsxs("div",{className:"text-[11px] text-neutral-600",children:["Field: ",xe(z)]})]})]}),n.jsxs("div",{className:"rounded-lg bg-white border border-neutral-200 p-2",children:[n.jsx("div",{className:"text-[10px] font-black tracking-widest uppercase text-neutral-500",children:"Rounds analysed"}),n.jsx("div",{className:"mt-0.5 text-sm font-black",children:b?cs(b/18,1):""}),n.jsx("div",{className:"text-[11px] text-neutral-600",children:"same window"})]})]}),n.jsx("div",{className:"mt-2 text-xs text-neutral-600",children:"This isnt about chasing birdies  its about protecting the card. Cut one wipe/double+ and your scoring moves immediately."})]})})()]})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-1 lg:grid-cols-2 gap-3",children:[n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-white p-4",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Top gains"}),n.jsxs("div",{className:"mt-1 text-xs text-neutral-500",children:["Your best contributors ",n.jsx("b",{children:"per round"})," vs the field. (Stableford = points gained, Score = shots saved.)"]}),n.jsx("div",{className:"mt-2 space-y-2",children:(ir!=null&&ir.length?ir.slice(0,5):[null]).map((b,g)=>n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx("div",{className:"min-w-0 text-sm font-semibold text-neutral-800 truncate",children:b?b.label:""}),n.jsx("div",{className:"text-sm tabular-nums font-black "+(b&&Number.isFinite(b.impactRd)&&b.impactRd<0?"text-rose-600":"text-emerald-700"),children:b&&Number.isFinite(b.impactRd)?`${pm(b.impactRd,1)}/rd`:""})]},g))})]}),n.jsxs("div",{className:"rounded-2xl border border-neutral-200 bg-white p-4",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Top leaks"}),n.jsxs("div",{className:"mt-1 text-xs text-neutral-500",children:["Your biggest costs ",n.jsx("b",{children:"per round"})," vs the field. (Stableford = points lost, Score = extra shots.)"]}),n.jsx("div",{className:"mt-2 space-y-2",children:(as!=null&&as.length?as.slice(0,5):[null]).map((b,g)=>n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx("div",{className:"min-w-0 text-sm font-semibold text-neutral-800 truncate",children:b?b.label:""}),n.jsx("div",{className:"text-sm tabular-nums font-black "+(b&&Number.isFinite(b.impactRd)&&b.impactRd>0?"text-emerald-700":"text-rose-700"),children:b&&Number.isFinite(b.impactRd)?`${pm(b.impactRd,1)}/rd`:""})]},g))})]})]}),n.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[n.jsx("button",{className:`chip hover:opacity-90 ${Y==="all"?"bg-neutral-900 text-white border-neutral-900":""}`,onClick:()=>{le("all"),R(8)},children:"All"}),n.jsx("button",{className:`chip hover:opacity-90 ${Y==="par"?"bg-neutral-900 text-white border-neutral-900":""}`,onClick:()=>{le("par"),R(8)},children:"Par"}),n.jsx("button",{className:`chip hover:opacity-90 ${Y==="si"?"bg-neutral-900 text-white border-neutral-900":""}`,onClick:()=>{le("si"),R(8)},children:"SI"}),n.jsx("button",{className:`chip hover:opacity-90 ${Y==="yd"?"bg-neutral-900 text-white border-neutral-900":""}`,onClick:()=>{le("yd"),R(8)},children:"Yardage"}),n.jsx("div",{className:"ml-auto flex items-center gap-2",children:n.jsxs("span",{className:"text-xs text-neutral-500",children:["Sorted by how many ",n.jsx("b",{children:t==="gross"?"shots":"points"})," you ",n.jsx("b",{children:"gain or lose per round"})," vs ",J==="strokesPar"?"par":Z.label,"."]})})]}),(()=>{const g=((Y==="par"?Io:Y==="si"?ya:Y==="yd"?bi:fn)||[]).slice().sort((_,S)=>Math.abs(S.impactRd)-Math.abs(_.impactRd)),j=g.slice(0,$);return n.jsxs("div",{className:"mt-3",children:[n.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:(j.length?j:[{label:"",impactRd:NaN,holes:0,mePH:NaN,fldPH:NaN,dGood:NaN}]).map((_,S)=>n.jsx("div",{className:"rounded-2xl border border-neutral-100 bg-white/70 p-2",children:n.jsx(Nc,{row:_})},S))}),n.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[n.jsxs("div",{className:"text-xs text-neutral-500",children:["Showing ",Math.min($,g.length||0)," of ",g.length||0," buckets."]}),g.length>$?n.jsx("button",{className:"chip hover:opacity-90",onClick:()=>R(_=>_+6),children:"Show more"}):g.length>8?n.jsx("button",{className:"chip hover:opacity-90",onClick:()=>R(8),children:"Show less"}):null]}),n.jsx("div",{className:"mt-4",children:n.jsx($o,{rows:g,title:"Momentum snapshot"})})]})})()]})})})]})]}):n.jsx("div",{className:"p-6 text-sm text-neutral-500",children:"Select a player."})}function tc({scoringMode:e,windowSeries:t}){const r=String(e)==="gross",s=(t||[]).slice();let i=0,a=0,o=0,c=0,l=0;for(const d of s){const x=Array.isArray(d==null?void 0:d.perHole)?d.perHole:null,h=Array.isArray(d==null?void 0:d.grossPerHole)?d.grossPerHole:null,p=Array.isArray(d==null?void 0:d.parsArr)?d.parsArr:Array.isArray(d==null?void 0:d.parsPerHole)?d.parsPerHole:Array.isArray(d==null?void 0:d.pars)?d.pars:null;for(let y=0;y<18;y++)if(r){const w=Number(h==null?void 0:h[y]),N=Number(p==null?void 0:p[y]);if(!Number.isFinite(w)||!Number.isFinite(N))continue;i++;const f=w-N;f<=-1?a++:f===0?o++:f===1?c++:l++}else{const w=Number(x==null?void 0:x[y]);if(!Number.isFinite(w))continue;i++,w>=3?a++:w===2?o++:w===1?c++:l++}}const u=d=>i?d/i:NaN;return{holes:i,birdiePlusRate:u(a),parRate:u(o),bogeyRate:u(c),badRate:u(l)}}function dN(e,t){const r=Array.isArray(e)?e.slice():e&&typeof e=="object"?{...e}:{};return!t||typeof t!="object"||Object.keys(t).forEach(s=>{const i=Number(r[s]),a=Number(t[s]);Number.isFinite(a)&&(r[s]=(Number.isFinite(i)?i:0)+a)}),r}function hm(e,t,r){const s=typeof r=="function"?r():{};return(e||[]).forEach(i=>{const a=i==null?void 0:i[t];!a||typeof a!="object"||Object.keys(a).forEach(o=>{const c=Number(a[o]);if(!Number.isFinite(c))return;const l=Number(s[o]);s[o]=(Number.isFinite(l)?l:0)+c})}),s}function Ci(e,t,r){const s={};return(e||[]).forEach(i=>{const a=(i==null?void 0:i[t])||{};Object.keys(a).forEach(o=>{const c=a[o];!c||typeof c!="object"||(s[o]||(s[o]=typeof r=="function"?r():{}),s[o]=dN(s[o],c))})}),s}function hN(e){try{return String(e||"").toLowerCase().trim().replace(/['"]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/(^-|-$)/g,"").slice(0,80)||"report"}catch{return"report"}}function Ms(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function lu(e,t,r){const s=String(t)==="gross",i=y=>Number.isFinite(y)?y.toFixed(2):"",a=y=>Number.isFinite(y)?String(Math.round(y)):"";if(String(r)==="par"){const y=(e||[]).map(m=>{const v=Ms((m==null?void 0:m.label)??(m==null?void 0:m.key)??""),E=Number.isFinite(m==null?void 0:m.holes)?Math.round(m.holes):NaN,C=Number.isFinite(m==null?void 0:m.me)?m.me:Number.isFinite(m==null?void 0:m.playerAvg)?m.playerAvg:NaN;return{label:v,holes:E,me:C}}),w=m=>Number.isFinite(m)?m<=.75?"PRgood":m<=1.25?"PRneutral":"PRbad":"PRneutral",N=m=>Number.isFinite(m)?m.toFixed(2):"",f=m=>Number.isFinite(m)?String(m):"";return`
    <div class="PRtableWrap">
      <div class="PRlegend">
        <span class="PRpill PRgoodPill">Good (closer to par)</span>
        <span class="PRpill PRbadPill">Leak (far from par)</span>
        <span class="PRpill PRneutralPill">Neutral</span>
        <span class="PRmuted" style="margin-left:8px;">Values shown are your <b>avg strokes over par per hole</b> in each bucket.</span>
      </div>
      <table class="PRtable">
        <thead>
          <tr>
            <th class="left">Bucket</th>
            <th>Holes</th>
            <th>You (avg over par)</th>
          </tr>
        </thead>
        <tbody>
          ${y.map(m=>`
              <tr class="PRrow ${w(m.me)}">
                <td class="left"><span class="PRbucket">${m.label}</span></td>
                <td>${f(m.holes)}</td>
                <td><b>${N(m.me)}</b></td>
              </tr>
            `).join("")}
        </tbody>
      </table>
    </div>
  `}const c=y=>{const w=Number.isFinite(y==null?void 0:y.me)?y.me:Number.isFinite(y==null?void 0:y.playerAvg)?y.playerAvg:NaN,N=Number.isFinite(y==null?void 0:y.peer)?y.peer:Number.isFinite(y==null?void 0:y.fieldAvg)?y.fieldAvg:NaN;return!Number.isFinite(w)||!Number.isFinite(N)?NaN:s?N-w:w-N},l=y=>Number.isFinite(y==null?void 0:y.me)?y.me:y==null?void 0:y.playerAvg,u=y=>Number.isFinite(y==null?void 0:y.peer)?y.peer:y==null?void 0:y.fieldAvg,d=y=>Number.isFinite(y)?(y>=0?"+":"")+y.toFixed(Math.abs(y)<.01&&y!==0?3:2):"",x=y=>Number.isFinite(y)?y>5e-4?"good":y<-5e-4?"bad":"neu":"neu",h=y=>Number.isFinite(y)?y>5e-4?"":y<-5e-4?"":"":"";return`
    <div class="PRlegend">
      <span class="PRlegItem good"><span class="PRlegDot"></span>Good (gain)</span>
      <span class="PRlegItem bad"><span class="PRlegDot"></span>Bad (leak)</span>
      <span class="PRlegItem neu"><span class="PRlegDot"></span>Neutral</span>
      <span class="PRlegNote">Delta is always oriented so <b>positive = better</b> (gross: fewer strokes; stableford: more points).</span>
    </div>

    <table class="PRtbl">
      <colgroup><col class="c1"/><col class="c2"/><col class="c3"/><col class="c4"/><col class="c5"/></colgroup>
      <thead>
        <tr>
          <th>Bucket</th><th>Holes</th><th>You (avg)</th><th>Peer (avg)</th><th>Delta</th>
        </tr>
      </thead>
      <tbody>
        ${(e||[]).map(y=>{const w=Number.isFinite(y==null?void 0:y.delta)?Number(y.delta):c(y),N=x(w),f=Ms((y==null?void 0:y.label)??(y==null?void 0:y.key)??""),m=a(y==null?void 0:y.holes),v=i(l(y)),E=i(u(y)),C=d(w),T=h(w);return`
            <tr class="PRrow ${N}">
              <td class="left"><span class="PRbucket">${f}</span></td>
              <td>${m}</td>
              <td>${v}</td>
              <td>${E}</td>
              <td class="PRdelta">
                <span class="PRdeltaBadge ${N}"><span class="PRarr">${T}</span>${C}</span>
              </td>
            </tr>
          `}).join("")}
      </tbody>
    </table>
  `}function Z0(e){try{let t=document.getElementById("PR_seasonReportOverlay");t||(t=document.createElement("div"),t.id="PR_seasonReportOverlay",t.style.position="fixed",t.style.inset="0",t.style.zIndex="999999",t.style.background="rgba(2,6,23,.65)",t.style.display="none",t.innerHTML=`
        <div id="PR_seasonReportPanel" style="position:absolute; inset:18px; background:#fff; border-radius:14px; overflow:auto; box-shadow:0 20px 60px rgba(0,0,0,.35);">
          <div style="position:sticky; top:0; background:#fff; border-bottom:1px solid #e5e7eb; padding:12px 14px; display:flex; align-items:center; gap:10px; z-index:2;">
            <div style="font-weight:900; color:#0f172a;">Season Report</div>
            <div style="flex:1"></div>
            <button id="PR_closeSeasonReport" style="border:1px solid #e5e7eb; background:#fff; border-radius:10px; padding:8px 10px; font-weight:800; cursor:pointer;">Close</button>
          </div>
          <div id="PR_seasonReportBody" style="padding:16px 18px;"></div>
        </div>
      `,document.body.appendChild(t),t.addEventListener("click",r=>{r.target===t&&fm()}),t.querySelector("#PR_closeSeasonReport").addEventListener("click",fm)),t.querySelector("#PR_seasonReportBody").innerHTML=e,fN(),t.style.display="block",document.body.style.overflow="hidden"}catch(t){console.error(t),alert("Could not display report.")}}function fm(){const e=document.getElementById("PR_seasonReportOverlay");e&&(e.style.display="none"),document.body.style.overflow=""}function fN(){try{const e=document.getElementById("PR_seasonReportBody");if(!e)return;Array.from(e.querySelectorAll("[data-pr-report-cohort]")).forEach(r=>{r.addEventListener("click",()=>{const s=r.getAttribute("data-pr-report-cohort")||"band";mN(s)})})}catch(e){console.error(e)}}function mN(e){try{const t=window.__dslSeasonReportParams;if(!t||!t.model)return;const r=String(e)==="field"?"field":"band";window.__dslSeasonReportParams={...t,comparatorMode:r};const s=eg({model:t.model,playerName:t.playerName,yearLabel:t.yearLabel,seasonLimit:t.seasonLimit,scoringMode:t.scoringMode,lensMode:t.lensMode,comparatorMode:r});if(!s||!s.ok){alert((s==null?void 0:s.error)||"Could not generate report.");return}Z0(s.htmlFragment||s.html)}catch(t){console.error(t),alert("Could not update report.")}}function eg({model:e,playerName:t,yearLabel:r,seasonLimit:s,scoringMode:i,lensMode:a,comparatorMode:o}){var c="",l=NaN,u=NaN,d=0;const x=Array.isArray(e==null?void 0:e.players)?e.players:[];let h=x.find(q=>String((q==null?void 0:q.name)||"")===String(t||""))||x[0]||null;if(!h)return{ok:!1,error:"No player selected."};const p=window&&window.__dslOverviewReport?window.__dslOverviewReport:null,y=!!(p&&String(p.playerName||"")===String(t||"")&&String(p.yearLabel||"")===String(r||"")&&String(p.seasonLimit||"")===String(s||"")&&String(p.scoringMode||"")===String(i||"")),w=y?String(p.comparatorMode||"band")==="par"?"par":String(p.comparatorMode||"band")==="field"?"field":"band":String(o||"band")==="par"?"par":String(o||"band")==="field"?"field":"band";let N=null;y&&(c=String(p.peerBand||p.cohortLabel||""),l=Number.isFinite(Number(p.peerMin))?Number(p.peerMin):NaN,u=Number.isFinite(Number(p.peerMax))?Number(p.peerMax):NaN,d=Number.isFinite(Number(p.peerPlayersN))?Number(p.peerPlayersN):0,p.playerAgg&&(h=p.playerAgg),N=p.peerAgg||null);function f(q){var Ee;const L=F=>({holes:Number.isFinite(Number(F))?Number(F):0,val:0}),X={totalsGross:L((Ee=q==null?void 0:q.totalsGross)==null?void 0:Ee.holes),byParGross:{},bySIGross:{},byYardsGross:{}};["Par 3","Par 4","Par 5","Unknown"].forEach(F=>{var G,H;X.byParGross[F]=L((H=(G=q==null?void 0:q.byParGross)==null?void 0:G[F])==null?void 0:H.holes)}),["16","712","1318","Unknown"].forEach(F=>{var G,H;X.bySIGross[F]=L((H=(G=q==null?void 0:q.bySIGross)==null?void 0:G[F])==null?void 0:H.holes)});const fe=(q==null?void 0:q.byYardsGross)||{};return Object.keys(fe||{}).forEach(F=>{var G;X.byYardsGross[F]=L((G=fe==null?void 0:fe[F])==null?void 0:G.holes)}),X}w==="par"&&(c="Par baseline",d=0,l=NaN,u=NaN,N=f(h));function m(q){let L=Array.isArray(q)?q.slice():[];const X=String(r||"All"),fe=String(s||"All"),Ee=F=>{const G=(F==null?void 0:F.date)||(F==null?void 0:F.eventDate)||(F==null?void 0:F.roundDate)||(F==null?void 0:F.ts)||(F==null?void 0:F.when)||(F==null?void 0:F.playedAt)||"",H=new Date(G);if(!isNaN(H))return H.getTime();const Ne=String(G).match(/(20\d{2})/);return Ne?new Date(Ne[1]+"-01-01").getTime():0};if(X&&X!=="All"){const F=H=>{const Ne=String(H??"").trim(),ae=Ne.match(/^(\d{4})-(\d{2})$/);if(ae){const ye=ae[1],Te=String(Number(ye.slice(0,2)+ae[2]));return`${ye}-${Te}`}return Ne},G=F(X);L=L.filter(H=>{const Ne=(H&&(H.seasonId??H.season_id))??"";return F(Ne)===G})}if(L.sort((F,G)=>Ee(F)-Ee(G)),fe&&fe!=="All"){const F=parseInt(fe,10);!isNaN(F)&&F>0&&L.length>F&&(L=L.slice(-F))}return L}let v=x.filter(q=>q&&String((q==null?void 0:q.name)||"")!==String((h==null?void 0:h.name)||""));if(!N){const q=String(o||"band")==="field"?"field":"band";try{if(q==="field")c="Field";else{const fe=m(h==null?void 0:h.series),Ee=_mean(fe.map(H=>ou(H==null?void 0:H.hcap,NaN))),F=Number.isFinite(Ee)?Ee>=18?6:Ee>=10?4:3:4,G=x.filter(H=>{if(!H||String((H==null?void 0:H.name)||"")===String((h==null?void 0:h.name)||""))return!1;const Ne=m(H==null?void 0:H.series),ae=_mean(Ne.map(ye=>ou(ye==null?void 0:ye.hcap,NaN)));return Number.isFinite(Ee)&&Number.isFinite(ae)&&Math.abs(ae-Ee)<=F});if(G.length<3)v=x.filter(H=>H&&String((H==null?void 0:H.name)||"")!==String((h==null?void 0:h.name)||"")),c="Field (band too small)";else{v=G.slice();const H=Ee-F,Ne=Ee+F;c=`Handicap band (${H.toFixed(1)}${Ne.toFixed(1)})`}}let L=1/0,X=-1/0;for(const fe of v){const Ee=m(fe==null?void 0:fe.series),F=_mean(Ee.map(G=>ou(G==null?void 0:G.hcap,NaN)));Number.isFinite(F)&&(L=Math.min(L,F),X=Math.max(X,F))}L!==1/0&&(l=L,u=X),d=v.length}catch{}}const E=String(i)==="gross",C=E?(h==null?void 0:h.totalsGross)||_makeAggGross():(h==null?void 0:h.totals)||_makeAgg(),T=N?E?(N==null?void 0:N.totalsGross)||_makeAggGross():(N==null?void 0:N.totals)||_makeAgg():E?hm(v,"totalsGross",_makeAggGross):hm(v,"totals",_makeAgg),B=E?ec(C):Zl(C),Y=E?ec(T):Zl(T),le=E?Y-B:B-Y,J=B,De=Y,nt=Ve(h==null?void 0:h.rounds,NaN),Ke=Ve(C==null?void 0:C.holes,NaN),He=ea({scoringMode:i,dim:"SI",mapObj:E?h==null?void 0:h.bySIGross:h==null?void 0:h.bySI,fieldObj:N?E?(N==null?void 0:N.bySIGross)||{}:(N==null?void 0:N.bySI)||{}:E?Ci(v,"bySIGross",_makeAggGross):Ci(v,"bySI",_makeAgg),limit:6}),Ze=ea({scoringMode:i,dim:"Par",mapObj:E?h==null?void 0:h.byParGross:h==null?void 0:h.byPar,fieldObj:N?E?(N==null?void 0:N.byParGross)||{}:(N==null?void 0:N.byPar)||{}:E?Ci(v,"byParGross",_makeAggGross):Ci(v,"byPar",_makeAgg),limit:6}),ce=ea({scoringMode:i,dim:"Yards",mapObj:E?h==null?void 0:h.byYardsGross:h==null?void 0:h.byYards,fieldObj:N?E?(N==null?void 0:N.byYardsGross)||{}:(N==null?void 0:N.byYards)||{}:E?Ci(v,"byYardsGross",_makeAggGross):Ci(v,"byYards",_makeAgg),limit:10}),$=Array.isArray(h==null?void 0:h.roundSeries)?h.roundSeries:m(h==null?void 0:h.series),R=tc({scoringMode:i,windowSeries:$}),U=Ve(C==null?void 0:C.holes,0)||0,D=Ve(T==null?void 0:T.holes,0)||0,A=(()=>{const q=(L,X=NaN)=>{const fe=Number(L);return Number.isFinite(fe)?fe:X};try{const L=(Ee,F,G,H)=>({birdiePlusRate:U?q(Ee,NaN)/U:NaN,parRate:U?q(F,NaN)/U:NaN,bogeyRate:U?q(G,NaN)/U:NaN,badRate:U?q(H,NaN)/U:NaN});let X;String(i)==="gross"?X=L(C==null?void 0:C.birdies,C==null?void 0:C.pars,C==null?void 0:C.bogeys,q(C==null?void 0:C.doubles,0)+q(C==null?void 0:C.triplesPlus,0)):X=L(C==null?void 0:C.birdies,C==null?void 0:C.pars,C==null?void 0:C.bogeys,C==null?void 0:C.wipes);const fe=R||{};return!Number.isFinite(X.birdiePlusRate)&&Number.isFinite(fe.birdiePlusRate)&&(X.birdiePlusRate=fe.birdiePlusRate),!Number.isFinite(X.parRate)&&Number.isFinite(fe.parRate)&&(X.parRate=fe.parRate),!Number.isFinite(X.bogeyRate)&&Number.isFinite(fe.bogeyRate)&&(X.bogeyRate=fe.bogeyRate),!Number.isFinite(X.badRate)&&Number.isFinite(fe.badRate)&&(X.badRate=fe.badRate),X}catch{}return R})();let W={birdiePlusRate:NaN,parRate:NaN,bogeyRate:NaN,badRate:NaN};try{String(i)==="gross"?W={birdiePlusRate:D?Ve(T==null?void 0:T.birdies,0)/D:NaN,parRate:D?Ve(T==null?void 0:T.pars,0)/D:NaN,bogeyRate:D?Ve(T==null?void 0:T.bogeys,0)/D:NaN,badRate:D?(Ve(T==null?void 0:T.doubles,0)+Ve(T==null?void 0:T.triplesPlus,0))/D:NaN}:W={birdiePlusRate:D?Ve(T==null?void 0:T.birdies,0)/D:NaN,parRate:D?Ve(T==null?void 0:T.pars,0)/D:NaN,bogeyRate:D?Ve(T==null?void 0:T.bogeys,0)/D:NaN,badRate:D?Ve(T==null?void 0:T.wipes,NaN)/D:NaN};const q=(Array.isArray(v)?v:[]).flatMap(Ee=>Array.isArray(Ee==null?void 0:Ee.roundSeries)?Ee.roundSeries:m(Ee==null?void 0:Ee.series)),L=tc({scoringMode:i,windowSeries:q})||{},X=(Ee,F)=>!Number.isFinite(Ee)||Ee===0&&D>0&&Ve(F,0)===0;X(W.birdiePlusRate,T==null?void 0:T.birdies)&&Number.isFinite(L.birdiePlusRate)&&(W.birdiePlusRate=L.birdiePlusRate),X(W.parRate,T==null?void 0:T.pars)&&Number.isFinite(L.parRate)&&(W.parRate=L.parRate),X(W.bogeyRate,T==null?void 0:T.bogeys)&&Number.isFinite(L.bogeyRate)&&(W.bogeyRate=L.bogeyRate);const fe=String(i)==="gross"?Ve(T==null?void 0:T.doubles,0)+Ve(T==null?void 0:T.triplesPlus,0):Ve(T==null?void 0:T.wipes,0);X(W.badRate,fe)&&Number.isFinite(L.badRate)&&(W.badRate=L.badRate)}catch{}Ve(A==null?void 0:A.badRate,NaN),Ve(W==null?void 0:W.badRate,NaN),Ve(A==null?void 0:A.bogeyRate,NaN),Ve(W==null?void 0:W.bogeyRate,NaN);function Fe(q,L=3){const X=(q||[]).map(fe=>{const Ee=Number(fe.playerAvg),F=Number(fe.fieldAvg),H=-(E?F-Ee:Ee-F);return{label:fe.label,holes:fe.holes,me:fe.playerAvg,fld:fe.fieldAvg,bad:H}}).filter(fe=>Number.isFinite(fe.bad)&&Ve(fe.holes,0)>=12);return X.sort((fe,Ee)=>Ee.bad-fe.bad),X.slice(0,L)}[...Fe(He,2),...Fe(Ze,2),...Fe(ce,3)].sort((q,L)=>L.bad-q.bad).slice(0,3),`${Ms((h==null?void 0:h.name)||t||"Player")}`,`${Ms(r||"All years")}`;let de="Season Finale",oe="";try{const q=Array.isArray($)?$:[],L=q.length?q[q.length-1]:null;if(L){de=String((L==null?void 0:L.eventName)||(L==null?void 0:L.event)||(L==null?void 0:L.competition)||(L==null?void 0:L.name)||(L==null?void 0:L.course)||"Season Finale");const X=(L==null?void 0:L.date)||(L==null?void 0:L.roundDate)||(L==null?void 0:L.playedAt)||(L==null?void 0:L.played_on)||(L==null?void 0:L.ts)||"",fe=new Date(X);oe=X?isNaN(fe.getTime())?String(X):fe.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):""}}catch{}const xe=q=>{const L=Number.isFinite(q==null?void 0:q.me)?q.me:Number.isFinite(q==null?void 0:q.playerAvg)?q.playerAvg:NaN,X=Number.isFinite(q==null?void 0:q.peer)?q.peer:Number.isFinite(q==null?void 0:q.fieldAvg)?q.fieldAvg:NaN;return!Number.isFinite(L)||!Number.isFinite(X)?NaN:E?X-L:L-X},Ye=q=>Number.isFinite(q==null?void 0:q.me)?q.me:Number.isFinite(q==null?void 0:q.playerAvg)?q.playerAvg:NaN,O=[].concat(He||[],Ze||[],ce||[]),ht=O.map(q=>({...q,delta:Number.isFinite(q==null?void 0:q.delta)?q.delta:xe(q)})).filter(q=>Number.isFinite(q.delta));let Re=null,ne=null;if(w==="par"){const q=O.map(L=>({...L,meAbs:Ye(L)})).filter(L=>Number.isFinite(L.meAbs));Re=q.slice().sort((L,X)=>L.meAbs-X.meAbs)[0]||null,ne=q.slice().sort((L,X)=>X.meAbs-L.meAbs)[0]||null}else Re=ht.slice().sort((q,L)=>L.delta-q.delta)[0]||null,ne=ht.slice().sort((q,L)=>q.delta-L.delta)[0]||null;const Ue=`
  <style>
    .PRr{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:#0f172a}
    .PRh1{font-size:22px;font-weight:950;margin:0 0 6px}
    .PRsub{color:#475569;font-size:13px;margin:0 0 14px}
    .PRbox{border:1px solid #e5e7eb;border-radius:14px;padding:12px 14px;background:#fff}
    .PRgrid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .PRsec{margin-top:14px}
    .PRsecTitle{font-weight:950;margin:0 0 8px;font-size:14px;letter-spacing:.04em;text-transform:uppercase;color:#0f172a}
    .PRk{font-size:12px;color:#475569;text-transform:uppercase;letter-spacing:.06em}
    .PRv{font-size:18px;font-weight:950;margin-top:4px}
    .PRp{margin:8px 0;color:#0f172a;line-height:1.35}
    .PRmuted{color:#475569}
    .PRtbl{width:100%;border-collapse:collapse;table-layout:fixed;font-variant-numeric:tabular-nums}
    .PRtbl col.c1{width:40%}
    .PRtbl col.c2,.PRtbl col.c3,.PRtbl col.c4,.PRtbl col.c5{width:15%}
    .PRtbl th,.PRtbl td{padding:8px 10px;border-bottom:1px solid #e5e7eb}
    /* --- Table "good vs bad" clarity --- */
    .PRtbl tbody tr.PRrow.good td{background:rgba(16,185,129,0.06)}
    .PRtbl tbody tr.PRrow.bad td{background:rgba(244,63,94,0.06)}
    .PRtbl tbody tr.PRrow.neu td{background:transparent}
    .PRtbl tbody tr.PRrow td:first-child{font-weight:900}
    .PRtbl tbody tr.PRrow:hover td{filter:brightness(0.99)}
    .PRdeltaBadge{display:inline-flex;align-items:center;gap:6px;justify-content:flex-end;padding:4px 8px;border-radius:9999px;border:1px solid #e5e7eb;font-weight:950}
    .PRdeltaBadge.good{border-color:rgba(16,185,129,0.35);background:rgba(16,185,129,0.10);color:#065f46}
    .PRdeltaBadge.bad{border-color:rgba(244,63,94,0.35);background:rgba(244,63,94,0.10);color:#9f1239}
    .PRdeltaBadge.neu{border-color:rgba(100,116,139,0.25);background:rgba(148,163,184,0.12);color:#334155}
    .PRarr{font-size:10px;opacity:0.9}
    .PRlegend{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:0 0 10px}
    .PRlegItem{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:9999px;border:1px solid #e5e7eb;font-size:11px;font-weight:900;color:#0f172a}
    .PRlegItem.good{border-color:rgba(16,185,129,0.30);background:rgba(16,185,129,0.08);color:#065f46}
    .PRlegItem.bad{border-color:rgba(244,63,94,0.30);background:rgba(244,63,94,0.08);color:#9f1239}
    .PRlegItem.neu{border-color:rgba(100,116,139,0.22);background:rgba(148,163,184,0.10);color:#334155}
    .PRlegDot{width:9px;height:9px;border-radius:9999px;background:currentColor;opacity:0.8}
    .PRlegNote{color:#475569;font-size:11px;font-weight:700}

    .PRtbl th:first-child,.PRtbl td:first-child{text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .PRtbl th:not(:first-child),.PRtbl td:not(:first-child){text-align:right}
    .PRnote{font-size:12px;color:#475569;margin-top:10px}
    .PRpill{display:inline-block;border:1px solid #e5e7eb;border-radius:999px;padding:3px 8px;font-size:12px;color:#0f172a;background:#fff}
  </style>

  <div class="PRr">
    <div class="PRh1">Season Report: ${Ms(t||"")}</div>
    <div class="PRsub">
      Benchmark: <b>${Ms(c||"")}</b>
       <b>${Ve(nt,0)}</b> rounds
       <b>${Ve(Ke,0)}</b> holes analysed
      <span class="PRpill" style="margin-left:8px;">${String(i)==="gross"?"Gross strokes":"Stableford points"} vs ${w==="par"?"Par baseline":w==="field"?"Field":"Handicap band"}</span>
      ${w==="par"?"":`<span class="PRpill" style="margin-left:8px;">Peers: <b>${d}</b>${Number.isFinite(l)&&Number.isFinite(u)?`  Avg hcap range <b>${l.toFixed(1)}${u.toFixed(1)}</b>`:""}</span>`}
    </div>

    <div class="PRbox PRsec">
      <div class="PRsecTitle">1. The Season Headline</div>
      <p class="PRp">
  ${w==="par"?`
    <b>Scoring vs Par:</b>
    You average <b>${Number.isFinite(J)?J.toFixed(2):""}</b> strokes over par per hole ( <b>${Number.isFinite(J)?(J*18).toFixed(1):""}</b> over par per 18 holes).
  `:`
    <b>Net Performance vs Peers:</b>
    ${Number.isFinite(le)?E?le>=0?`You average <b>${le.toFixed(2)}</b> fewer strokes per hole than your peer group ( <b>${(le*18).toFixed(1)}</b> fewer strokes per 18 holes).`:`You average <b>${Math.abs(le).toFixed(2)}</b> more strokes per hole than your peer group ( <b>${(Math.abs(le)*18).toFixed(1)}</b> more strokes per 18 holes).`:le>=0?`You score <b>${le.toFixed(2)}</b> more Stableford points per hole than your peer group ( <b>${(le*18).toFixed(1)}</b> more points per 18 holes).`:`You score <b>${Math.abs(le).toFixed(2)}</b> fewer Stableford points per hole than your peer group ( <b>${(Math.abs(le)*18).toFixed(1)}</b> fewer points per 18 holes).`:""}
  `}
</p>
      <p class="PRp">
  <b>Scoring Average:</b>
  ${w==="par"?`
    Your scoring average is <b>${Number.isFinite(J)?J.toFixed(2):""}</b> strokes over par per hole.
  `:`
    ${E?`Your scoring average is <b>${Number.isFinite(J)?J.toFixed(2):""}</b> strokes over par per hole, compared to a peer average of <b>${Number.isFinite(De)?De.toFixed(2):""}</b> over par.`:`Your scoring average is <b>${Number.isFinite(J)?J.toFixed(2):""}</b> Stableford points per hole ( <b>${Number.isFinite(J)?(J*18).toFixed(1):""}</b> points per 18 holes), compared to a peer average of <b>${Number.isFinite(De)?De.toFixed(2):""}</b> points per hole.`}
  `}
</p>
      <p class="PRp">
  <b>Scoring Profile:</b>
  ${w==="par"?`
    Birdie+ rate <b>${Number.isFinite(A==null?void 0:A.birdiePlusRate)?(A.birdiePlusRate*100).toFixed(1)+"%":""}</b> 
    Damage (Double+) <b>${Number.isFinite(A==null?void 0:A.badRate)?(A.badRate*100).toFixed(1)+"%":""}</b>.
    <span class="PRmuted">Damage usually provides the biggest scoring lever in absolute terms.</span>
  `:`
    Birdie+ rate <b>${Number.isFinite(A==null?void 0:A.birdiePlusRate)?(A.birdiePlusRate*100).toFixed(1)+"%":""}</b> (Peers:
    <b>${Number.isFinite(W==null?void 0:W.birdiePlusRate)?(W.birdiePlusRate*100).toFixed(1)+"%":""}</b>) 
    Damage (Double+) <b>${Number.isFinite(A==null?void 0:A.badRate)?(A.badRate*100).toFixed(1)+"%":""}</b> (Peers:
    <b>${Number.isFinite(W==null?void 0:W.badRate)?(W.badRate*100).toFixed(1)+"%":""}</b>).
    ${Number.isFinite(A==null?void 0:A.birdiePlusRate)&&Number.isFinite(W==null?void 0:W.birdiePlusRate)&&Number.isFinite(A==null?void 0:A.badRate)&&Number.isFinite(W==null?void 0:W.badRate)&&Math.abs((A.birdiePlusRate-W.birdiePlusRate)*100)<2&&(A.badRate-W.badRate)*100!==0?'<span class="PRmuted">This indicates that your net performance vs peers is driven more by Damage (double+) frequency than by Birdie+ frequency.</span>':" "}
  `}
</p>
      <div class="PRnote">All values are based on ${String(i)==="gross"?"gross strokes":"Stableford points"}, benchmarked against the selected comparator (${w==="par"?"Par baseline":w==="field"?"Field":"Handicap band"}).</div>
    </div>

    <div class="PRbox PRsec">
      <div class="PRsecTitle">2. Performance Insights</div>
      <p class="PRp">
        <b>Primary Strength:</b>
        ${w==="par"?`
          Your best scoring is in <b>${Ms((Re==null?void 0:Re.label)||(Re==null?void 0:Re.key)||"")}</b>, where you average <b>${Number.isFinite(Ye(Re))?Ye(Re).toFixed(2):""}</b> strokes over par per hole.
        `:`
          Your biggest advantage is in <b>${Ms((Re==null?void 0:Re.label)||(Re==null?void 0:Re.key)||"")}</b>, where you gain <b>${Number.isFinite(Re==null?void 0:Re.delta)?Re.delta.toFixed(2):""}</b> strokes per hole over peers.
        `}
      </p>
      <p class="PRp">
        <b>The Focus Leak:</b>
        ${w==="par"?`
          Your worst scoring is in <b>${Ms((ne==null?void 0:ne.label)||(ne==null?void 0:ne.key)||"")}</b>, where you average <b>${Number.isFinite(Ye(ne))?Ye(ne).toFixed(2):""}</b> strokes over par per hole.
        `:`
          Your primary area for improvement is <b>${Ms((ne==null?void 0:ne.label)||(ne==null?void 0:ne.key)||"")}</b>, costing <b>${Number.isFinite(ne==null?void 0:ne.delta)?ne.delta.toFixed(2):""}</b> strokes per hole compared to your handicap cohort.
        `}
      </p>
      <p class="PRp">
  <b>Biggest Stroke Lever:</b>
  ${w==="par"?`
    Damage (double+) occurs <b>${Number.isFinite(A==null?void 0:A.badRate)?(A.badRate*100).toFixed(1)+"%":""}</b> of the time. Cutting big numbers is usually the fastest way to lower your overpar scoring.
  `:`
    ${(()=>{if(!Number.isFinite(A==null?void 0:A.badRate)||!Number.isFinite(W==null?void 0:W.badRate))return"";const q=A.badRate,L=W.badRate,X=(L-q)*100,fe=X>=0?"less often":"more often",Ee=Math.abs(X),F=(q*100).toFixed(1),G=(L*100).toFixed(1),H=Ee/100*18,Ne=X>=0?"fewer":"more",ae=X>=0?"saved":"lost";return`Damage (double+) occurs <b>${Ee.toFixed(1)}% ${fe}</b> than peers (${F}% vs ${G}%), equivalent to ~<b>${H.toFixed(1)}</b> ${Ne} damage holes per 18 (strokes typically ${ae} are meaningful).`})()}
  `}
</p>
    </div>

    <div class="PRbox PRsec">
      <div class="PRsecTitle">3. The Evidence Locker</div>
      <div class="PRmuted" style="font-size:13px;margin-bottom:10px;">Raw peer-benchmarked tables used for the insights above.</div>

      <div style="margin-top:10px;font-weight:900;">By Stroke Index</div>
      ${lu(He,i,w)}

      <div style="margin-top:14px;font-weight:900;">By Par Type</div>
      ${lu(Ze,i,w)}

      <div style="margin-top:14px;font-weight:900;">By Yardage</div>
      ${lu(ce,i,w)}
    </div>
  </div>
  `;return{ok:!0,htmlFragment:Ue,html:Ue,filename:`SeasonReport_${hN(t||"player")}.html`}}function pN(e){const t=String(e||"Den Society League").trim();return`<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>${t}  Golfers Guide</title>

  <style>
    :root{
      --card: rgba(255,255,255,.86);
      --shadowA: 0 1px 2px rgba(15,23,42,.06);
      --shadowB: 0 18px 46px rgba(15,23,42,.14);
      --shadowC: 0 10px 26px rgba(15,23,42,.10);
      --radius: 22px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: #0f172a;
      background:
        radial-gradient(1000px 600px at 0% 0%, rgba(16,185,129,.18), transparent 55%),
        radial-gradient(900px 600px at 100% 0%, rgba(99,102,241,.18), transparent 55%),
        radial-gradient(900px 600px at 50% 100%, rgba(244,63,94,.10), transparent 55%),
        linear-gradient(180deg, #f8fafc, #eef2ff 55%, #f8fafc);
      background-attachment: fixed;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .wrap{max-width:1100px; margin:0 auto; padding:20px 16px 70px;}
    .topbar{
      position: sticky; top: 0; z-index: 50;
      padding-top: env(safe-area-inset-top);
      backdrop-filter: blur(12px);
      background: rgba(255,255,255,.72);
      border-bottom: 1px solid rgba(148,163,184,.18);
    }
    .topbar-inner{
      max-width:1100px; margin:0 auto; padding:14px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:12px; min-width:0;
    }
    .logo{
      width:42px; height:42px; border-radius:14px;
      background: linear-gradient(180deg, rgba(34,197,94,.35), rgba(25,159,87,.18));
      border:1px solid rgba(16,185,129,.35);
      box-shadow: var(--shadowA);
      display:grid; place-items:center;
      flex: 0 0 auto;
    }
    .logo svg{width:24px; height:24px}
    .brand h1{
      margin:0; line-height:1.05;
      font-weight: 900;
      letter-spacing: -.03em;
      font-size: 16px;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .brand p{
      margin:3px 0 0;
      font-size: 12px;
      color: rgba(100,116,139,1);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    .chips{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(16,185,129,.30);
      background: rgba(240,253,244,.70);
      font-size: 12px;
      font-weight: 800;
      box-shadow: var(--shadowA);
      cursor: pointer;
      user-select:none;
    }
    .chip:hover{transform: translateY(-1px)}
    .btn{
      border:0;
      padding: 10px 14px;
      border-radius: 999px;
      font-weight: 900;
      cursor:pointer;
      box-shadow: var(--shadowA), var(--shadowC);
    }
    .btn.primary{
      background: linear-gradient(180deg, #22c55e, #199f57);
      color:white;
      border: 1px solid rgba(20,127,71,.55);
    }
    .btn.ghost{
      background: rgba(255,255,255,.82);
      border: 1px solid rgba(148,163,184,.22);
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media (min-width: 920px){
      .grid{grid-template-columns: 1.2fr .8fr;}
    }

    .card{
      background: var(--card);
      border: 1px solid rgba(255,255,255,.6);
      border-radius: var(--radius);
      box-shadow: var(--shadowA), var(--shadowB);
      backdrop-filter: blur(12px);
      overflow:hidden;
    }
    .card.pad{padding:16px}
    @media (min-width: 720px){ .card.pad{padding:20px} }

    .hero{
      padding: 18px;
      background:
        radial-gradient(900px 300px at 0% 0%, rgba(16,185,129,.20), transparent 60%),
        radial-gradient(900px 300px at 100% 0%, rgba(99,102,241,.12), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.8), rgba(255,255,255,.66));
      border-bottom: 1px solid rgba(148,163,184,.18);
    }
    .kicker{
      font-size: 10px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: rgba(100,116,139,1);
      font-weight: 900;
      display:flex; align-items:center; gap:10px;
    }
    .kicker .dot{
      width:10px; height:10px; border-radius:4px;
      background: rgba(99,102,241,.28);
      border: 1px solid rgba(99,102,241,.22);
    }
    .title{
      margin:10px 0 0;
      font-size: clamp(26px, 4.2vw, 44px);
      line-height: 1.05;
      font-weight: 950;
      letter-spacing: -.03em;
      color: #0b1220;
    }
    .subtitle{
      margin:10px 0 0;
      max-width: 70ch;
      font-size: 14px;
      color: rgba(71,85,105,1);
      line-height: 1.55;
    }
    .hero-actions{
      margin-top: 14px;
      display:flex; gap:10px; flex-wrap:wrap;
    }

    .statbar{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      padding: 14px 16px 16px;
      background: rgba(255,255,255,.58);
    }
    .stat{
      border-radius: 18px;
      border: 1px solid rgba(148,163,184,.18);
      background: rgba(248,250,252,.85);
      padding: 12px 12px;
    }
    .stat .lbl{
      font-size: 10px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: rgba(100,116,139,1);
      font-weight: 900;
    }
    .stat .val{
      margin-top:6px;
      font-size: 15px;
      font-weight: 950;
      letter-spacing: -.02em;
    }
    .stat .hint{
      margin-top:6px;
      font-size: 12px;
      color: rgba(100,116,139,1);
      line-height: 1.35;
    }

    .h2{
      margin:0;
      font-size: 14px;
      font-weight: 950;
      letter-spacing: -.01em;
      display:flex; align-items:center; gap:10px;
      flex-wrap: wrap;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 900;
      border: 1px solid rgba(148,163,184,.20);
      background: rgba(2,6,23,.04);
      color: rgba(15,23,42,.80);
    }
    .p{
      margin:10px 0 0;
      font-size: 13px;
      line-height: 1.6;
      color: rgba(51,65,85,1);
    }

    .list{
      margin:10px 0 0; padding:0; list-style:none;
      display:grid; gap:10px;
    }
    .li{
      display:flex; gap:12px;
      padding: 12px 12px;
      border-radius: 18px;
      border: 1px solid rgba(148,163,184,.18);
      background: rgba(255,255,255,.70);
    }
    .ico{
      width:34px; height:34px;
      border-radius: 12px;
      display:grid; place-items:center;
      background: rgba(25,159,87,.10);
      border: 1px solid rgba(16,185,129,.22);
      flex: 0 0 auto;
      font-size: 16px;
    }
    .li b{display:block; font-size: 13px; font-weight: 950;}
    .li span{display:block; font-size: 12px; color: rgba(100,116,139,1); margin-top:4px; line-height:1.45;}

    .accordion{
      border-radius: 18px;
      border: 1px solid rgba(148,163,184,.18);
      overflow:hidden;
      background: rgba(255,255,255,.72);
    }
    details{ border-top: 1px solid rgba(148,163,184,.14); }
    details:first-child{border-top:0}
    summary{
      cursor:pointer;
      padding: 12px 14px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      font-weight: 950;
      user-select:none;
    }
    summary::-webkit-details-marker{display:none}
    summary .meta{
      font-size: 11px;
      font-weight: 900;
      color: rgba(100,116,139,1);
      margin-top: 3px;
    }
    .sum-left{display:flex; align-items:flex-start; gap:10px}
    .caret{
      width: 28px; height: 28px;
      border-radius: 12px;
      display:grid; place-items:center;
      background: rgba(2,6,23,.04);
      border: 1px solid rgba(148,163,184,.18);
      flex: 0 0 auto;
    }
    .content{
      padding: 0 14px 14px;
      color: rgba(51,65,85,1);
      font-size: 13px;
      line-height: 1.6;
    }
    .content .mini{ margin-top: 10px; display:grid; gap:10px; }
    .callout{
      border-radius: 18px;
      border: 1px solid rgba(16,185,129,.25);
      background: rgba(240,253,244,.75);
      padding: 12px 12px;
    }
    .callout b{font-weight: 950}
    .callout p{margin:6px 0 0; font-size: 12px; color: rgba(71,85,105,1); line-height: 1.5;}
    .danger{
      border-color: rgba(244,63,94,.22);
      background: rgba(254,242,242,.70);
    }

    /* Badges */
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 950;
      letter-spacing: .01em;
      border: 1px solid rgba(148,163,184,.22);
      background: rgba(255,255,255,.82);
      color: rgba(15,23,42,.85);
      box-shadow: var(--shadowA);
      white-space: nowrap;
    }
    .badge .spark{opacity:.9}
    .badge.captain{
      border-color: rgba(99,102,241,.22);
      background: rgba(99,102,241,.10);
      color: rgba(55,48,163,1);
    }
    .badge.favourite{
      border-color: rgba(245,158,11,.26);
      background: rgba(245,158,11,.12);
      color: rgba(146,64,14,1);
    }
    .badge.hype{
      border-color: rgba(16,185,129,.26);
      background: rgba(16,185,129,.12);
      color: rgba(6,95,70,1);
    }

    .footer{
      margin-top: 16px;
      padding: 14px 16px;
      color: rgba(100,116,139,1);
      font-size: 12px;
      text-align:center;
    }

    /* Floating Start here */
    .fab{
      position: fixed;
      right: 16px;
      bottom: 16px;
      z-index: 999;
      display:flex; align-items:center; gap:10px;
      padding: 12px 14px;
      border-radius: 999px;
      background: rgba(17,24,39,.92);
      color:white;
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 16px 44px rgba(0,0,0,.22);
      backdrop-filter: blur(10px);
      cursor:pointer;
    }
    .fab:hover{transform: translateY(-1px)}

    .tagline{
      display:inline-flex; align-items:center; gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(99,102,241,.22);
      background: rgba(99,102,241,.10);
      color: rgba(55,48,163,1);
      font-size: 12px;
      font-weight: 900;
      margin-left: 10px;
      white-space: nowrap;
    }
  </style>

<!-- iPhone: run as a standalone (full-screen) web app when launched from Home Screen -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="${t}">

<!-- PWA manifest + app icons -->
<link rel="manifest" href="manifest.webmanifest">
<link rel="apple-touch-icon" href="icons/apple-touch-icon.png">

</head>

<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M6 13c2.2 3.6 8.2 3.6 10.4-1.4" stroke="white" stroke-width="2.2" stroke-linecap="round"/>
            <circle cx="9" cy="9" r="1.7" fill="white"/>
            <circle cx="15" cy="9" r="1.7" fill="white"/>
          </svg>
        </div>
        <div style="min-width:0">
          <h1>${t}  Golfers Guide</h1>
          <p>What it does  How to use it  How it actually drops your scores</p>
        </div>
      </div>

      <div class="chips" aria-label="Quick navigation">
        <button class="chip" data-jump="#what"><span aria-hidden="true"></span>What is it?</button>
        <button class="chip" data-jump="#how"><span aria-hidden="true"></span>Quick start</button>
        <button class="chip" data-jump="#improve-hub"><span aria-hidden="true"></span>Improve tools</button>
        <button class="chip" data-jump="#views"><span aria-hidden="true"></span>Menu map</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="hero">
        <div class="kicker"><span class="dot" aria-hidden="true"></span>ONE-FILE LEAGUE + ANALYTICS <span class="tagline">Sports broadcast vibe</span></div>
        <h2 class="title">Turn your society golf into <br/>a scoreboard, a story... and a plan.</h2>
        <p class="subtitle">
          Load a <b>Squabbit event game</b> and the app builds leaderboards, scorecards, course insights, season standings,
          and the fun stuff (Replay, Teams, Banter, Casino, Trophies).
          Its designed for golfers: <b>simple, punchy, and brutally useful.</b>
        </p>

        <div class="hero-actions">
          <button class="btn primary" data-jump="#how">Start in 60 seconds</button>
          <button class="btn ghost" data-jump="#improve-hub">How it helps you improve</button>
          <button class="btn ghost" data-jump="#views">What screens exist?</button>
        </div>
      </div>

      <div class="statbar" id="what">
        <div class="stat">
          <div class="lbl">What it replaces</div>
          <div class="val">Spreadsheets + vibes</div>
          <div class="hint">No more I think Im bad on par 3s  it shows it.</div>
        </div>
        <div class="stat">
          <div class="lbl">What it creates</div>
          <div class="val">Decisions</div>
          <div class="hint">Where you win, where you leak, and what to do next.</div>
        </div>
      </div>
    </section>

    <div class="grid" style="margin-top:14px">
      <section class="card pad" id="how">
        <h3 class="h2"> Quick start <span class="pill">Do this first</span></h3>
        <p class="p">
          Think of the app as two modes: <b>Game</b> (single round deep-dive) and <b>League</b> (season story).
        </p>

        <ol class="list">
          <li class="li">
            <div class="ico" aria-hidden="true">1</div>
            <div>
              <b>Enter Game Explorer</b>
              <span>Choose the course and date you want to explore  the app builds the round instantly.</span>
            </div>
          </li>
          <li class="li">
            <div class="ico" aria-hidden="true">2</div>
            <div>
              <b>Open the Menu</b>
              <span>Pick your view: leaderboards, scorecards, replay, teams, trophies, banter... the lot.</span>
            </div>
          </li>
          <li class="li">
            <div class="ico" aria-hidden="true">3</div>
            <div>
              <b>Add to League (optional)</b>
              <span>
                <span class="badge captain"><span class="spark"></span>This bit is for Admin/Captain/Captain</span>
                Stack rounds into a season for standings, progress trends, reports, trophies, and more.
              </span>
            </div>
          </li>
        </ol>

        <div class="callout" style="margin-top:12px">
          <b>The point:</b>
          <p>
            You dont need advanced analytics to get better.
            You need <b>one clear leak</b>, a <b>simple target</b>, and a <b>re-check loop</b>.
          </p>
        </div>
      </section>

      <aside class="card pad">
        <h3 class="h2"> Improve fast <span class="pill">The loop</span></h3>
        <p class="p">
          The fastest improvement is boring: <b>find the leak  fix it  prove it</b>.
          The apps improvement tools make that loop effortless.
        </p>

        <div class="accordion" style="margin-top:12px">
          <details open>
            <summary>
              <div class="sum-left">
                <div class="ico" aria-hidden="true" style="background:rgba(240,253,244,.9);border-color:rgba(16,185,129,.25)"></div>
                <div>
                  Spot the leak
                  <div class="meta">Find where shots disappear</div>
                </div>
              </div>
              <div class="caret" aria-hidden="true"></div>
            </summary>
            <div class="content">
              Use <b>Player Scorecard</b> to find blow-up holes, and <b>Course Stats</b> to see where the course bites.
              Then jump into <b>Player Progress</b> to confirm whether its a pattern or a one-off.
            </div>
          </details>

          <details>
            <summary>
              <div class="sum-left">
                <div class="ico" aria-hidden="true" style="background:rgba(99,102,241,.12);border-color:rgba(99,102,241,.22)"></div>
                <div>
                  Choose the fix
                  <div class="meta">Practice + on-course decisions</div>
                </div>
              </div>
              <div class="caret" aria-hidden="true"></div>
            </summary>
            <div class="content">
              Use <b>Insight</b> for fast answers.
              Then use <b>Play Do</b> to turn that into a simple plan you can actually follow.
              <div style="margin-top:10px">
                <b>Generate Report</b> creates a shareable performance summary using the report type you choose:
                <div style="margin-top:8px;line-height:1.45">
                  <b>Stableford Points vs Field</b>  competitive day view (you vs everyone).<br/>
                  <b>Stableford Points vs Handicap band</b>  fair comparison vs similar ability.<br/>
                  <b>Score vs Field</b>  raw strokes vs everyone.<br/>
                  <b>Score vs Handicap band</b>  strokes vs your peer group.<br/>
                  <b>Score vs Par</b>  where you gained or lost shots vs the course.
                </div>
              </div>
            </div>
          </details>

          <details>
            <summary>
              <div class="sum-left">
                <div class="ico" aria-hidden="true" style="background:rgba(244,63,94,.10);border-color:rgba(244,63,94,.22)"></div>
                <div>
                  Prove it
                  <div class="meta">No guessing, just trend</div>
                </div>
              </div>
              <div class="caret" aria-hidden="true"></div>
            </summary>
            <div class="content">
              Commit to the top 12 fixes for <b>35 rounds</b>.
              Then re-check <b>Player Progress</b> on 5/10 games to see if volatility drops and form improves.
            </div>
          </details>
        </div>
      </aside>
    </div>

    <!-- Improvement hub (explicitly covers the 3 requested tools) -->
    <section class="card pad" id="improve-hub" style="margin-top:14px">
      <h3 class="h2">
         The improvement engine
        <span class="pill">Fast answers  plan  trend</span>
        <span class="badge hype"><span class="spark"></span>Score-dropping stuff</span>
      </h3>

      <p class="p">
        This is where the app stops being nice stats and becomes <b>what to do next</b>.
        Use it as a loop: <b>analyse  decide  repeat</b>.
      </p>

      <div class="accordion" style="margin-top:12px">

        <details open>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>
                Player Progress
                <span class="badge favourite" style="margin-left:10px"><span class="spark"></span>Start here</span>
                <div class="meta">Overview  Insight  Play Do  Analyse 1/5/10/20/30/ALL games for trends &amp; volatility  Season</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>

          <div class="content">
            <b>What it is:</b> a trend view for a player over a chosen window  so you can separate <b>form</b> from <b>noise</b>.
            <div class="mini">
              <div class="callout">
                <b>How it works:</b>
                <p>
                  Pick a player  pick a window (1, 5, 10, 20, 30, ALL)  the app shows how results are moving
                  and how swingy they are (volatility).
                </p>
              </div>
              <div class="callout">
                <b>How to use it:</b>
                <p>
                  If your average is fine but volatility is high, youre not bad  youre leaking disasters.
                  That usually means smarter choices on 23 holes beat swing tweaks.
                </p>
              </div>
            </div>
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>
                Insight
                <span class="badge favourite" style="margin-left:10px"><span class="spark"></span>Fast answers</span>
                <div class="meta">Fast answers: form, vs field, buckets, what to fix  Q&amp;A</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>

          <div class="content">
            <b>What it is:</b> the tell me what to do view  quick, plain-English guidance based on your results.
            <div class="mini">
              <div class="callout">
                <b>How it works:</b>
                <p>
                  It summarises your form, compares you <b>vs the field</b>, groups your scoring into <b>buckets</b>,
                  and highlights the top things to fix first.
                </p>
              </div>
              <div class="callout danger">
                <b>The best way to use it:</b>
                <p>
                  Take the top 12 recommendations and commit for 35 rounds.
                  Then check Player Progress again. If the trend moved, you keep it. If not, you change the plan.
                </p>
              </div>
            </div>
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>
                Play Do
                <span class="badge captain" style="margin-left:10px"><span class="spark"></span>Improvement plan</span>
                <div class="meta"> Improvement plan</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>

          <div class="content">
            <b>What it is:</b> a deeper report that pulls your season/round data into a clear plan.
            <div class="mini">
              <div class="callout">
                <b>How it works:</b>
                <p>
                  Pick a player  the report summarises strengths, weaknesses, and the biggest recurring scoring leaks,
                  then frames an improvement plan you can actually follow.
                </p>
              </div>
              <div class="callout">
                <b>How to use it:</b>
                <p>
                  Pick <b>one</b> focus. Not ten.
                  The best focus is usually the most repeatable leak: penalties, blow-up holes, par-3 scoring, or closing holes.
                </p>
              </div>
            </div>
          </div>
        </details>

      </div>

      <div class="callout" style="margin-top:12px">
        <b>The simple weekly routine:</b>
        <p>
          After each round: <b>Player Scorecard</b> (find where it went wrong).<br/>
          Every few rounds: <b>Player Progress</b> (trend + volatility).<br/>
          Monthly: <b>Insight</b> + <b>Play Do</b> (choose the next focus).
        </p>
      </div>
    </section>

    <!-- FULL MENU COVERAGE -->
    <section class="card pad" id="views" style="margin-top:14px">
      <h3 class="h2">
         Whats inside the app?
        <span class="pill">Every menu explained</span>
        <span class="badge hype" style="margin-left:6px"><span class="spark"></span>Built for the group chat</span>
      </h3>

      <p class="p">
        Heres what each menu item is for  with a bias toward what golfers actually use.
      </p>

      <div class="accordion" style="margin-top:12px">

        <details open>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Game
                <div class="meta">The scoreboard</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            The main leaderboard for the round. The open this first screen.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Graphs
                <div class="meta">Trends and momentum</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Visualise performance over holes/games  perfect for spotting comebacks and collapses.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Player Scorecard
                <div class="meta">Hole-by-hole truth</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Pick a player and see exactly where points were won or thrown away.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Course Stats
                <div class="meta">Which holes bite back</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Course difficulty, scoring opportunities, and where strategy beats swing changes.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Ratings
                <div class="meta">Performance, simplified</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Breaks performance into clean ratings so you can tell what worked without drowning in numbers.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>
                Banter <span class="badge favourite" style="margin-left:10px"><span class="spark"></span>Captains favourite</span>
                <div class="meta">Stats with personality</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Sharable talking points and properly-earned group-chat ammunition.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Styles
                <div class="meta">How you score</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Are you steady? Streaky? Back-nine merchant? Styles makes it obvious.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Story
                <div class="meta">The narrative version</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Turns the day into a story: turning points, momentum swings, late charges.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>
                Replay <span class="badge favourite" style="margin-left:10px"><span class="spark"></span>Must-watch</span>
                <div class="meta">The broadcast replay</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Re-live the round hole-by-hole like TV coverage. Lead changes, pressure moments, and receipts.
            <div class="mini">
              <div class="callout">
                <b>Replay tip:</b>
                <p>Open Replay straight after the round. Its peak entertainment while the pain is fresh.</p>
              </div>
            </div>
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>
                Teams <span class="badge favourite" style="margin-left:10px"><span class="spark"></span>Spiciest screen</span>
                <div class="meta">Who carried who</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Team results explained properly  who delivered, where matches were won/lost, and why the weak link rumours started.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Casino
                <div class="meta">Side games, sorted</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Side games and extras tracked cleanly so nobody forgets what they owe.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Trophies
                <div class="meta">Permanent bragging rights</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Achievements that stick  because golf needs a history of receipts.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Partners
                <div class="meta">Best and worst combinations</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            See who you play best with  and who you should never be paired with again.
          </div>
        </details>

        <details>
          <summary>
            <div class="sum-left">
              <div class="ico"></div>
              <div>Rivalry
                <div class="meta">Head-to-head receipts</div>
              </div>
            </div>
            <div class="caret"></div>
          </summary>
          <div class="content">
            Compare two golfers properly. No selective memory. Just results.
          </div>
        </details>

      </div>
    </section>

    <div class="footer">
      Built for golf societies: easy inputs, clear outputs, maximum banter potential.<br/>
      Tip: send this guide to new members so everyone finds Replay + Teams + Improve tools quickly.
    </div>
  </main>

  <button class="fab" data-jump="#how" title="Start here">
    <span aria-hidden="true"></span><span style="font-size:12px;font-weight:900;letter-spacing:.02em;">Start here</span>
  </button>

  <script>
    // Smooth jump buttons
    document.querySelectorAll("[data-jump]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const sel = btn.getAttribute("data-jump");
        const el = document.querySelector(sel);
        if(!el) return;
        el.scrollIntoView({behavior:"smooth", block:"start"});
      });
    });

    // Rotate caret on open/close
    const syncCarets = () => {
      document.querySelectorAll("details").forEach(d=>{
        const caret = d.querySelector(".caret");
        if(!caret) return;
        caret.style.transform = d.open ? "rotate(180deg)" : "rotate(0deg)";
        caret.style.transition = "transform 160ms ease";
      });
    };
    document.querySelectorAll("details").forEach(d=>{
      d.addEventListener("toggle", syncCarets);
    });
    syncCarets();
  <\/script>
</body>
</html>
`}function mm({guideMode:e,setGuideMode:t}){return n.jsxs("div",{className:"mb-5",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Choose a mode"}),n.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[n.jsxs("button",{className:"guide-mode-card "+(e==="simple"?"active":""),onClick:()=>t("simple"),type:"button",children:[n.jsxs("div",{className:"gm-top",children:[n.jsx("div",{className:"gm-title",children:"Simple"}),n.jsx("span",{className:"gm-badge",children:"Fast start"})]}),n.jsx("div",{className:"gm-desc",children:"The essentials: what each menu item does, and how to get value immediately."})]}),n.jsxs("button",{className:"guide-mode-card "+(e==="deep"?"active":""),onClick:()=>t("deep"),type:"button",children:[n.jsxs("div",{className:"gm-top",children:[n.jsx("div",{className:"gm-title",children:"InDepth"}),n.jsx("span",{className:"gm-badge",children:"Full tour"})]}),n.jsx("div",{className:"gm-desc",children:"The full walkthrough (Improve tools, Replay & Teams) with the detailed guide embedded."})]})]}),n.jsxs("div",{className:"mt-2 text-xs text-neutral-500",children:["Youre picking ",n.jsx("span",{className:"font-black",children:e==="simple"?"Simple":"InDepth"})," mode."]})]})}function gN({setView:e,leagueTitle:t}){const[r,s]=ue.useState(()=>{try{return localStorage.getItem("denGuideMode")||"simple"}catch{return"simple"}});return ue.useEffect(()=>{try{localStorage.setItem("denGuideMode",r)}catch{}},[r]),r==="deep"?n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(on,{setView:e,title:"Guide"}),n.jsx(mm,{guideMode:r,setGuideMode:s}),n.jsx("div",{className:"rounded-2xl border border-squab-200 bg-white shadow-sm overflow-hidden",children:n.jsx("iframe",{title:`${t}  In-depth guide`,className:"w-full",style:{height:"78vh"},srcDoc:pN(t)})}),n.jsx("p",{className:"mt-3 text-xs text-neutral-500",children:"Tip: If youre on mobile, rotate to landscape for the broadcast feel on Replay & Teams."})]}):n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(on,{setView:e,title:"Guide"}),n.jsx(mm,{guideMode:r,setGuideMode:s}),n.jsxs("div",{className:"mb-4",children:[n.jsx("h2",{className:"text-lg md:text-xl font-extrabold text-squab-900",children:"What this app can do"}),n.jsx("p",{className:"text-sm text-neutral-600",children:"Explore any course and date in Game Explorer  and it builds leaderboards, player views, and reports automatically."})]}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-4 mb-5",children:[n.jsxs("div",{className:"rounded-2xl border border-squab-200 bg-white p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"chip",children:""}),n.jsx("h3",{className:"font-bold text-squab-900",children:"Quick start"})]}),n.jsxs("ol",{className:"list-decimal pl-5 text-sm text-neutral-700 space-y-1",children:[n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Game Explorer"}),"  choose a course + date to explore."]}),n.jsxs("li",{children:["Pick a view from ",n.jsx("span",{className:"font-semibold",children:" Menu"}),"."]}),n.jsx("li",{children:"(Optional) Further functions are available to the Admin/Captain."})]})]}),n.jsxs("div",{className:"rounded-2xl border border-squab-200 bg-white p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"chip",children:""}),n.jsx("h3",{className:"font-bold text-squab-900",children:"How to navigate"})]}),n.jsxs("ul",{className:"list-disc pl-5 text-sm text-neutral-700 space-y-1",children:[n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:" Menu"})," = everything (game + season + fun stuff)."]}),n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Home"})," returns to the main screen."]}),n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Guide"})," button (bottom-right) opens this page."]}),n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Tip"}),": in this Guide, click view names to jump straight to that screen."]})]})]})]}),n.jsxs("div",{className:"rounded-2xl border border-squab-200 bg-white p-4 md:p-5 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("span",{className:"chip",children:""}),n.jsx("h3",{className:"font-extrabold text-squab-900",children:"Everything it can do (by menu)"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-neutral-700",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-black uppercase tracking-wide text-neutral-500 mb-2",children:"Round views"}),n.jsxs("ul",{className:"space-y-1",children:[n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Game"}),"  round leaderboard + key totals."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Player Scorecard"}),"  per-hole ",n.jsx("span",{className:"font-semibold",children:"Gross"}),", Stableford, Yards, SI with player dropdown."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Graphs"}),"  charts for scoring / trends."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Course Stats"}),"  hole difficulty vs SI, par-type breakdowns."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Ratings"}),"  course/tee difficulty + performance splits."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"HeadtoHead"}),"  compare players."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Styles"}),"  style / pattern analysis views."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Story"}),"  narrative recap of the round."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Replay"}),"  step through the round / highlights."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Team Replay"}),"  team view / matchplaystyle replay."]})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-black uppercase tracking-wide text-neutral-500 mb-2",children:"Season + extras"}),n.jsxs("ul",{className:"space-y-1",children:[n.jsxs("li",{children:[" ",n.jsx("button",{type:"button",className:"link",onClick:()=>{e("player_progress"),window.scrollTo(0,0)},children:n.jsx("span",{className:"font-semibold",children:"Insights"})}),"  plain-English performance insights. Explains whats helping or hurting your score and highlights the quickest scoring gains (uses the same data as Player Progress)."]}),n.jsxs("li",{children:[" ",n.jsx("button",{type:"button",className:"link",onClick:()=>{e("player_progress"),window.scrollTo(0,0)},children:n.jsx("span",{className:"font-semibold",children:"Par Leaders"})}),"  league leaders by ",n.jsx("strong",{children:"All Pars"}),", ",n.jsx("strong",{children:"Par 3"}),", ",n.jsx("strong",{children:"Par 4"}),", and ",n.jsx("strong",{children:"Par 5"}),". Based on points/strokes per hole, with filters for Stableford or Gross."]}),n.jsxs("li",{children:[" ",n.jsx("button",{type:"button",className:"link",children:n.jsx("span",{className:"font-semibold",onClick:()=>{e("league"),window.scrollTo(0,0)},children:"League"})}),"  season standings and points totals."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Eclectic"}),"  best score on each hole across the season."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Analyse Game"}),"  pick a past game and deepdive."]}),n.jsxs("li",{children:[" ",n.jsx("button",{type:"button",className:"link",onClick:()=>{e("player_progress"),window.scrollTo(0,0)},children:n.jsx("span",{className:"font-semibold",children:"Player Progress"})}),"  analyse 1/5/10/20/30/ALL games for trends, volatility, and vs field comparisons."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Player Report"}),"  single-player report across 1/5/10/20/30/ALL games (spot patterns over time)."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Banter"}),"  fun / commentary view."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Partners"}),"  partner / duo views."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Rivalry"}),"  rivalry comparisons."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Casino"}),"  side games / gambling formats."]}),n.jsxs("li",{children:[" ",n.jsx("span",{className:"font-semibold",children:"Trophies"}),"  trophies / achievements."]})]})]})]})]})]})}function xN({setView:e}){return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(on,{setView:e,left:n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("button",{className:"btn-secondary",onClick:()=>e("player_progress"),children:" Back to Performance Mirror"}),n.jsx("button",{className:"btn-secondary",onClick:()=>e("home"),children:"Home"})]}),title:"How to read"}),n.jsxs("div",{className:"rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm",children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Performance Mirror"}),n.jsx("div",{className:"text-2xl md:text-3xl font-black text-neutral-900 mt-1",children:"What the numbers actually mean"}),n.jsx("div",{className:"text-sm text-neutral-600 mt-2",children:"Choose your options, then generate a fast, readable summary."})]}),n.jsxs("div",{className:"mt-5 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Player Progress"}),n.jsx("div",{className:"text-lg font-extrabold text-neutral-900",children:"Trends over time"}),n.jsxs("div",{className:"text-sm text-neutral-600 mt-1",children:["Uses your chosen window: ",n.jsx("span",{className:"font-semibold",children:"1 / 5 / 10 / 20 / 30 / All"})," games."]})]}),n.jsx("button",{className:"btn-secondary",onClick:()=>e("player_progress"),children:"Open"})]}),n.jsxs("div",{className:"mt-4 space-y-3 text-sm text-neutral-700",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Window (1/5/10/20/30/All)"}),n.jsx("div",{children:"How many recent games are included. Smaller windows show current form, larger ones show real trend."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Scoring mode"}),n.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Stableford"}),": higher is better."]}),n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Gross"}),": lower is better (strokes)."]})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Last round"}),n.jsx("div",{children:"Your most recent score in the selected mode (stableford points or gross strokes)."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Form / Trend ( / )"}),n.jsx("div",{children:"A quick direction of travel. It compares your recent chunk (up to the last 5 games) against the previous chunk. For gross, down is good (fewer strokes)  the arrow already accounts for that."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Consistency (Std Dev)"}),n.jsx("div",{children:"How swingy are your rounds? Lower = steadier. Higher = more up/down performances."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Vs Field / Vs Handicap band"}),n.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Vs Field"}),": compares you to the average of everyone in the same events."]}),n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Vs Handicap band"}),": compares you to players with similar handicaps (more fair)."]})]}),n.jsx("div",{className:"mt-1",children:"Positive in stableford = good. Positive in gross = also shown as good (because its inverted for readability)."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"The trend chart"}),n.jsx("div",{children:"Solid line = you. Faint line = field average. The horizontal guide lines give you a quick sense of scale."})]})]})]}),n.jsxs("div",{className:"rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-black tracking-widest uppercase text-neutral-400",children:"Player Report"}),n.jsx("div",{className:"text-lg font-extrabold text-neutral-900",children:"One player, explained"}),n.jsx("div",{className:"text-sm text-neutral-600 mt-1",children:"A singleplayer breakdown  either the latest round, or averages across a selected window."})]}),n.jsx("button",{className:"btn-secondary",onClick:()=>e("player_progress"),children:"Open"})]}),n.jsxs("div",{className:"mt-4 space-y-3 text-sm text-neutral-700",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Round vs Window"}),n.jsx("div",{children:"If youre looking at the latest round, youll see holebyhole. If youre in window mode, youll see averages per hole across the selected games."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Hole Map"}),n.jsx("div",{children:"Each box is a hole. The number is points. Darker usually means a better result. If you see NDB, that hole was adjusted (made up for completeness, WHS-style)."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Round Highlights"}),n.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Bounce-back"}),": best improvement from one hole to the next."]}),n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Hot stretch"}),": best 3hole run."]}),n.jsxs("li",{children:[n.jsx("span",{className:"font-semibold",children:"Biggest leak (worst hole)"}),": the hole that cost you the most points."]})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Graph"}),n.jsx("div",{children:"Shows the score moving gametogame (or holetohole depending on the view). The faint horizontal lines are there so you can read the up/down properly."})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"Missing holes & WHS adjustment (NDB)"}),n.jsxs("div",{children:["If a hole is missing but the round exists, we fill it as ",n.jsx("span",{className:"font-semibold",children:"Net Double Bogey"})," for completeness (WHS style) and mark it",n.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-black border border-amber-300 bg-amber-100 text-amber-900 ml-2",children:"NDB"}),". That prevents 17 holes looking like an 18hole 78 and keeps averages fair."]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-neutral-900",children:"9 holes vs 18 holes"}),n.jsx("div",{children:"If nobody recorded holes 1018, the app treats it as a 9hole round and only analyses the front 9. (So finish stats use holes 69 for 9holers.)"})]})]})]})]}),n.jsxs("div",{className:"mt-6 rounded-3xl border border-neutral-200 bg-white p-5 shadow-sm",children:[n.jsx("div",{className:"text-sm font-black text-neutral-900",children:"Quick tips"}),n.jsxs("ul",{className:"mt-2 text-sm text-neutral-700 list-disc ml-5 space-y-1",children:[n.jsx("li",{children:"If something looks too good to be true, check whether the round had missing holes before adjustment."}),n.jsx("li",{children:"Use small windows (5/10) for form, and larger windows (20/30/All) for genuine trend."}),n.jsx("li",{children:"Vs Field answers how did I do compared to everyone today? while Vs Handicap band answers how did I do compared to my peers?"})]})]})]})}function bN(e){const[t,r]=Q.useState("home"),[s,i]=Q.useState(0),[a,o]=Q.useState(null),[c,l]=Q.useState("");try{if(typeof window<"u"&&typeof sessionStorage<"u"){const g=sessionStorage.getItem("dsl_active_society_id")||"",j=sessionStorage.getItem("dsl_active_society_slug")||"",_=sessionStorage.getItem("dsl_active_society_name")||"";g&&!window.__activeSocietyId&&(window.__activeSocietyId=g),j&&!window.__activeSocietySlug&&(window.__activeSocietySlug=j),_&&!window.__activeSocietyName&&(window.__activeSocietyName=_)}}catch{}Q.useEffect(()=>{try{if(typeof window>"u")return;const g=String(kw()||"").trim();if(!g)return;const j=String(window.__activeSocietySlug||"").trim(),_=String(window.__activeSocietyId||"").trim();if(j===g&&_)return;(async()=>{try{const S=typeof window<"u"&&window.__supabase_client__?window.__supabase_client__:pd(le,J,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});typeof window<"u"&&(window.__supabase_client__=S);const{data:P,error:k}=await S.from("societies_public").select("id,name,slug").eq("slug",g).limit(1).maybeSingle();if(k)throw k;if(P&&P.id){window.__activeSocietyId=P.id,window.__activeSocietySlug=P.slug||g,window.__activeSocietyName=P.name||P.slug||g,window.__activeSocietyRole="";try{sessionStorage.setItem("dsl_active_society_id",P.id),sessionStorage.setItem("dsl_active_society_slug",P.slug||g),sessionStorage.setItem("dsl_active_society_name",P.name||"")}catch{}i(I=>I+1)}}catch(S){console.warn("Society bootstrap failed:",S)}})()}catch{}},[]);const u=e||{},d=(()=>{try{const g=String(u.activeSocietyId||(typeof window<"u"?window.__activeSocietyId:"")||"").trim(),j=String(u.activeSocietySlug||(typeof window<"u"?window.__activeSocietySlug:"")||"den-society").trim(),_=String(u.activeSocietyName||(typeof window<"u"?window.__activeSocietyName:"")||"").trim(),S=String(u.activeSocietyRole||(typeof window<"u"?window.__activeSocietyRole:"")||"").trim();return{id:g,slug:j,name:_,role:S}}catch{return{id:"",slug:"den-society",name:"",role:""}}})(),x=d.id,h=d.slug||"den-society";Wi=d.name||h,ll=Wi;const p=h==="winter-league",y="den-events",w=x?`societies/${x}/events`:"societies/UNKNOWN/events",N=p?"winter":"season";Q.useEffect(()=>{const g=_=>{const S=_==="pointsField"||_==="strokesField"||_==="strokesPar"?_:"pointsField",P=document.documentElement;if(!P||!P.style)return;let k="#7c3aed",I="124,58,237";S==="strokesField"&&(k="#2563eb",I="37,99,235"),S==="strokesPar"&&(k="#f97316",I="249,115,22"),P.style.setProperty("--mode-accent",k),P.style.setProperty("--mode-accent-rgb",I),P.style.setProperty("--mode-accent-soft",`rgba(${I}, 0.12)`),P.style.setProperty("--mode-accent-soft2",`rgba(${I}, 0.20)`)},j=()=>{try{g(localStorage.getItem("dsl_lens")||"pointsField")}catch{g("pointsField")}};return j(),window.addEventListener("dsl_lens_change",j),window.addEventListener("storage",j),()=>{window.removeEventListener("dsl_lens_change",j),window.removeEventListener("storage",j)}},[]);const[f,m]=Q.useState(""),[v,E]=Q.useState(!1),[C,T]=Q.useState(!1),[B,Y]=Q.useState(null),le=`https://mqknahdfpqxrpgpxqtus.supabase.co
`,J=`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1xa25haGRmcHF4cnBncHhxdHVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NTU3MDYsImV4cCI6MjA3ODAzMTcwNn0.GTUVsrRJ-MClMg96vuHZpUtAnUFtCsJvuLiiE0D-fCc
`,De="standings",nt="den_admin_pw_ok_v1",Ke=typeof window<"u"&&window.DEN_ADMIN_PASSWORD?String(window.DEN_ADMIN_PASSWORD):"Den Society League",He="den_hidden_players_v1",Ze=w?`${w}/admin/player_visibility.json`:"admin/player_visibility.json",[ce,$]=Q.useState(null),[R,U]=Q.useState("Connecting..."),[D,A]=Q.useState([]),[W,Fe]=Q.useState(null),[de,oe]=Q.useState([]),[xe,Ye]=Q.useState("All"),[O,ht]=Q.useState("All"),[Re,ne]=Q.useState(""),[Ue,q]=Q.useState([]),[L,X]=Q.useState("All"),[fe,Ee]=ue.useState(!1),[F,G]=ue.useState(()=>{try{return localStorage.getItem("den_reportNextHcapMode_v1")||"whs"}catch{return"whs"}});ue.useEffect(()=>{try{localStorage.setItem("den_reportNextHcapMode_v1",F)}catch{}},[F]);const[H,Ne]=Q.useState(null),[ae,ye]=Q.useState(()=>{try{const g=localStorage.getItem(He),j=g?JSON.parse(g):[];return Array.isArray(j)?j.filter(Boolean):[]}catch{return[]}}),Te=ue.useMemo(()=>new Set((ae||[]).filter(Boolean)),[ae]),[et,Z]=Q.useState(!1),[ze,it]=Q.useState(!1),[ee,ft]=Q.useState(()=>{try{return localStorage.getItem(nt)==="1"}catch{return!1}}),Rt=ue.useCallback(()=>{if(!B){bt("Sign in first");return}ee?Z(!0):it(!0)},[B,ee]),rr=ue.useCallback(g=>{if(!(String(g||"")===Ke)){bt("Wrong password");return}ft(!0);try{localStorage.setItem(nt,"1")}catch{}it(!1),Z(!0),bt("Admin unlocked ")},[]);Q.useEffect(()=>{try{const g=Array.from(document.querySelectorAll("[data-reveal]"));if(!g.length)return;const j=new IntersectionObserver(_=>{_.forEach(S=>{S.isIntersecting&&(S.target.classList.add("is-revealed"),j.unobserve(S.target))})},{threshold:.12});return g.forEach(_=>{_.classList.add("reveal"),j.observe(_)}),()=>j.disconnect()}catch{}},[t,W]);const Fr=ue.useMemo(()=>{const g=(Ue||[]).map(j=>String(j.season_id)).filter(Boolean);return Array.from(new Set(g)).sort((j,_)=>_.localeCompare(j))},[Ue]);function Gt(g,j,_){let S=Array.isArray(g)?g.slice():[];S.sort((k,I)=>{var K,M;const z=Number.isFinite(Number(k==null?void 0:k.dateMs))?Number(k.dateMs):Number.isFinite(Number((K=k==null?void 0:k.parsed)==null?void 0:K.dateMs))?Number(k.parsed.dateMs):k!=null&&k.date?cr(k.date):Number.POSITIVE_INFINITY,V=Number.isFinite(Number(I==null?void 0:I.dateMs))?Number(I.dateMs):Number.isFinite(Number((M=I==null?void 0:I.parsed)==null?void 0:M.dateMs))?Number(I.parsed.dateMs):I!=null&&I.date?cr(I.date):Number.POSITIVE_INFINITY;return z!==V?z-V:String((k==null?void 0:k.file)||"").localeCompare(String((I==null?void 0:I.file)||""))});const P=k=>{var V;const I=k==null?void 0:k.seasonId;if(I!=null&&String(I).trim()!=="")return String(I);const z=Number.isFinite(Number(k==null?void 0:k.dateMs))?Number(k.dateMs):Number.isFinite(Number((V=k==null?void 0:k.parsed)==null?void 0:V.dateMs))?Number(k.parsed.dateMs):k!=null&&k.date?cr(k.date):NaN;if(Number.isFinite(z)){try{const K=Do(z,Ue);if(K!=null&&String(K).trim()!=="")return String(K)}catch{}try{return String(new Date(z).getFullYear())}catch{return""}}return""};if(j&&j!=="All"&&(S=S.filter(k=>P(k)===String(j))),_&&_!=="All"){const k=Number(_);Number.isFinite(k)&&k>0&&S.length>k&&(S=S.slice(S.length-k))}return S}ue.useEffect(()=>{var S;if(!de||!de.length)return;const g=Gt(de,xe,L),j=It(g);Ne(j);try{typeof window<"u"&&(window.__seasonModelAll=j)}catch{}const _=It(g,{hiddenKeys:Te});Fe(_);try{typeof window<"u"&&(window.__seasonModel=_)}catch{}try{typeof window<"u"&&(window.__dslUiState={seasonYear:xe,seasonLimit:L})}catch{}(S=_==null?void 0:_.players)!=null&&S.length&&(Fs&&_.players.some(k=>k.name===Fs)||un(_.players[0].name))},[de,xe,L,ae]);const Wt=ue.useMemo(()=>Gt(Array.isArray(de)?de:[],xe,L),[de,xe,L]),qr=ue.useMemo(()=>Gt(Array.isArray(de)?de:[],xe,"All"),[de,xe]),[Ut,ns]=Q.useState(!1);ue.useEffect(()=>{try{t==="event"&&(!Array.isArray(de)||de.length===0)&&!Ut&&bs({afterView:"event"})}catch{}},[t,de,Ut]);const[Eo,xs]=Q.useState({done:0,total:0}),[Gr,$n]=Q.useState(""),[Fs,un]=Q.useState(""),[dn,hi]=Q.useState("stableford"),[Mn,fa]=Q.useState("par"),[fi,Is]=Q.useState({processed:[],skipped:[]});function zs(g){return Number.isFinite(g)?g<150?"<150":g<=200?"150200":g<=350?"201350":g<=420?"351420":"420+":"Unknown"}function at(g){return Number.isFinite(g)?g<=6?"16":g<=12?"712":"1318":"Unknown"}function Ge(){return{holes:0,pts:0,wipes:0,p0:0,p1:0,p2:0,p3:0,p4:0,p5:0}}function lt(g,j){g.holes+=1,g.pts+=j,j===0&&(g.wipes+=1);const _=Math.max(0,Math.min(5,Math.round(Number(j||0))));_===0?g.p0+=1:_===1?g.p1+=1:_===2?g.p2+=1:_===3?g.p3+=1:_===4?g.p4+=1:g.p5+=1}function Ie(){return{holes:0,val:0,sumSq:0,bogeyPlus:0,parOrBetter:0,birdieOrBetter:0,doublePlus:0,eaglePlus:0,birdies:0,pars:0,bogeys:0,doubles:0,triplesPlus:0}}function Xe(g,j){const _=Number(j);Number.isFinite(_)&&(g.holes+=1,g.val+=_,g.sumSq+=_*_,_>=1&&(g.bogeyPlus+=1),_<=0&&(g.parOrBetter+=1),_<=-1&&(g.birdieOrBetter+=1),_<=-2?g.eaglePlus+=1:_===-1?g.birdies+=1:_===0?g.pars+=1:_===1?g.bogeys+=1:_===2?g.doubles+=1:_>=3&&(g.triplesPlus+=1))}function Je(g,j=NaN){if(g==null||typeof g=="string"&&g.trim()==="")return j;const _=Number(g);return Number.isFinite(_)?_:j}function Nt(g,j){const S=(g.teeLabel||g.tee||g.tee_name||"").toString().trim().toLowerCase();if(S&&Array.isArray(j)){const P=j.find(I=>(I.teeName||I.name||I.label||"").toString().trim().toLowerCase()===S);if(P)return P;const k=j.find(I=>{const z=(I.teeName||I.name||I.label||"").toString().trim().toLowerCase();return z&&(z.includes(S)||S.includes(z))});if(k)return k}return Array.isArray(j)&&j.length?j[0]:null}function It(g,j){var me,Oe,ct,Pt,dr,Or,Vt,Dr,yr,kr,ut,$r,mt,ws,Ws,hr,Tt,xt,fr;function S(we){const ve=String(we||"");let pe=ve.match(/(20\d{2})[-_\.](0?[1-9]|1[0-2])[-_\.](0?[1-9]|[12]\d|3[01])/);if(pe){const $e=Number(pe[1]),be=Number(pe[2]),tt=Number(pe[3]),rt=Date.UTC($e,be-1,tt);return Number.isFinite(rt)?rt:null}if(pe=ve.match(/(0?[1-9]|[12]\d|3[01])[-_\.](0?[1-9]|1[0-2])[-_\.](20\d{2})/),pe){const $e=Number(pe[1]),be=Number(pe[2]),tt=Number(pe[3]),rt=Date.UTC(tt,be-1,$e);return Number.isFinite(rt)?rt:null}return null}function P(we){const ve=we.length;if(!ve)return NaN;let pe=0;for(const $e of we)pe+=Number($e);return pe/ve}function k(we){const ve=we.length;if(ve<2)return NaN;const pe=P(we);let $e=0;for(const be of we){const tt=Number(be)-pe;$e+=tt*tt}return Math.sqrt($e/(ve-1))}function I(we,ve){const pe=Math.min(we.length,ve.length);if(pe<2)return NaN;let $e=0,be=0,tt=0,rt=0;for(let wt=0;wt<pe;wt++){const je=Number(we[wt]),zt=Number(ve[wt]);$e+=je,be+=zt,tt+=je*je,rt+=je*zt}const os=pe*tt-$e*$e;return os?(pe*rt-$e*be)/os:NaN}function z(we,ve){const pe=Ot(we);if(!pe)return"";if(ve[pe])return pe;let $e="",be=1/0;for(const tt of Object.keys(ve)){if(!um(pe,tt))continue;const rt=_l(pe,tt);rt<be&&(be=rt,$e=tt)}return $e||pe}function V(we,ve){if(!we||ve==null)return;const pe=String(ve);pe&&(we.includes(pe)||we.push(pe))}const K={},M={totals:Ge(),totalsGross:Ie(),totalsNet:Ie(),byPar:{"Par 3":Ge(),"Par 4":Ge(),"Par 5":Ge(),Unknown:Ge()},byParGross:{"Par 3":Ie(),"Par 4":Ie(),"Par 5":Ie(),Unknown:Ie()},byParYards:{"Par 3":{},"Par 4":{},"Par 5":{},Unknown:{}},byParYardsGross:{"Par 3":{},"Par 4":{},"Par 5":{},Unknown:{}},byYards:{},byYardsGross:{},bySI:{"16":Ge(),"712":Ge(),"1318":Ge(),Unknown:Ge()},bySIGross:{"16":Ie(),"712":Ie(),"1318":Ie(),Unknown:Ie()}},re={};let ge=0;const ie=j&&j.hiddenKeys instanceof Set?j.hiddenKeys:null;for(const we of g){const ve=we.file||`round_${ge}`,pe=[],$e=[],be=we.parsed||{},tt=Number.isFinite(be.dateMs)&&Number(be.dateMs)>0?Number(be.dateMs):S(ve),rt=be.players||[],os=be.courseTees||[],wt=(()=>{try{const je=(rt||[]).filter(Ce=>!Yt(Ce==null?void 0:Ce.name)).map((Ce,vt)=>({idx:vt,name:String((Ce==null?void 0:Ce.name)||"").trim(),points:Number((Ce==null?void 0:Ce.points)??(Ce==null?void 0:Ce.pts)??NaN),back9:Number((Ce==null?void 0:Ce.back9)??0),perHole:Array.isArray(Ce==null?void 0:Ce.perHole)?Ce.perHole.slice(0,18):[]})).filter(Ce=>Ce.name&&Number.isFinite(Ce.points));if(!je.length)return new Set;const zt=je.slice().sort((Ce,vt)=>vt.points-Ce.points||as(Ce,vt)),Vr=zt[0].points,se=zt.filter(Ce=>Ce.points===Vr);let Er=se.length?[se[0]]:[];for(let Ce=1;Ce<se.length;Ce++){const vt=as(se[Ce],Er[0]);vt>0?Er=[se[Ce]]:vt===0&&Er.push(se[Ce])}return new Set(Er.map(Ce=>String(Ce.name).trim()))}catch{return new Set}})();for(const je of rt){const zt=je.name||"",Vr=z(zt,K);if(ie&&ie.has(Vr)||!zt)continue;const se=Nt(je,os)||{pars:Array(18).fill(NaN),yards:Array(18).fill(NaN),si:Array(18).fill(NaN)},Er=Array.isArray(je.perHole)?je.perHole:Array(18).fill(0),Ce=Array.isArray(se.pars)?se.pars:Array(18).fill(NaN),vt=Array.isArray(se.yards)?se.yards:Array(18).fill(NaN),vr=Array.isArray(se.si)?se.si:Array(18).fill(NaN),Be=K[Vr]||(K[Vr]={name:String(zt).replace(/\u00A0/g," ").replace(/\s+/g," ").trim(),rounds:0,files:[],totals:Ge(),totalsGross:Ie(),totalsNet:Ie(),byPar:{"Par 3":Ge(),"Par 4":Ge(),"Par 5":Ge(),Unknown:Ge()},byParGross:{"Par 3":Ie(),"Par 4":Ie(),"Par 5":Ie(),Unknown:Ie()},byParYards:{"Par 3":{},"Par 4":{},"Par 5":{},Unknown:{}},byParYardsGross:{"Par 3":{},"Par 4":{},"Par 5":{},Unknown:{}},byYards:{},byYardsGross:{},bySI:{"16":Ge(),"712":Ge(),"1318":Ge(),Unknown:Ge()},bySIGross:{"16":Ie(),"712":Ie(),"1318":Ie(),Unknown:Ie()},diag:{holesMissing:{par:0,si:0,yards:0},missingHoles:{par:[],si:[],yards:[]},teeLabelsSeen:[],teesMatched:[],issuesByFile:{}}});Be.rounds+=1;const Hn=String(zt).replace(/\u00A0/g," ").replace(/\s+/g," ").trim();Hn&&(!Be.name||Hn.length>Be.name.length)&&(Be.name=Hn),we.file&&!Be.files.includes(we.file)&&Be.files.push(we.file);const Mo=(je.teeLabel||je.tee||je.tee_name||"").toString().trim()||"(blank)",Pr=((se==null?void 0:se.teeName)||(se==null?void 0:se.name)||(se==null?void 0:se.label)||"(fallback/unknown)").toString().trim();V(Be.diag.teeLabelsSeen,Mo),V(Be.diag.teesMatched,Pr);const zn=we.file||"(unknown file)";Be.diag.issuesByFile[zn]||(Be.diag.issuesByFile[zn]={teeLabel:Mo,teeMatched:Pr,par:[],si:[],yards:[]});const qn=Array.isArray(Er)?Er:[],ja=qn.reduce((ke,Pe)=>ke+Je(Pe,0),0),Lo=qn.slice(0,9).reduce((ke,Pe)=>ke+Je(Pe,0),0),_a=qn.slice(9,18).reduce((ke,Pe)=>ke+Je(Pe,0),0),vi=Math.round(Je(je.playingHcap??je.startExact??je.handicap??je.hcap??NaN,NaN)),mn=Array.isArray(je.grossPerHole)?je.grossPerHole:null,Vs=Array.from({length:18},(ke,Pe)=>{const ar=Je(qn[Pe],NaN),Mr=mn?Je(mn[Pe],NaN):NaN;return Number.isFinite(ar)||Number.isFinite(Mr)&&Mr>0}),dt=mn?mn.map((ke,Pe)=>{if(!Vs[Pe])return NaN;const ar=Number(Ce[Pe]),Mr=Number(vr[Pe]);let _c=0;if(Number.isFinite(vi)&&Number.isFinite(Mr)){const Ns=Math.floor(vi/18),ka=vi%18;_c=Ns+(ka>=Mr?1:0)}return Number.isFinite(ke)&&ke>0?ke:Number.isFinite(ar)?ar+_c+2:NaN}):null,Uo=mn?mn.map((ke,Pe)=>Vs[Pe]&&!(Number.isFinite(ke)&&ke>0)):null,jc=Vs.filter(Boolean).length,Sa=dt?dt.some((ke,Pe)=>Vs[Pe]&&!Number.isFinite(ke))?NaN:dt.reduce((ke,Pe)=>ke+(Number.isFinite(Pe)?Pe:0),0):NaN,qe=dt?dt.slice(0,9).some((ke,Pe)=>Vs[Pe]&&!Number.isFinite(ke))?NaN:dt.slice(0,9).reduce((ke,Pe)=>ke+(Number.isFinite(Pe)?Pe:0),0):NaN,pt=dt?dt.slice(9,18).some((ke,Pe)=>Vs[Pe+9]&&!Number.isFinite(ke))?NaN:dt.slice(9,18).reduce((ke,Pe)=>ke+(Number.isFinite(Pe)?Pe:0),0):NaN,Kr=Array.isArray(Ce)?Ce.reduce((ke,Pe,ar)=>ke+(Vs[ar]?Je(Pe,0):0),0):NaN;if(dt&&Array.isArray(Ce)){const ke=Be._parTypeAgg||(Be._parTypeAgg={3:{over:0,n:0},4:{over:0,n:0},5:{over:0,n:0}});for(let Pe=0;Pe<18;Pe++){const ar=Je(Ce[Pe],NaN),Mr=Je(dt[Pe],NaN);!Number.isFinite(ar)||!Number.isFinite(Mr)||(ar===3||ar===4||ar===5)&&(ke[ar].over+=Mr-ar,ke[ar].n+=1)}}(Be.series||(Be.series=[])).push({file:ve,isWinner:wt.has(String(zt||"").trim()),idx:ge,dateMs:tt,courseName:((be==null?void 0:be.courseName)||(be==null?void 0:be.internalCourseName)||(be==null?void 0:be.course)||"").toString(),teeName:((se==null?void 0:se.teeName)||(se==null?void 0:se.name)||(se==null?void 0:se.label)||"").toString(),teeGender:((se==null?void 0:se.gender)||(je==null?void 0:je.gender)||"M").toString(),teeLabel:((je==null?void 0:je.teeLabel)||(je==null?void 0:je.tee)||(je==null?void 0:je.tee_name)||"").toString(),teeSlope:Je((se==null?void 0:se.slope)??(se==null?void 0:se.Slope)??(se==null?void 0:se.slopeRating)??(be==null?void 0:be.courseSlope)??(be==null?void 0:be.slope)??NaN,NaN),teeRating:Je((se==null?void 0:se.rating)??(se==null?void 0:se.courseRating)??(be==null?void 0:be.courseRating)??(be==null?void 0:be.rating)??NaN,NaN),slope:Je((se==null?void 0:se.slope)??(se==null?void 0:se.slopeRating)??(be==null?void 0:be.courseSlope)??(be==null?void 0:be.slope)??NaN,NaN),rating:Je((se==null?void 0:se.rating)??(se==null?void 0:se.courseRating)??(be==null?void 0:be.courseRating)??(be==null?void 0:be.rating)??NaN,NaN),parsPerHole:Array.isArray(se==null?void 0:se.pars)?se.pars.slice(0,18):Array.isArray(se==null?void 0:se.par)?se.par.slice(0,18):[],siPerHole:Array.isArray(se==null?void 0:se.si)?se.si.slice(0,18):Array.isArray(se==null?void 0:se.SI)?se.SI.slice(0,18):[],startExact:Je(je.handicap??je.startExact??je.handicapIndex??je.hcap??je.hi??NaN,NaN),gender:((je==null?void 0:je.gender)||(se==null?void 0:se.gender)||"M").toString(),perHole:qn.slice(0,18),parsArr:Ce.slice(0,18),siArr:vr.slice(0,18),yardsArr:Array.isArray(vt)?vt.slice(0,18):[],pts:ja,frontPts:Lo,backPts:_a,hcap:vi,gross:Sa,grossPerHole:dt?dt.slice(0,18):Array(18).fill(NaN),imputedGrossPerHole:dt?dt.slice(0,18):Array(18).fill(NaN),imputedMask:Uo?Uo.slice(0,18):null,frontGross:qe,backGross:pt,parTotal:Kr,holesPlayed:jc}),pe.push(ja),Number.isFinite(Sa)&&$e.push(Sa);for(let ke=0;ke<18;ke++){const Pe=Je(Er[ke],NaN),ar=Array.isArray(je.grossPerHole)?je.grossPerHole:Array(18).fill(NaN),Mr=Je(ar[ke],NaN);if(!(Number.isFinite(Pe)||Number.isFinite(Mr)&&Mr>0))continue;Number.isFinite(Pe)&&(lt(Be.totals,Pe),lt(M.totals,Pe));const Ns=Je(Ce[ke],NaN),ka=Je(je.playingHcap??je.startExact??je.handicap??je.hcap??NaN,NaN),bh=Je(vr[ke],NaN);let yh=0;if(Number.isFinite(ka)&&Number.isFinite(bh)){const sg=Math.floor(ka/18),ng=ka%18;yh=sg+(ng>=bh?1:0)}const Sc=Mr,vh=Number.isFinite(Sc)&&Sc>0?Sc:NaN,ls=Number.isFinite(vh)&&Number.isFinite(Ns)?vh-Ns:NaN;Xe(Be.totalsGross,ls),Xe(M.totalsGross,ls);const wh=Number.isFinite(ls)?ls-yh:NaN;Xe(Be.totalsNet,wh),Xe(M.totalsNet,wh);const gt=Ns===3?"Par 3":Ns===4?"Par 4":Ns===5?"Par 5":"Unknown";(!Number.isFinite(Ns)||!(Ns===3||Ns===4||Ns===5))&&(Be.diag.holesMissing.par+=1,Be.diag.missingHoles.par.push(ke+1),Be.diag.issuesByFile[zn].par.push(ke+1)),Number.isFinite(Pe)&&(lt(Be.byPar[gt],Pe),lt(M.byPar[gt],Pe)),(me=Be.byParGross)[gt]||(me[gt]=Ie()),(Oe=M.byParGross)[gt]||(Oe[gt]=Ie()),Xe(Be.byParGross[gt],ls),Xe(M.byParGross[gt],ls);const ot=zs(Je(vt[ke],NaN)),tg=Je(vt[ke],NaN);Number.isFinite(tg)||(Be.diag.holesMissing.yards+=1,Be.diag.missingHoles.yards.push(ke+1),Be.diag.issuesByFile[zn].yards.push(ke+1)),(ct=Be.byParYards)[gt]||(ct[gt]={}),(Pt=M.byParYards)[gt]||(Pt[gt]={}),(dr=Be.byParYards[gt])[ot]||(dr[ot]=Ge()),(Or=M.byParYards[gt])[ot]||(Or[ot]=Ge()),Number.isFinite(Pe)&&(lt(Be.byParYards[gt][ot],Pe),lt(M.byParYards[gt][ot],Pe)),(Vt=Be.byParYardsGross)[gt]||(Vt[gt]={}),(Dr=M.byParYardsGross)[gt]||(Dr[gt]={}),(yr=Be.byParYardsGross[gt])[ot]||(yr[ot]=Ie()),(kr=M.byParYardsGross[gt])[ot]||(kr[ot]=Ie()),Xe(Be.byParYardsGross[gt][ot],ls),Xe(M.byParYardsGross[gt][ot],ls),(ut=Be.byYards)[ot]||(ut[ot]=Ge()),($r=M.byYards)[ot]||($r[ot]=Ge()),Number.isFinite(Pe)&&(lt(Be.byYards[ot],Pe),lt(M.byYards[ot],Pe)),(mt=Be.byYardsGross)[ot]||(mt[ot]=Ie()),(ws=M.byYardsGross)[ot]||(ws[ot]=Ie()),Xe(Be.byYardsGross[ot],ls),Xe(M.byYardsGross[ot],ls);const wr=at(Je(vr[ke],NaN)),rg=Je(vr[ke],NaN);Number.isFinite(rg)||(Be.diag.holesMissing.si+=1,Be.diag.missingHoles.si.push(ke+1),Be.diag.issuesByFile[zn].si.push(ke+1)),(Ws=Be.bySI)[wr]||(Ws[wr]=Ge()),(hr=M.bySI)[wr]||(hr[wr]=Ge()),lt(Be.bySI[wr],Pe),lt(M.bySI[wr],Pe),(Tt=Be.bySIGross)[wr]||(Tt[wr]=Ie()),(xt=M.bySIGross)[wr]||(xt[wr]=Ie()),Xe(Be.bySIGross[wr],ls),Xe(M.bySIGross[wr],ls)}if(pe.length){const ke=P(pe),Pe=k(pe),ar=$e.length?P($e):NaN,Mr=$e.length?k($e):NaN;re[ve]={mean:ke,sd:Pe,meanGross:ar,sdGross:Mr,n:pe.length,dateMs:tt}}else re[ve]={mean:NaN,sd:NaN,meanGross:NaN,sdGross:NaN,n:0,dateMs:tt};ge+=1}}for(const we of Object.keys(K)){const ve=(fr=K[we])==null?void 0:fr.diag;if(!ve)continue;const pe=$e=>Array.from(new Set($e.map(Number).filter(be=>Number.isFinite(be)))).sort((be,tt)=>be-tt);ve.missingHoles.par=pe(ve.missingHoles.par),ve.missingHoles.si=pe(ve.missingHoles.si),ve.missingHoles.yards=pe(ve.missingHoles.yards),ve.teeLabelsSeen=Array.from(new Set((ve.teeLabelsSeen||[]).map(String))),ve.teesMatched=Array.from(new Set((ve.teesMatched||[]).map(String)));for(const $e of Object.keys(ve.issuesByFile||{})){const be=ve.issuesByFile[$e];be.par=pe(be.par||[]),be.si=pe(be.si||[]),be.yards=pe(be.yards||[])}}function he(we){return we.holes?we.pts/we.holes:0}function Se(we){return we.holes?we.wipes/we.holes:0}return{players:Object.values(K).map(we=>{const ve={...we,deltas:{totals:{},byPar:{},byYards:{},bySI:{}},metrics:{}},pe=Array.isArray(we.series)?we.series.slice():[];pe.sort((qe,pt)=>{const Kr=Number.isFinite(qe.dateMs)&&Number(qe.dateMs)>0?Number(qe.dateMs):Number(qe.idx||0),ke=Number.isFinite(pt.dateMs)&&Number(pt.dateMs)>0?Number(pt.dateMs):Number(pt.idx||0);return Kr-ke});const $e=pe.map(qe=>Number(qe.pts)).filter(Number.isFinite),be=pe.map(qe=>Number(qe.frontPts)).filter(Number.isFinite),tt=pe.map(qe=>Number(qe.backPts)).filter(Number.isFinite),rt=pe.map(qe=>Number(qe.hcap)).filter(Number.isFinite),os=k($e),wt=pe.map((qe,pt)=>Number.isFinite(qe.dateMs)?qe.dateMs/864e5:pt),je=pe.map(qe=>Number(qe.pts)),zt=I(wt,je),Vr=$e.slice(0,3),se=$e.slice(-3),Er=Vr.length?P(se)-P(Vr):NaN,Ce=be.length&&tt.length?P(tt)-P(be):NaN,vt=$e.length?P($e)-36:NaN,vr=rt.length?P(rt):NaN;let Be=0,Hn=0;for(const qe of pe){const pt=re[qe.file]||null;if(!pt||!Number.isFinite(pt.mean)||!Number.isFinite(pt.sd)||pt.sd<=0)continue;const Kr=(Number(qe.pts)-pt.mean)/pt.sd;Number.isFinite(Kr)&&(Be+=Kr,Hn+=1)}const Mo=Hn?Be/Hn:NaN,Pr=pe.map(qe=>Number(qe.gross)).filter(Number.isFinite),zn=Pr.length>=2?k(Pr):NaN,qn=Pr.length>=4?P(Pr.slice(0,Math.min(3,Pr.length)))-P(Pr.slice(Math.max(0,Pr.length-3))):NaN;let ja=NaN;if(Pr.length>=2){const qe=pe.map((ke,Pe)=>Number.isFinite(ke.dateMs)?Number(ke.dateMs)/864e5:Pe),pt=pe.map(ke=>Number(ke.gross)),Kr=qe.map((ke,Pe)=>({x:ke,y:pt[Pe]})).filter(ke=>Number.isFinite(ke.x)&&Number.isFinite(ke.y));if(Kr.length>=2){const ke=I(Kr.map(Pe=>Pe.x),Kr.map(Pe=>Pe.y));ja=Number.isFinite(ke)?-ke:NaN}}let Lo=0,_a=0;for(const qe of pe){const pt=re[qe.file]||null;if(!pt||!Number.isFinite(pt.meanGross)||!Number.isFinite(pt.sdGross)||pt.sdGross<=0)continue;const Kr=(pt.meanGross-Number(qe.gross))/pt.sdGross;Number.isFinite(Kr)&&(Lo+=Kr,_a+=1)}const vi=_a?Lo/_a:NaN,mn=Pr.length?P(Pr):NaN,Vs=Pr.length?Math.min(...Pr):NaN,dt=ve._parTypeAgg||null,Uo=dt&&dt[3]&&dt[3].n?dt[3].over/dt[3].n:NaN,jc=dt&&dt[4]&&dt[4].n?dt[4].over/dt[4].n:NaN,Sa=dt&&dt[5]&&dt[5].n?dt[5].over/dt[5].n:NaN;ve.metrics={rounds:pe.length,volPts:os,velocity:zt,trend3:Er,fb:Ce,avgDelta36:vt,avgHcap:vr,ctxZ:Mo,volGross:zn,grossVelocity:ja,grossTrend3:qn,ctxZG:vi,avgGross:mn,minGross:Vs,par3SOPH:Uo,par4SOPH:jc,par5SOPH:Sa},ve.deltas.totals={avgPts:he(we.totals)-he(M.totals),wipeRate:Se(we.totals)-Se(M.totals)};for(const qe of Object.keys(we.byPar))ve.deltas.byPar[qe]={avgPts:he(we.byPar[qe])-he(M.byPar[qe]),wipeRate:Se(we.byPar[qe])-Se(M.byPar[qe])};for(const qe of Object.keys(we.byYards)){const pt=M.byYards[qe]||Ge();ve.deltas.byYards[qe]={avgPts:he(we.byYards[qe])-he(pt),wipeRate:Se(we.byYards[qe])-Se(pt)}}for(const qe of Object.keys(we.bySI)){const pt=M.bySI[qe]||Ge();ve.deltas.bySI[qe]={avgPts:he(we.bySI[qe])-he(pt),wipeRate:Se(we.bySI[qe])-Se(pt)}}return ve}).sort((we,ve)=>we.name.localeCompare(ve.name)),field:M}}function cr(g){const j=Number(g);if(Number.isFinite(j)&&j>0)return j;const _=String(g??"").trim();if(!_)return NaN;let S=_.match(/\b(20\d{2})[-\/\.](0?[1-9]|1[0-2])[-\/\.](0?[1-9]|[12]\d|3[01])\b/);if(S)return Date.UTC(Number(S[1]),Number(S[2])-1,Number(S[3]));if(S=_.match(/\b(0?[1-9]|[12]\d|3[01])[-\/\.](0?[1-9]|1[0-2])[-\/\.](20\d{2})\b/),S)return Date.UTC(Number(S[3]),Number(S[2])-1,Number(S[1]));const P=Date.parse(_);if(Number.isFinite(P)){const k=new Date(P);return Date.UTC(k.getUTCFullYear(),k.getUTCMonth(),k.getUTCDate())}return NaN}function Wr(g){try{const j=String(g||"");if(!j)return null;const _=j.slice(0,12e4),S=_.split(/\r?\n/).slice(0,250).join(`
`),P={jan:0,january:0,feb:1,february:1,mar:2,march:2,apr:3,april:3,may:4,jun:5,june:5,jul:6,july:6,aug:7,august:7,sep:8,sept:8,september:8,oct:9,october:9,nov:10,november:10,dec:11,december:11},k=Object.keys(P).sort((re,ge)=>ge.length-re.length).join("|"),I=(re,ge,ie)=>{const he=Number(re),Se=Number(ge),We=Number(ie);if(!Number.isFinite(he)||!Number.isFinite(Se)||!Number.isFinite(We)||he<2e3||he>2100||Se<0||Se>11||We<1||We>31)return null;const me=Date.UTC(he,Se,We);return Number.isFinite(me)?me:null};let z=_.match(/\b(20\d{2})[-\/\.](0?[1-9]|1[0-2])[-\/\.](0?[1-9]|[12]\d|3[01])\b/);if(z){const re=I(z[1],Number(z[2])-1,z[3]);if(re!==null)return re}if(z=_.match(/\b(0?[1-9]|[12]\d|3[01])[-\/\.](0?[1-9]|1[0-2])[-\/\.](20\d{2})\b/),z){const re=I(z[3],Number(z[2])-1,z[1]);if(re!==null)return re}const V=new RegExp(`(?:^|[^a-z])(${k})\\s+(\\d{1,2})(?:st|nd|rd|th)?\\s*,?\\s*(20\\d{2})`,"i");if(z=S.match(V)||_.match(V),z){const re=P[String(z[1]).toLowerCase()],ge=I(z[3],re,z[2]);if(ge!==null)return ge}const K=new RegExp(`\\b(\\d{1,2})(?:st|nd|rd|th)?\\s+(${k})\\s+(20\\d{2})\\b`,"i");if(z=S.match(K)||_.match(K),z){const re=P[String(z[2]).toLowerCase()],ge=I(z[3],re,z[1]);if(ge!==null)return ge}const M=S.match(/(?:^|,)\s*(date|round\s*date|event\s*date|played\s*on)\s*[,;:]\s*("?)([^"\r\n,;]+)\2/i);if(M){const re=String(M[3]||"").trim();let ge=cr(re);if(Number.isFinite(ge)){const he=new Date(ge);return Date.UTC(he.getUTCFullYear(),he.getUTCMonth(),he.getUTCDate())}const ie=re.match(/\b(0?[1-9]|[12]\d|3[01])[-\/\.](0?[1-9]|1[0-2])[-\/\.](20\d{2})\b/);if(ie){const he=I(ie[3],Number(ie[2])-1,ie[1]);if(he!==null)return he}}return null}catch{return null}}async function bs(g={}){if(!ce){alert("Supabase client not ready");return}$n(""),ns(!0),xs({done:0,total:0}),Is({processed:[],skipped:[]});const j={};function _(ie,he){const Se=Object.keys(ie||{});for(const We of he){const me=We instanceof RegExp?We:new RegExp(We,"i"),Oe=Se.find(ct=>me.test(ct));if(Oe)return Oe}return null}async function S(ie){var Se,We;const he=Ot(ie||"");if(!he)return null;if(j[he]!==void 0)return j[he];try{let me=null,Oe=await ce.from("courses").select("id,name").eq("name",ie).maybeSingle();if(!Oe.error&&Oe.data&&(me=Oe.data),me||(Oe=await ce.from("courses").select("id,name").ilike("name",`%${ie}%`).limit(1),!Oe.error&&Oe.data&&Oe.data.length&&(me=Oe.data[0])),!(me!=null&&me.id))return j[he]=null,null;const ct=await ce.from("tees").select("*").eq("course_id",me.id);if(ct.error||!((Se=ct.data)!=null&&Se.length))return j[he]=null,null;const Pt=ct.data.map(mt=>mt.id),dr=await ce.from("hole_data").select("*").in("tee_id",Pt);if(dr.error||!((We=dr.data)!=null&&We.length))return j[he]=null,null;const Or=dr.data,Vt=Or[0]||{},Dr=_(Vt,[/hole/i,/hole.*number/i,/number/i]),yr=_(Vt,[/^par$/i,/par/i]),kr=_(Vt,[/stroke.*index/i,/^si$/i,/handicap/i,/strokeindex/i]),ut=_(Vt,[/yards?/i,/yardage/i,/distance/i,/length/i,/metre/i,/meter/i]),$r=ct.data.map(mt=>{const ws=Or.filter(xt=>xt.tee_id===mt.id),Ws=Array(18).fill(NaN),hr=Array(18).fill(NaN),Tt=Array(18).fill(NaN);return ws.forEach(xt=>{const we=(Number(Dr?xt[Dr]:xt.hole_number)||0)-1;if(we<0||we>=18)return;const ve=Number(yr?xt[yr]:xt.par),pe=Number(kr?xt[kr]:xt.stroke_index),$e=Number(ut?xt[ut]:xt.yards);Number.isFinite(ve)&&(Ws[we]=ve),Number.isFinite(pe)&&(hr[we]=pe),Number.isFinite($e)&&(Tt[we]=$e)}),{teeName:mt.color||mt.tee_name||mt.teeName||mt.name||"Tee",gender:mt.gender==="Women"||mt.gender==="F"||mt.gender==="Female"?"F":"M",slope:kt(mt.slope??mt.slope_rating??mt.slopeRating??mt.slope_value??mt.slope_val??mt.sr),rating:kt(mt.rating??mt.course_rating??mt.courseRating??mt.course_rating_value??mt.cr),pars:Ws,si:hr,yards:Tt}});return j[he]=$r,$r}catch{return j[he]=null,null}}async function P(ie){const he=[ie],Se=[],We=new Set;for(;he.length;){const me=he.pop();if(We.has(me))continue;We.add(me);const Oe=await ce.storage.from(y).list(me,{limit:1e3,sortBy:{column:"name",order:"asc"}});if(!Oe.error)for(const ct of Oe.data||[]){const Pt=ct&&ct.name?String(ct.name):"";if(!Pt||Pt.startsWith("."))continue;if(!ct.id&&!ct.metadata){he.push(me?me+"/"+Pt:Pt);continue}if(Pt.toLowerCase().endsWith(".csv")){const Or=me?me+"/"+Pt:Pt;Se.push({name:Pt,path:Or})}}}return Se}const k=await P(w);if(!k.length){ns(!1),$n('No CSV files found under prefix "'+w+'".');return}xs({done:0,total:k.length});const I=[],z=[],V=[];let K=0;for(const ie of k)try{const he=await ce.storage.from(y).download(ie.path);if(he.error)V.push({file:ie.path,reason:"download"});else{const Se=await he.data.text(),We=Wr(Se)||_extractDateMsFromPath(ie.path)||null;let me=null;try{me=ul(Se);const Oe=await S(me.courseName||me.internalCourseName||"");Oe&&Oe.length&&(me.courseTees=Oe)}catch{me=null}!me||!me.players||!me.players.length?V.push({file:ie.path,reason:"parse/empty"}):(!Number.isFinite(me.dateMs)&&Number.isFinite(We)&&(me.dateMs=We),I.push({file:ie.path,parsed:me,dateMs:Number.isFinite(me.dateMs)?me.dateMs:We}),z.push(ie.path))}}catch{V.push({file:ie.path,reason:"error"})}finally{K+=1,xs({done:K,total:k.length})}I.sort((ie,he)=>{var me,Oe;const Se=Number.isFinite(Number(ie==null?void 0:ie.dateMs))?Number(ie.dateMs):Number.isFinite(Number((me=ie==null?void 0:ie.parsed)==null?void 0:me.dateMs))?Number(ie.parsed.dateMs):ie!=null&&ie.date?cr(ie.date):Number.POSITIVE_INFINITY,We=Number.isFinite(Number(he==null?void 0:he.dateMs))?Number(he.dateMs):Number.isFinite(Number((Oe=he==null?void 0:he.parsed)==null?void 0:Oe.dateMs))?Number(he.parsed.dateMs):he!=null&&he.date?cr(he.date):Number.POSITIVE_INFINITY;return Se!==We?Se-We:String((ie==null?void 0:ie.file)||"").localeCompare(String((he==null?void 0:he.file)||""))});const M=I.map(ie=>ie.file);Is({processed:M,skipped:V}),oe(I);const re=Gt(I,xe,L),ge=It(re);Fe(ge);try{typeof window<"u"&&(window.__seasonModel=ge)}catch{}try{typeof window<"u"&&(window.__dslUiState={seasonYear:xe,seasonLimit:L})}catch{}!Fs&&ge.players.length&&un(ge.players[0].name),ns(!1);try{const ie=g&&typeof g=="object"&&g.afterView?String(g.afterView):"player_progress";r(ie)}catch{r("player_progress")}}const[Os,ma]=Q.useState([]),[sr,Ln]=Q.useState([]),[Ir,ys]=Q.useState({}),[nr,ur]=Q.useState(Wi);Q.useEffect(()=>{try{document.title=ll}catch{}},[ll]);const[Qt,pa]=Q.useState([]),[Po,Un]=Q.useState(""),[hn,jt]=Q.useState(null),Co=Q.useRef(null),[vs,mi]=Q.useState(0),[qs,ga]=Q.useState(0);Q.useEffect(()=>{try{if(!Array.isArray(sr)||sr.length===0||!Array.isArray(Qt)||Qt.length===0||!Qt.filter(k=>Number(k.slope)>0&&Number(k.rating)>0).length)return;const j=new Map;for(const k of sr){const I=en(k,Qt);if(!I||!(Number(I.slope)>0)||!(Number(I.rating)>0))continue;const z=`${(I.teeName||"").toLowerCase()}|${(I.gender||"M").toUpperCase()}`,V=j.get(z)||{tee:I,n:0};V.n+=1,j.set(z,V)}if(!j.size)return;let _=null;for(const k of j.values())(!_||k.n>_.n)&&(_=k);if(!_)return;const S=Number(_.tee.slope)||0,P=Number(_.tee.rating)||0;S&&P&&(Number(vs)!==S&&mi(S),Number(qs)!==P&&ga(P))}catch{}},[sr,Qt]);const[Gs,Ao]=Q.useState("raw"),[Bn,Ro]=Q.useState("den");Q.useEffect(()=>{let g=!1;async function j(){try{try{A([]),oe([]),Is({processed:[],skipped:[]}),$n(""),q([])}catch{}if(!x){U("Waiting for society...");return}const _=e&&e.supabase?e.supabase:typeof window<"u"&&window.__supabase_client__?window.__supabase_client__:pd(le,J,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});if(typeof window<"u"&&(window.__supabase_client__=_),g)return;$(_),_.auth.getSession().then(({data:{session:P}})=>{Y((P==null?void 0:P.user)??null)}),_.auth.onAuthStateChange((P,k)=>{Y((k==null?void 0:k.user)??null)});const S=await _.from(De).select("name").limit(1);S.error?U("Error: "+S.error.message):(U("Connected"),await xi(_),await ya(_),await bi(_),await To(_),await xa(_))}catch(_){g||U("Error: "+((_==null?void 0:_.message)||_))}}return j(),()=>{g=!0}},[x]),Q.useEffect(()=>{ce&&bi(ce)},[ce,O]);async function pi(g,j){if(!g||!j){E(!0);return}T(!0);try{const{error:_}=await ce.auth.signInWithPassword({email:g,password:j});if(_)throw _;bt("Logged in"),E(!1)}finally{T(!1)}}async function gi(){try{typeof window<"u"&&(window.__activeSocietyId="",window.__activeSocietySlug="",window.__activeSocietyName="",window.__activeSocietyRole="")}catch{}try{window.location.reload()}catch{}}async function is(){try{await ce.auth.signOut()}catch{}Y(null);try{window.location.reload()}catch{alert("Logged out")}}async function xa(g){try{if(g=g||ce,!g)return;const j=`${w}/admin`,_=await g.storage.from(y).list(j,{search:"player_visibility.json",limit:1});if(!_||_.error||!Array.isArray(_.data)||_.data.length===0)return;const S=await g.storage.from(y).download(Ze);if(S&&S.data){const P=await S.data.text(),k=JSON.parse(P),I=Array.isArray(k==null?void 0:k.hiddenKeys)?k.hiddenKeys:Array.isArray(k==null?void 0:k.hidden)?k.hidden:[];if(Array.isArray(I)){const z=I.map(V=>String(V||"").trim()).filter(Boolean);ye(Array.from(new Set(z)));try{localStorage.setItem(He,JSON.stringify(Array.from(new Set(z))))}catch{}}}}catch{}}async function ba(g){const j=Array.from(new Set((Array.isArray(g)?g:[]).map(_=>String(_||"").trim()).filter(Boolean)));ye(j);try{localStorage.setItem(He,JSON.stringify(j))}catch{}if(ce){if(!B){bt("Saved locally (sign in to publish to everyone)");return}try{const _=JSON.stringify({hiddenKeys:j,updatedAt:new Date().toISOString(),updatedBy:(B==null?void 0:B.email)||""},null,2),S=new Blob([_],{type:"application/json"}),P=await ce.storage.from(y).upload(Ze,S,{upsert:!0,contentType:"application/json"});P&&P.error?bt("Save failed: "+P.error.message):bt("Player filter saved ")}catch(_){bt("Save failed: "+((_==null?void 0:_.message)||_))}}}async function To(g){if(g=g||ce,!g)return;const{data:j,error:_}=await g.from("courses").select("id, name").order("name");!_&&j&&ma(j)}async function Fo(g){if(!Os.length||!g)return!1;const j=String(g).toLowerCase().replace(/\.csv$/i,"").replace(/[_\-]/g," ").replace(/[^a-z0-9\s]/g," ").replace(/\s+/g," ").trim(),_=new Set(["golf","club","course","society","gc","the","and","of","at","&","resort","links","hotel","country","park","estate"]),S=j.split(/\s+/).map(V=>V.trim()).filter(V=>V&&V.length>2&&!_.has(V)),P=new Set(S);let k=null,I=-1,z=1e9;for(const V of Os){const K=String(V.name||"").toLowerCase().replace(/[^a-z0-9\s]/g," ").replace(/\s+/g," ").trim(),M=K.split(/\s+/).map(We=>We.trim()).filter(We=>We&&We.length>2&&!_.has(We));if(!M.length)continue;let re=0,ge=0;for(const We of M)P.has(We)&&(re++,ge+=We.length);const ie=re*100+ge,he=re>0||um(j,K)?_l(Ot(j),Ot(K)):1e9;(re>0||he<6)&&(ie>I||ie===I&&he<z)&&(I=ie,z=he,k=V)}return k?(bt(`Auto-detected: ${k.name}`),await Io(k.id),!0):!1}async function Io(g){if(!ce||!g)return;const j=await ce.from("courses").select("name").eq("id",g).single();j.data&&Un(j.data.name);const _=await ce.from("tees").select("*").eq("course_id",g);if(_.error||!_.data.length){bt("No tee data found for this course.");return}const S=_.data,P=S.map(V=>V.id),k=await ce.from("hole_data").select("*").in("tee_id",P);if(k.error){bt("Error loading hole data.");return}const I=k.data;mi(0),ga(0);const z=S.map(V=>{const K=I.filter(ie=>ie.tee_id===V.id).sort((ie,he)=>ie.hole_number-he.hole_number),M=Array(18).fill(0),re=Array(18).fill(0),ge=Array(18).fill(0);return K.forEach(ie=>{const he=ie.hole_number-1;he>=0&&he<18&&(M[he]=ie.par,re[he]=ie.stroke_index,ge[he]=ie.yards)}),{teeName:V.color,gender:V.gender==="Women"||V.gender==="F"||V.gender==="Female"?"F":"M",slope:Number(V.slope)||0,rating:Number(V.rating)||0,pars:M,si:re,yards:ge}});pa(z)}function Oo(g){const j={};for(const S of g||[]){const P=Number(S==null?void 0:S.dateMs),k=Number.isFinite(P)&&P>0?new Date(P).getUTCFullYear():null,I=String((S==null?void 0:S.name)||"").match(/(20\d{2})/),z=k?String(k):I?I[1]:"Unknown";(j[z]||(j[z]=[])).push({...S,dateMs:Number.isFinite(P)?P:null})}return Object.keys(j).sort((S,P)=>{const k=Number(S),I=Number(P),z=Number.isFinite(k)?k:1/0,V=Number.isFinite(I)?I:1/0;return z-V}).map(S=>{const P=(j[S]||[]).slice().sort((k,I)=>{const z=Number(k==null?void 0:k.dateMs),V=Number(I==null?void 0:I.dateMs),K=Number.isFinite(z)&&z>0?z:1/0,M=Number.isFinite(V)&&V>0?V:1/0;return K!==M?K-M:String((k==null?void 0:k.name)||"").localeCompare(String((I==null?void 0:I.name)||""))});return{year:S,events:P}})}function Do(g,j){try{const _=Number(g),S=new Date(cr(g));if(!Number.isFinite(S.getTime()))return null;const P=S.toISOString().slice(0,10);for(const k of j||[]){const I=String(k.start_date||k.startDate||"").slice(0,10),z=String(k.end_date||k.endDate||"").slice(0,10);if(I&&z&&P>=I&&P<z)return String(k.season_id)}return null}catch{return null}}async function ya(g){if(g=g||ce,!g)return;const j=await g.from("seasons").select("competition,season_id,label,start_date,end_date,is_active").eq("competition",N).eq("society_id",x).eq("society_id",x).order("start_date",{ascending:!1});if(j.error){bt("Seasons load failed: "+j.error.message);return}const _=Array.isArray(j.data)?j.data:[];q(_);try{typeof window<"u"&&(window.__dslSeasonsDef=_)}catch{}const S=_.find(k=>k.is_active)||_[0],P=S?String(S.season_id):"";ne(P),ht(k=>{const I=String(k||"");return!I||I.toLowerCase()==="all"?P||"All":I})}async function xi(g){if(g=g||ce,!g)return;const j=await g.storage.from(y).list(w,{limit:1e3,sortBy:{column:"name",order:"asc"}});if(j.error){bt("Storage error: "+j.error.message);return}const _=(j.data||[]).filter(S=>(S==null?void 0:S.name)&&!S.name.startsWith(".")&&/\.csv$/i.test(S.name)).map(S=>({name:S.name.replace(/\.csv$/i,""),file:S.name,path:`${w}/${S.name}`,dateMs:null}));for(const S of _)try{const P=await g.storage.from(y).download(S.path);if(P.error)continue;const k=await P.data.text();S.dateMs=Wr(k)||_extractDateMsFromPath(S.file)||null,S.seasonId=S.dateMs&&Do(S.dateMs,Ue)||null;try{const I=ul(k);S.courseName=(I==null?void 0:I.courseName)||(I==null?void 0:I.internalCourseName)||"",S.format=(I==null?void 0:I.format)||(I==null?void 0:I.gameFormat)||(I==null?void 0:I.formatName)||""}catch{S.courseName=S.courseName||"",S.format=S.format||""}}catch{}A(Oo(_))}async function wc(g){var k;if(!ce){alert("Supabase client not ready");return}const j=await ce.storage.from(y).download(g.path);if(j.error){alert("Download failed: "+j.error.message);return}const _=await j.data.text();let S;try{S=ul(_)}catch(I){alert((I==null?void 0:I.message)||"Failed to parse CSV.");return}Ln(S.players||[]),m(((k=S.players[0])==null?void 0:k.name)||""),ur(g.name),jt(null),await Fo(S.courseName||g.file)||(pa(S.courseTees||[]),Un(S.courseName||"")),r("event"),bt("Event loaded")}async function bi(g){if(g=g||ce,!g)return;let j=g.from(De).select("*").eq("competition",N).eq("society_id",x);O&&String(O).toLowerCase()!=="all"&&(j=j.eq("season_id",String(O)));const _=await j;if(_.error){U("Error: "+_.error.message);return}const S={};for(const P of _.data||[]){if(Yt(P.name))continue;let k=[];if(Array.isArray(P.best_per_hole))k=P.best_per_hole;else if(typeof P.best_per_hole=="string")try{k=JSON.parse(P.best_per_hole)}catch{}S[P.name]={name:P.name,totalPoints:P.total_points||0,events:P.events||0,bestEventPoints:P.best_event_points??0,bestHolePoints:P.best_hole_points??0,eclecticTotal:P.eclectic_total??0,bestPerHole:(k||[]).map(I=>Number(I)||0)}}ys(S)}function fn(g,j,_){var P;let S;try{S=ul(g)}catch(k){alert((k==null?void 0:k.message)||"Failed to parse CSV.");return}Ln(S.players||[]),m(((P=S.players[0])==null?void 0:P.name)||""),ur((j||"").replace(/\.[^.]+$/,"")),o(Number.isFinite(S==null?void 0:S.dateMs)?S.dateMs:Wr(g)||null),l(j||""),_&&jt(_),Fo(S.courseName||j).then(k=>{k||(pa(S.courseTees||[]),Un(S.courseName||""))}),r("event")}function as(g,j){const _=g.perHole||[],S=j.perHole||[],P=(re,ge,ie)=>re.slice(ge,ie).reduce((he,Se)=>he+(Number(Se)||0),0),k=P(_,9,18),I=P(S,9,18);if(k!==I)return I-k;const z=P(_,12,18),V=P(S,12,18);if(z!==V)return V-z;const K=P(_,15,18),M=P(S,15,18);return K!==M?M-K:NaN}const ir=Q.useMemo(()=>{var K;if(!sr.length)return[];const g=sr.map((M,re)=>{const ge=Number(M.handicap),ie=Number.isFinite(ge)?ge:0,he=Math.round(ie);let Se=null;if(Gs==="calc"){const We=Number(vs)||113,me=Number(qs)||0;let Oe=72;try{const Pt=en({gender:M.gender,teeLabel:M.teeLabel},Qt);if(Pt&&Array.isArray(Pt.pars)&&Pt.pars.length){const dr=Pt.pars.reduce((Or,Vt)=>Or+(Number.isFinite(Number(Vt))?Number(Vt):0),0);dr>0&&(Oe=dr)}}catch{}const ct=ie*(We/113)+(me-Oe);Se=Math.round(ct)}return{idx:re,name:M.name,gender:M.gender,teeLabel:M.teeLabel,startExact:ie,playingHcap:he,playingHcapRef:Se,points:M.points,back9:M.back9,perHole:M.perHole,grossPerHole:M.grossPerHole,imputedGrossPerHole:M.imputedGrossPerHole,imputedMask:M.imputedMask,bestBallPerHole:M.bestBallPerHole}}),j=[...g].sort((M,re)=>re.points-M.points||as(M,re)),_=[],S=new Set;for(const M of j){if(S.has(M.idx))continue;const re=j.filter(ge=>ge.points===M.points).map(ge=>ge.idx);re.forEach(ge=>S.add(ge)),_.push(re)}const P=((K=_[0])==null?void 0:K.map(M=>g.find(re=>re.idx===M)))||[];let k=P.length?[P[0]]:[];for(let M=1;M<P.length;M++){const re=as(P[M],k[0]);re>0?k=[P[M]]:re===0&&k.push(P[M])}const I=new Set(k.map(M=>M.idx));let z=1;const V=[];for(let M=0;M<_.length;M++){const re=_[M],ge=z,ie=Pw[ge-1]||0;for(const he of re){const Se=g.find(ut=>ut.idx===he),We=I.has(he)&&M===0;let me="-",Oe=Number(Se.startExact);if(Bn==="den"){const ut=J0(Se.startExact,Se.gender,Se.points,Se.back9,We);Oe=Us(Number(ut.nextExact),0,36),me=Number.isFinite(Oe)?Oe.toFixed(1):""}else if(Bn==="whs"){let ut=null,$r=Number(vs)||113,mt=Number(qs)||0;try{ut=en(Se,Qt),ut&&Number(ut.slope)>0&&($r=Number(ut.slope)),ut&&Number(ut.rating)>0&&(mt=Number(ut.rating))}catch{}const ws=ut?{pars:ut.pars||ut.par||ut.Pars||[],si:ut.si||ut.SI||ut.strokeIndex||[]}:{pars:[],si:[]},Ws=gd(Se.imputedGrossPerHole||Se.grossPerHole,ws,Se.startExact,$r,mt);let hr=xd(Ws,$r,mt,0);const Tt=[];try{const we=Se.file||null;for(const ve of Array.isArray(de)?de:[]){if(!ve||!ve.parsed||we&&ve.file===we)continue;const pe=ve.parsed,$e=Array.isArray(pe.players)?pe.players:[],be=Ot(String(Se.name||"")),tt=$e.find(vt=>Ot(String((vt==null?void 0:vt.name)||""))===be);if(!tt)continue;let rt=null,os=Number(pe.courseSlope)||Number(vs)||113,wt=Number(pe.courseRating)||Number(qs)||0;const je=pe.courseTees||Qt||[];try{rt=en(tt,je),rt&&Number(rt.slope)>0&&(os=Number(rt.slope)),rt&&Number(rt.rating)>0&&(wt=Number(rt.rating))}catch{}const zt=rt?{pars:rt.pars||rt.par||[],si:rt.si||rt.SI||[]}:{pars:[],si:[]},Vr=Number(tt.startExact??tt.hi??tt.handicap),se=tt.grossPerHole||tt.imputedGrossPerHole;if(!Array.isArray(se)||se.length===0)continue;const Er=gd(se,zt,Vr,os,wt),Ce=xd(Er,os,wt,0);Number.isFinite(Ce)&&Tt.push({d:Ce,t:Number(ve.dateMs)||0})}}catch{}Number.isFinite(hr)&&Tt.push({d:hr,t:Number(Date.now())}),Tt.sort((we,ve)=>we.t-ve.t);const xt=Tt.slice(-20).map(we=>we.d),fr=Q0(xt);Oe=Number.isFinite(fr)?Us(Number(fr),0,36):Us(Number(Se.startExact),0,36),me=Number.isFinite(fr)?fr.toFixed(1):Number.isFinite(hr)?hr.toFixed(1):""}else Oe=Us(Number(Se.startExact),0,36),me=Number.isFinite(Oe)?Oe.toFixed(1):"";let ct=0,Pt=0,dr=0,Or=!1,Vt=0,Dr=4,yr=0,kr=36;try{const ut=[];for(const Tt of Array.isArray(de)?de:[]){if(!Tt||!Tt.parsed)continue;const xt=Tt.parsed,fr=Array.isArray(xt.players)?xt.players:[],we=Ot(String(Se.name||"")),ve=fr.find(be=>Ot(String((be==null?void 0:be.name)||""))===we);if(!ve)continue;let pe=Number(ve.points);if(!Number.isFinite(pe)&&Array.isArray(ve.perHole))try{pe=ve.perHole.reduce((be,tt)=>be+(Number(tt)||0),0)}catch{pe=NaN}let $e=Number(ve.startExact);Number.isFinite($e)||($e=Number(ve.handicap)),Number.isFinite($e)||($e=Number(ve.hcap)),Number.isFinite($e)||($e=Number(ve.HI)),Number.isFinite($e)||($e=Number(ve.hi)),Number.isFinite(pe)&&ut.push({p:pe,t:Number(Tt.dateMs)||0,h:$e})}Number.isFinite(Number(Se.points))&&ut.push({p:Number(Se.points),t:Number(Date.now()),h:Number(Se.startExact)}),ut.sort((Tt,xt)=>Tt.t-xt.t);const $r=ut.slice(-12),mt=Number.isFinite(Number(Oe))?Number(Oe):Number(Se.startExact),ws=$r.filter(Tt=>Number.isFinite(Number(Tt.h))&&Math.abs(Number(Tt.h)-mt)<=4);Pt=ws.length;const Ws=ws.length>=3?ws:$r;Or=ws.length>=3;const hr=Ws.map(Tt=>Number(Tt.p)).filter(Number.isFinite);if(dr=hr.length,ct=hr.length,ct>=2){const xt=hr.map((wt,je)=>Math.pow(.5,(ct-1-je)/6)),fr=xt.reduce((wt,je)=>wt+je,0)||1,we=xt.reduce((wt,je)=>wt+je*je,0)||1,ve=Math.max(1,fr*fr/we),pe=hr.map(wt=>wt-36),$e=pe.reduce((wt,je,zt)=>wt+je*xt[zt],0)/fr,be=pe.reduce((wt,je,zt)=>wt+xt[zt]*Math.pow(je-$e,2),0)/fr,rt=ve/(ve+6);Vt=$e*rt;const os=Math.sqrt(Math.max(1,be));Dr=Math.min(8,os*(1+1/Math.sqrt(ve)));try{const wt=hr.map((Ce,vt)=>vt),je=wt.reduce((Ce,vt,vr)=>Ce+vt*xt[vr],0)/fr,zt=pe.reduce((Ce,vt,vr)=>Ce+vt*xt[vr],0)/fr,Vr=pe.reduce((Ce,vt,vr)=>Ce+xt[vr]*(wt[vr]-je)*(vt-zt),0),se=wt.reduce((Ce,vt,vr)=>Ce+xt[vr]*Math.pow(vt-je,2),0),Er=se>1e-9?Vr/se:0;yr=(Number.isFinite(Er)?Er:0)*rt}catch{yr=0}kr=36+Vt}else ct===1?(Vt=(hr[0]-36)*.15,Dr=6,yr=0,kr=36+Vt):(Vt=0,Dr=6,yr=0,kr=36)}catch{ct=0,Vt=0,Dr=6,yr=0,kr=36}try{const ut=Number.isFinite(Number(Oe))&&Number.isFinite(Number(Se.startExact))?Number(Oe)-Number(Se.startExact):0,$r=Number.isFinite(yr)?Math.max(-2,Math.min(2,yr*.75)):0;kr=Math.max(20,Math.min(50,Number(kr)+ut+$r))}catch{}V.push({...Se,position:ge,leaguePoints:ie,isWinner:We,nextDisplay:me,nextExactNum:Oe,formN:ct,oddsRoundsUsed:dr,oddsSimilarRounds:Pt,oddsUsedSimilar:Or,formMu:Vt,formTrend:yr,formSigma:Dr,expPts:kr})}z+=re.length}return V.sort((M,re)=>M.position-re.position)},[sr,Qt,vs,qs,Gs,Bn,de]);async function Nc(g){const j=await g.from("seasons").select("season_id").eq("society_id",x).eq("competition",N).order("start_date",{ascending:!1}).limit(1);if(j.data&&j.data.length)return j.data[0].season_id;const _=new Date().getFullYear(),S=String(_),P=`${_}-01-01`,k=`${_+1}-01-01`,{error:I}=await g.from("seasons").insert({society_id:x,competition:N,season_id:S,label:S,start_date:P,end_date:k,is_active:!0});if(I)throw I;return S}async function $o(){var j;if(!ir.length){bt("Load an event first");return}if(!B){alert("Please log in as admin first.");return}if(hn){bt("Uploading file...");const _=hn.name,S=`${w}/${_}`,{error:P}=await ce.storage.from(y).upload(S,hn,{upsert:!0});P?alert("File upload failed: "+P.message):bt("File uploaded successfully.")}const g={...Ir};for(const _ of ir){if(Yt(_.name))continue;const S=g[_.name]||{name:_.name,totalPoints:0,events:0,bestPerHole:Array(18).fill(0),bestEventPoints:0,bestHolePoints:0},P=(_.perHole||[]).map(K=>Math.max(0,Math.min(6,Number(K)||0))),k=S.bestPerHole.map((K,M)=>Math.max(K,P[M])),I=k.reduce((K,M)=>K+M,0),z=Math.max(S.bestEventPoints||0,_.points||0),V=Math.max(S.bestHolePoints||0,Math.max(...P));g[_.name]={name:_.name,totalPoints:(S.totalPoints||0)+(_.leaguePoints||0),events:(S.events||0)+1,bestEventPoints:z,bestHolePoints:V,eclecticTotal:I,bestPerHole:k}}if(ys(g),ce){const _=Object.values(g).filter(I=>!Yt(I.name));let S=xe&&String(xe).toLowerCase()!=="all"?String(xe):((j=Ue.find(I=>I&&I.is_active))==null?void 0:j.season_id)||"";S||(S=await Nc(ce));try{const I=Number.isFinite(a)?a:null,z=hn&&hn.name?hn.name:c||"";if(I&&z){const V=new Date(I).toISOString().slice(0,10),K=`${w}/${z}`;await ce.from("events").upsert([{society_id:x,competition:N,season_id:S,event_name:(z||"").replace(/\.[^.]+$/,""),storage_bucket:y,storage_path:K,event_date:V}],{onConflict:"society_id,competition,season_id,storage_path"})}else I?z||console.warn("No file name available; events table not updated."):console.warn("No event_date detected for this CSV; events table not updated.")}catch(I){console.error("Failed to save event metadata to events table:",I)}const P=_.map(I=>({society_id:x,season_id:S,competition:N,name:I.name,total_points:I.totalPoints,events:I.events,best_event_points:I.bestEventPoints,best_hole_points:I.bestHolePoints,eclectic_total:I.eclecticTotal,best_per_hole:I.bestPerHole})),k=await ce.from(De).upsert(P,{onConflict:"society_id,season_id,competition,name"});k.error?bt("Error: "+k.error.message):bt("Season updated "),await xi(ce)}}async function va(){var _,S;if(!(xe&&String(xe).toLowerCase()!=="all"?String(xe):((_=Ue.find(P=>P&&P.is_active))==null?void 0:_.season_id)||"")){bt("Select a season first");return}if(!ir.length){bt("Load an event first");return}if(!window.confirm("Remove this event from the season standings?"))return;const j={...Ir};for(const P of ir){const k=j[P.name];if(!k)continue;const I=k.totalPoints-P.leaguePoints,z=Math.max(0,k.events-1);I<=0&&z===0?delete j[P.name]:j[P.name]={...k,totalPoints:I,events:z}}if(ys(j),ce){const P=Object.values(j).filter(V=>!Yt(V.name)),k=xe&&String(xe).toLowerCase()!=="all"?String(xe):((S=Ue.find(V=>V&&V.is_active))==null?void 0:S.season_id)||"";if(!k){bt("Select a season first");return}const I=P.map(V=>({society_id:x,season_id:k,competition:N,name:V.name,total_points:V.totalPoints,events:V.events,best_event_points:V.bestEventPoints,best_hole_points:V.bestHolePoints,eclectic_total:V.eclecticTotal,best_per_hole:V.bestPerHole})),z=await ce.from(De).upsert(I,{onConflict:"society_id,season_id,competition,name"});z.error?bt("Error: "+z.error.message):bt("Event removed from season ")}}async function wa(){var _;if(!ce){bt("No client");return}const g=xe&&String(xe).toLowerCase()!=="all"?String(xe):((_=Ue.find(S=>S&&S.is_active))==null?void 0:_.season_id)||"";if(!g){bt("Select a season first");return}if(!window.confirm(" This will delete ALL standings rows for the selected season. Continue?"))return;const j=await ce.from(De).delete().eq("competition",N).eq("society_id",x).eq("season_id",g).neq("name","");if(j.error){bt("Error: "+j.error.message);return}ys({}),bt("Season cleared"),await ya(ce),await bi(ce),await xi(ce)}const yi=ue.useMemo(()=>{const g=new Map,j=S=>{const P=String(S||"").trim();if(!P)return;try{if(typeof Yt=="function"&&Yt(P))return}catch{}const k=Ot(P);k&&(g.has(k)||g.set(k,P))};try{Object.values(Ir||{}).forEach(S=>j(S==null?void 0:S.name))}catch{}try{((H==null?void 0:H.players)||[]).forEach(S=>j(S==null?void 0:S.name))}catch{}try{(ir||[]).forEach(S=>j(S==null?void 0:S.name))}catch{}return Array.from(g.values()).sort((S,P)=>S.localeCompare(P)).map(S=>({name:S}))},[Ir,H,ir]),Na=ue.useMemo(()=>{try{if(!Te||Te.size===0)return Ir;const g={};return Object.entries(Ir||{}).forEach(([j,_])=>{const S=_&&_.name?String(_.name):String(j||""),P=Ot(S);P&&Te.has(P)||(g[j]=_)}),g}catch{return Ir}},[Ir,Te]),Xt=ue.useMemo(()=>{try{return!Te||Te.size===0?ir:(ir||[]).filter(g=>{const j=g&&g.name?String(g.name):"",_=Ot(j);return!(_&&Te.has(_))})}catch{return ir}},[ir,Te]);ue.useMemo(()=>{try{return!Te||Te.size===0?sr:(sr||[]).filter(g=>{const j=g&&g.name?String(g.name):"",_=Ot(j);return!(_&&Te.has(_))})}catch{return sr}},[sr,Te]);const b=ue.useMemo(()=>{const g=((B==null?void 0:B.email)||"").toLowerCase();return g?(_w||[]).map(j=>String(j).toLowerCase()).includes(g):!1},[B==null?void 0:B.email]);return n.jsx("div",{className:"min-h-screen p-4 sm:p-6 bg-neutral-50",children:n.jsxs("div",{className:"app-shell space-y-4 pt-1",children:[n.jsx(Yw,{leagueHeaderTitle:ll,eventName:nr,statusMsg:R,courseName:Po,view:t,setView:r}),n.jsx(Cw,{open:v,busy:C,onClose:()=>E(!1),onSubmit:pi}),n.jsx(Aw,{open:ze,onClose:()=>it(!1),onSubmit:rr}),n.jsx(Rw,{open:et,onClose:()=>Z(!1),isAdmin:!!B,players:yi,hiddenKeys:ae,onSave:ba}),n.jsx(Jw,{statusMsg:R,courseName:Po}),n.jsx("button",{className:"fixed right-3 bottom-3 z-[9999] w-11 h-11 rounded-full bg-neutral-900 text-white flex items-center justify-center shadow-xl border border-white/10 hover:-translate-y-[1px] transition",onClick:()=>r("guide"),title:"Guide","aria-label":"Guide",children:""}),t==="home"&&n.jsx(Qw,{runSeasonAnalysis:bs,setView:r,fileInputRef:Co,importLocalCSV:fn,computed:Xt,addEventToSeason:$o,removeEventFromSeason:va,clearSeason:wa,user:B,activeRole:d.role,isSuperAdmin:b,handleLogin:pi,handleLogout:is,handleSwitchSociety:gi,openPlayersAdmin:Rt,visiblePlayersCount:((W==null?void 0:W.players)||[]).length,totalPlayersCount:(yi||[]).length}),t==="admin"&&n.jsx(Xw,{setView:r,fileInputRef:Co,importLocalCSV:fn,computed:Xt,addEventToSeason:$o,removeEventFromSeason:va,clearSeason:wa,user:B,activeRole:d.role,isSuperAdmin:b,handleLogin:pi,handleLogout:is,handleSwitchSociety:gi,openPlayersAdmin:Rt,visiblePlayersCount:((W==null?void 0:W.players)||[]).length,totalPlayersCount:(yi||[]).length}),t==="player_progress"&&n.jsx(uN,{seasonModel:W,seasonFiles:fi,reportNextHcapMode:F,setReportNextHcapMode:G,seasonPlayer:Fs,setSeasonPlayer:un,seasonYear:xe,setSeasonYear:Ye,seasonLimit:L,setSeasonLimit:X,seasonYears:Fr,seasonLoading:Ut,seasonProgress:Eo,seasonError:Gr,runSeasonAnalysis:bs,setView:r,scoringMode:dn,setScoringMode:hi,grossCompare:Mn,setGrossCompare:fa}),t==="past"&&n.jsx(Zw,{sharedGroups:D,loadShared:wc,setView:r}),t==="event"&&n.jsx(tN,{computed:Xt,setView:r,courseSlope:vs,setCourseSlope:mi,courseRating:qs,setCourseRating:ga,startHcapMode:Gs,setStartHcapMode:Ao,nextHcapMode:Bn,setNextHcapMode:Ro,seasonRoundsFiltered:Wt,seasonRoundsAll:qr,seasonModelAll:H}),t==="banter"&&n.jsx(iN,{computed:Xt,setView:r}),t==="guide"&&n.jsx(gN,{setView:r,leagueTitle:Wi}),t==="mirror_read"&&n.jsx(xN,{setView:r}),t==="ratings"&&n.jsx(rN,{computed:Xt,courseTees:Qt,setView:r}),t==="standings"&&n.jsx(sN,{season:Na,setView:r,seasonsDef:Ue,seasonYear:O,setSeasonYear:ht}),t==="eclectic"&&n.jsx(nN,{season:Na,setView:r,seasonsDef:Ue,seasonYear:O,setSeasonYear:ht}),t==="graphs"&&n.jsx(aN,{computed:Xt,courseTees:Qt,setView:r}),t==="scorecard"&&n.jsx(eN,{computed:Xt,courseTees:Qt,setView:r}),t==="course_stats"&&n.jsx(yN,{computed:Xt,courseTees:Qt,setView:r}),t==="headtohead"&&n.jsx(vN,{computed:Xt,setView:r,courseTees:Qt}),t==="style"&&n.jsx(wN,{computed:Xt,setView:r}),t==="story"&&n.jsx(NN,{computed:Xt,setView:r}),t==="replay"&&n.jsx(kN,{computed:Xt,setView:r}),t==="team_replay"&&n.jsx(oN,{computed:Xt,courseTees:Qt,courseSlope:vs,courseRating:qs,startHcapMode:Gs,setView:r}),t==="casino"&&n.jsx(jN,{computed:Xt,courseTees:Qt,setView:r}),t==="trophies"&&n.jsx(_N,{computed:Xt,courseTees:Qt,setView:r}),t==="partner"&&n.jsx(SN,{computed:Xt,setView:r})]})})}function yN({computed:e,courseTees:t,setView:r}){const s=ue.useMemo(()=>gs(e),[e]);if(!e.length)return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Qs,{items:[{label:"Game",onClick:()=>r("event"),title:"Round Leaderboard"},{label:"Course Stats"}]}),n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to see course stats."})]});const i=Array.from({length:s}).map((p,y)=>({hole:y+1,totalPts:0,count:0,zeros:0,threesPlus:0}));e.forEach(p=>{(p.perHole||[]).slice(0,s).forEach((y,w)=>{const N=Number(y)||0;i[w].totalPts+=N,i[w].count++,N===0&&i[w].zeros++,N>=3&&i[w].threesPlus++})});const a=t.find(p=>p.gender==="M")||t[0]||{},o=a.pars||Array(18).fill(0),c=a.si||Array(18).fill(0),l=i.map((p,y)=>{const w=p.count?p.totalPts/p.count:0;return{...p,par:o[y],si:c[y],avg:w}}),u=[...l].sort((p,y)=>p.avg-y.avg),d={};u.forEach((p,y)=>{d[p.hole]=y+1});const x=l.map(p=>({...p,playedRank:d[p.hole],diff:d[p.hole]-p.si})),h=p=>p>=2.2?"bg-emerald-100 text-emerald-800":p>=1.8?"bg-neutral-50 text-neutral-800":p>=1.4?"bg-orange-50 text-orange-800":"bg-red-50 text-red-800 font-bold";return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)}),n.jsx("h2",{className:"text-lg font-semibold text-squab-900 mb-1",children:"Course Difficulty Analysis"}),n.jsx("p",{className:"text-xs text-neutral-500 mb-4",children:"Comparing scorecard Stroke Index (SI) vs actual field performance."}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[n.jsxs("div",{className:"p-3 border border-red-200 bg-red-50 rounded-2xl",children:[n.jsx("div",{className:"text-[10px] uppercase tracking-wide text-red-700 font-bold",children:"Hardest Hole"}),n.jsxs("div",{className:"text-xl font-bold text-red-900 mt-1",children:["Hole ",u[0].hole]}),n.jsxs("div",{className:"text-xs text-red-800",children:["Avg: ",u[0].avg.toFixed(2)," pts"]})]}),n.jsxs("div",{className:"p-3 border border-emerald-200 bg-emerald-50 rounded-2xl",children:[n.jsx("div",{className:"text-[10px] uppercase tracking-wide text-emerald-700 font-bold",children:"Easiest Hole"}),n.jsxs("div",{className:"text-xl font-bold text-emerald-900 mt-1",children:["Hole ",u[u.length-1].hole]}),n.jsxs("div",{className:"text-xs text-emerald-800",children:["Avg: ",u[u.length-1].avg.toFixed(2)," pts"]})]}),n.jsxs("div",{className:"p-3 border border-squab-200 bg-white rounded-2xl",children:[n.jsx("div",{className:"text-[10px] uppercase tracking-wide text-neutral-600 font-bold",children:"Most Wipes"}),n.jsxs("div",{className:"text-lg font-bold text-neutral-900 mt-1",children:["Hole ",x.sort((p,y)=>y.zeros-p.zeros)[0].hole]}),n.jsxs("div",{className:"text-xs text-neutral-500",children:[x.sort((p,y)=>y.zeros-p.zeros)[0].zeros," players"]})]}),n.jsxs("div",{className:"p-3 border border-squab-200 bg-white rounded-2xl",children:[n.jsx("div",{className:"text-[10px] uppercase tracking-wide text-neutral-600 font-bold",children:"Most 3+ Pts"}),n.jsxs("div",{className:"text-lg font-bold text-neutral-900 mt-1",children:["Hole ",x.sort((p,y)=>y.threesPlus-p.threesPlus)[0].hole]}),n.jsxs("div",{className:"text-xs text-neutral-500",children:[x.sort((p,y)=>y.threesPlus-p.threesPlus)[0].threesPlus," players"]})]})]}),n.jsx("div",{className:"overflow-auto table-wrap",children:n.jsxs("table",{className:"min-w-full text-xs md:text-sm text-center",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-squab-200 bg-squab-50 text-neutral-700",children:[n.jsx("th",{className:"py-2 px-2 text-left",children:"Hole"}),n.jsx("th",{className:"py-2 px-2",children:"Par"}),n.jsx("th",{className:"py-2 px-2",children:"Card SI"}),n.jsx("th",{className:"py-2 px-2 bg-neutral-100 border-l border-neutral-200",children:"Field Avg Pts"}),n.jsx("th",{className:"py-2 px-2 bg-neutral-100 border-r border-neutral-200",children:"Played Rank"}),n.jsx("th",{className:"py-2 px-2",children:"Diff"}),n.jsx("th",{className:"py-2 px-2 text-red-600",children:"Wipes"})]})}),n.jsx("tbody",{children:[...x].sort((p,y)=>(Number(p.playedRank)||999)-(Number(y.playedRank)||999)).map(p=>n.jsxs("tr",{className:"border-b border-squab-100 hover:bg-squab-50",children:[n.jsx("td",{className:"py-2 px-2 text-left font-bold",children:p.hole}),n.jsx("td",{className:"py-2 px-2",children:p.par||"-"}),n.jsx("td",{className:"py-2 px-2",children:p.si||"-"}),n.jsx("td",{className:`py-2 px-2 font-mono font-medium border-l border-neutral-200 ${h(p.avg)}`,children:p.avg.toFixed(2)}),n.jsx("td",{className:"py-2 px-2 font-bold bg-neutral-50 border-r border-neutral-200",children:p.playedRank}),n.jsx("td",{className:"py-2 px-2 text-xs text-neutral-500",children:Math.abs(p.diff)>=4?n.jsx("span",{className:p.diff<0?"text-red-600 font-bold":"text-emerald-600 font-bold",children:p.diff<0?"Harder":"Easier"}):n.jsx("span",{className:"text-neutral-300",children:""})}),n.jsx("td",{className:"py-2 px-2 text-neutral-400",children:p.zeros>0?n.jsx("span",{className:"text-neutral-800",children:p.zeros}):"-"})]},p.hole))})]})})]})}function vN({computed:e,setView:t,courseTees:r}){const[s,i]=Q.useState(""),[a,o]=Q.useState("");if(Q.useEffect(()=>{var oe;e.length>=2&&!s&&!a&&(i(e[0].name),o(((oe=e[1])==null?void 0:oe.name)||e[0].name))},[e,s,a]),e.length<2||!s||!a)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Need at least 2 distinct players loaded."})]});const c=e.find(oe=>oe.name===s)||e[0],l=e.find(oe=>oe.name===a)||e[1],u=(c.perHole||[]).map(oe=>Number(oe)||0),d=(l.perHole||[]).map(oe=>Number(oe)||0),x=en(c,r),h=en(l,r),p=(x==null?void 0:x.pars)||Array(18).fill(0),y=(h==null?void 0:h.pars)||Array(18).fill(0),w=(oe,xe)=>oe.reduce((Ye,O,ht)=>xe[ht]===3?Ye+(O||0):Ye,0),N=w(u,p),f=w(d,y),m=oe=>oe.reduce((xe,Ye)=>xe+Ye,0),v=m(u),E=m(d),C=m(u.slice(0,9)),T=m(d.slice(0,9)),B=m(u.slice(9)),Y=m(d.slice(9));let le=0,J=0,De=0,nt=0;const Ke=[];u.forEach((oe,xe)=>{const Ye=d[xe];oe>Ye?le++:Ye>oe?J++:De++;const O=oe>Ye?1:Ye>oe?-1:0;nt+=O,Ke.push(nt)});const He=v-E,Ze=He>0?c.name:He<0?l.name:"Draw",ce=He>0?"text-emerald-600":He<0?"text-blue-600":"text-neutral-600",$=150,R=600,U={top:15,bottom:25,left:30,right:15},D=Math.max(...Ke.map(Math.abs),5),A=oe=>{const xe=(oe+D)/(D*2);return $-U.bottom-xe*($-U.top-U.bottom)},W=oe=>U.left+oe*((R-U.left-U.right)/17),Fe=Ke.map((oe,xe)=>`${W(xe)},${A(oe)}`).join(" "),de=A(0);return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-4 mb-4 border-b border-squab-100 pb-4",children:[n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"text-[10px] font-bold text-emerald-600 uppercase tracking-wider block mb-1",children:"Player A"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("select",{className:"w-full p-2 rounded-lg border border-squab-200 bg-white text-sm font-semibold focus:ring-2 focus:ring-emerald-500 outline-none",value:s,onChange:oe=>i(oe.target.value),children:e.map(oe=>n.jsx("option",{value:oe.name,children:oe.name},oe.name))}),n.jsx("div",{className:"text-xl font-bold text-emerald-700 w-12 text-center",children:v})]})]}),n.jsxs("div",{className:"hidden md:flex flex-col items-center px-2 pb-2",children:[n.jsx("span",{className:"text-xs font-bold text-neutral-300",children:"VS"}),n.jsx("span",{className:`text-sm font-bold ${ce} whitespace-nowrap`,children:He===0?"TIED":`${Ze} +${Math.abs(He)}`})]}),n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"text-[10px] font-bold text-blue-600 uppercase tracking-wider block mb-1 text-right md:text-left",children:"Player B"}),n.jsxs("div",{className:"flex items-center gap-2 flex-row-reverse md:flex-row",children:[n.jsx("select",{className:"w-full p-2 rounded-lg border border-squab-200 bg-white text-sm font-semibold focus:ring-2 focus:ring-blue-500 outline-none",value:a,onChange:oe=>o(oe.target.value),children:e.map(oe=>n.jsx("option",{value:oe.name,children:oe.name},oe.name))}),n.jsx("div",{className:"text-xl font-bold text-blue-700 w-12 text-center",children:E})]})]})]}),n.jsx("div",{className:"md:hidden text-center mb-4 -mt-2",children:n.jsx("span",{className:`text-sm font-bold ${ce}`,children:He===0?"TIED":`${Ze} +${Math.abs(He)}`})}),n.jsxs("div",{className:"mb-6 relative h-[150px] w-full bg-squab-50/50 rounded-2xl border border-squab-100",children:[n.jsxs("svg",{viewBox:`0 0 ${R} ${$}`,className:"w-full h-full block",children:[n.jsx("line",{x1:U.left,y1:de,x2:R-U.right,y2:de,stroke:"#cbd5e1",strokeWidth:"1",strokeDasharray:"4 4"}),n.jsx("polyline",{points:Fe,fill:"none",stroke:"#4b5563",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Ke.map((oe,xe)=>n.jsx("circle",{cx:W(xe),cy:A(oe),r:"3",className:oe>0?"fill-emerald-500":oe<0?"fill-blue-500":"fill-neutral-400",stroke:"white",strokeWidth:"1.5"},xe)),n.jsx("text",{x:U.left,y:$-5,className:"text-[9px] fill-neutral-400",textAnchor:"middle",children:"1"}),n.jsx("text",{x:R/2,y:$-5,className:"text-[9px] fill-neutral-400",textAnchor:"middle",children:"9"}),n.jsx("text",{x:R-U.right,y:$-5,className:"text-[9px] fill-neutral-400",textAnchor:"middle",children:"18"})]}),n.jsx("div",{className:"absolute top-1 left-2 text-[9px] font-bold text-emerald-600/50 pointer-events-none",children:"A Leads"}),n.jsx("div",{className:"absolute bottom-6 left-2 text-[9px] font-bold text-blue-600/50 pointer-events-none",children:"B Leads"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"bg-neutral-50 rounded-2xl p-3 border border-neutral-100",children:[n.jsxs("div",{className:"flex justify-between items-center text-xs mb-2 font-semibold text-neutral-500",children:[n.jsx("span",{children:"Match Play"}),n.jsxs("span",{children:[De," halved"]})]}),n.jsxs("div",{className:"w-full bg-white h-2.5 rounded-full overflow-hidden flex shadow-sm",children:[n.jsx("div",{style:{width:`${le/18*100}%`},className:"bg-emerald-400"}),n.jsx("div",{style:{width:`${De/18*100}%`},className:"bg-neutral-200"}),n.jsx("div",{style:{width:`${J/18*100}%`},className:"bg-blue-400"})]}),n.jsxs("div",{className:"flex justify-between text-[10px] mt-1 font-medium",children:[n.jsxs("span",{className:"text-emerald-700",children:[le," won"]}),n.jsxs("span",{className:"text-blue-700",children:[J," won"]})]})]}),n.jsx("div",{className:"bg-white rounded-2xl border border-neutral-100 overflow-hidden",children:n.jsxs("table",{className:"w-full text-xs",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-neutral-50 border-b border-neutral-100 text-neutral-500 uppercase",children:[n.jsx("th",{className:"py-1.5 w-1/3 text-center text-emerald-700",children:c.name.split(" ")[0]}),n.jsx("th",{className:"py-1.5 w-1/3 text-center",children:"Sector"}),n.jsx("th",{className:"py-1.5 w-1/3 text-center text-blue-700",children:l.name.split(" ")[0]})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-50",children:[{l:"Front 9",a:C,b:T},{l:"Back 9",a:B,b:Y},{l:"Par 3s",a:N,b:f}].map((oe,xe)=>n.jsxs("tr",{children:[n.jsx("td",{className:`py-1.5 text-center font-bold ${oe.a>oe.b?"text-emerald-600 bg-emerald-50/30":"text-neutral-600"}`,children:oe.a}),n.jsx("td",{className:"py-1.5 text-center text-neutral-400 font-medium",children:oe.l}),n.jsx("td",{className:`py-1.5 text-center font-bold ${oe.b>oe.a?"text-blue-600 bg-blue-50/30":"text-neutral-600"}`,children:oe.b})]},xe))})]})})]})]})}function wN({computed:e,setView:t}){if(!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to see style analysis."})]});const r=Q.useMemo(()=>gs(e),[e]),s=e.map(p=>{const y=(Array.isArray(p.perHole)?p.perHole:[]).slice(0,r).map(f=>la(f,NaN)),w=y.filter(f=>Number.isFinite(f)&&f===0).length,N=y.filter(f=>Number.isFinite(f)&&f>=3).length;return{name:p.name,wipes:w,fireworks:N,total:p.points}}),i=400,a=600,o={top:40,right:40,bottom:50,left:50},c=a-o.left-o.right,l=i-o.top-o.bottom,u=Math.max(...s.map(p=>p.wipes),5)+1,d=Math.max(...s.map(p=>p.fireworks),4)+1,x=p=>p/u*c,h=p=>l-p/d*l;return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-squab-900",children:"Play Style Matrix"}),n.jsx("p",{className:"text-sm text-neutral-500",children:"Mapping players by Aggression (3+ pts) vs. Errors (0 pts)."})]}),n.jsx("div",{className:"w-full overflow-x-auto",children:n.jsx("div",{className:"min-w-[600px] relative",children:n.jsxs("svg",{viewBox:`0 0 ${a} ${i}`,className:"w-full h-auto bg-neutral-50 rounded-2xl border border-neutral-100",children:[Array.from({length:u+1}).map((p,y)=>n.jsx("line",{x1:o.left+x(y),y1:o.top,x2:o.left+x(y),y2:i-o.bottom,stroke:"#e5e5e5",strokeWidth:"1"},`x-${y}`)),Array.from({length:d+1}).map((p,y)=>n.jsx("line",{x1:o.left,y1:o.top+h(y),x2:a-o.right,y2:o.top+h(y),stroke:"#e5e5e5",strokeWidth:"1"},`y-${y}`)),n.jsx("text",{x:o.left+c*.15,y:o.top+l*.15,className:"text-sm font-bold fill-emerald-100 uppercase tracking-widest select-none",children:"The Gunslinger"}),n.jsx("text",{x:o.left+c*.85,y:o.top+l*.15,className:"text-sm font-bold fill-red-100 uppercase tracking-widest text-right select-none",textAnchor:"end",children:"The Tourist"}),n.jsx("text",{x:o.left+c*.15,y:o.top+l*.9,className:"text-sm font-bold fill-emerald-100 uppercase tracking-widest select-none",children:"The Shark"}),n.jsx("text",{x:o.left+c*.85,y:o.top+l*.9,className:"text-sm font-bold fill-neutral-200 uppercase tracking-widest text-right select-none",textAnchor:"end",children:"The Grinder"}),n.jsx("text",{x:a/2,y:i-10,textAnchor:"middle",className:"text-xs font-bold fill-neutral-500 uppercase tracking-widest",children:"Chaos Factor (Wipes / 0 pts) "}),n.jsx("text",{transform:`rotate(-90 15 ${i/2})`,x:15,y:i/2,textAnchor:"middle",className:"text-xs font-bold fill-neutral-500 uppercase tracking-widest",children:"Fireworks (3+ pts holes) "}),n.jsx("g",{transform:`translate(${o.left}, ${o.top})`,children:s.map(p=>{const y=x(p.wipes),w=h(p.fireworks),N=p.fireworks>=d/2,f=p.wipes>=u/2;let m="#a3a3a3";return!f&&N&&(m="#10b981"),f&&N&&(m="#a855f7"),!f&&!N&&(m="#3b82f6"),f&&!N&&(m="#f97316"),n.jsxs("g",{className:"group cursor-pointer",children:[n.jsx("circle",{cx:y,cy:w,r:6,fill:m,stroke:"white",strokeWidth:"2",className:"transition-all duration-300 group-hover:r-8"}),n.jsxs("text",{x:y,y:w-10,textAnchor:"middle",className:"text-[10px] font-bold fill-neutral-700 opacity-0 group-hover:opacity-100 transition-opacity bg-white",style:{textShadow:"0px 0px 4px white"},children:[p.name," (",p.total,"pts)"]}),(p.fireworks===Math.max(...s.map(v=>v.fireworks))||p.wipes===Math.max(...s.map(v=>v.wipes)))&&n.jsx("text",{x:y,y:w+15,textAnchor:"middle",className:"text-[9px] fill-neutral-400 font-medium pointer-events-none",children:p.name.split(" ")[0]})]},p.name)})})]})})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[n.jsxs("div",{className:"p-3 bg-emerald-50 rounded-2xl border border-emerald-100",children:[n.jsx("div",{className:"text-xs font-bold text-emerald-800 uppercase",children:"The Shark"}),n.jsx("div",{className:"text-[10px] text-emerald-600",children:"High Fireworks, Low Wipes. The zone you want to be in."})]}),n.jsxs("div",{className:"p-3 bg-purple-50 rounded-2xl border border-purple-100",children:[n.jsx("div",{className:"text-xs font-bold text-purple-800 uppercase",children:"The Gunslinger"}),n.jsx("div",{className:"text-[10px] text-purple-600",children:"High Fireworks, High Wipes. Volatile, exciting, dangerous."})]}),n.jsxs("div",{className:"p-3 bg-blue-50 rounded-2xl border border-blue-100",children:[n.jsx("div",{className:"text-xs font-bold text-blue-800 uppercase",children:"The Grinder"}),n.jsx("div",{className:"text-[10px] text-blue-600",children:"Low Fireworks, Low Wipes. Boring golf, often places in the money."})]}),n.jsxs("div",{className:"p-3 bg-orange-50 rounded-2xl border border-orange-100",children:[n.jsx("div",{className:"text-xs font-bold text-orange-800 uppercase",children:"The Tourist"}),n.jsx("div",{className:"text-[10px] text-orange-600",children:"Low Fireworks, High Wipes. Just here for the banter."})]})]})]})}function NN({computed:e,setView:t}){if(!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to see the story."})]});const r=Q.useMemo(()=>gs(e),[e]),s=Array.from({length:r}).map((f,m)=>{let v=-1,E=[];return e.forEach(C=>{const T=la(C.perHole[m],NaN);Number.isFinite(T)&&(T>v?(v=T,E=[C.name.split(" ")[0]]):T===v&&E.push(C.name.split(" ")[0]))}),{hole:m+1,bestPts:v,contributors:E}}),i=s.reduce((f,m)=>f+m.bestPts,0),o=e.slice(0,5).map((f,m)=>{let v=0;const E=(Array.isArray(f.perHole)?f.perHole:[]).slice(0,r).map(T=>(v+=la(T,0)||0,v)),C=["#10b981","#3b82f6","#f59e0b","#8b5cf6","#ec4899"];return{name:f.name,points:E,color:C[m%C.length]}}),c=300,l=800,u={top:20,right:80,bottom:30,left:30},d=l-u.left-u.right,x=c-u.top-u.bottom,h=Math.max(...o.map(f=>f.points[r-1]??0)),p=Math.max(1,h),y=Math.max(1,r-1),w=f=>f/y*d,N=f=>x-f/p*x;return n.jsxs("section",{className:"rounded-2xl p-4 md:p-6 bg-white border border-squab-200 shadow-sm space-y-8",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-squab-900 mb-1",children:"The Race for the Title"}),n.jsx("p",{className:"text-sm text-neutral-500 mb-4",children:"Cumulative progress of the Top 5 finishers. See where the lead changed."}),n.jsx("div",{className:"w-full overflow-x-auto",children:n.jsx("div",{className:"min-w-[600px] relative",children:n.jsxs("svg",{viewBox:`0 0 ${l} ${c}`,className:"w-full h-auto bg-white rounded-2xl border border-squab-100",children:[[0,.25,.5,.75,1].map(f=>{const m=Math.round(p*f),v=N(m)+u.top;return n.jsxs("g",{children:[n.jsx("line",{x1:u.left,y1:v,x2:l-u.right,y2:v,stroke:"#f3f4f6"}),n.jsx("text",{x:u.left-5,y:v+3,textAnchor:"end",className:"text-[10px] fill-neutral-400",children:m})]},f)}),Array.from({length:r}).map((f,m)=>n.jsx("text",{x:u.left+w(m),y:c-10,textAnchor:"middle",className:"text-[10px] fill-neutral-400",children:m+1},m)),o.map((f,m)=>{const v=f.points.map((E,C)=>`${C===0?"M":"L"} ${u.left+w(C)} ${u.top+N(E)}`).join(" ");return n.jsxs("g",{children:[n.jsx("path",{d:v,fill:"none",stroke:f.color,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-90 hover:opacity-100 hover:stroke-[4]"}),n.jsx("text",{x:u.left+w(r-1)+5,y:u.top+N(f.points[r-1]??0)+3,className:"text-[10px] font-bold",fill:f.color,children:f.name.split(" ")[0]})]},f.name)})]})})})]}),n.jsx("div",{className:"border-t border-squab-100"}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-end mb-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-squab-900 mb-1",children:'The "Perfect" Round'}),n.jsx("p",{className:"text-sm text-neutral-500",children:"Best score recorded on every hole combined."})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-xs text-neutral-500 uppercase tracking-wide",children:"Potential Total"}),n.jsxs("div",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-emerald-500 to-teal-600",children:[i," pts"]})]})]}),n.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 md:grid-cols-9 gap-2",children:s.map(f=>n.jsxs("div",{className:`p-2 rounded-lg border flex flex-col items-center justify-between h-20 ${f.bestPts>=4?"bg-purple-50 border-purple-200":"bg-white border-squab-100"}`,children:[n.jsxs("div",{className:"text-[10px] text-neutral-400 font-bold",children:["Hole ",f.hole]}),n.jsxs("div",{className:`text-xl font-bold ${f.bestPts>=4?"text-purple-600":"text-emerald-600"}`,children:[f.bestPts," ",n.jsx("span",{className:"text-[10px] text-neutral-400 font-normal",children:"pts"})]}),n.jsx("div",{className:"text-[9px] text-neutral-600 truncate w-full text-center",title:f.contributors.join(", "),children:f.contributors.length>1?`${f.contributors.length} players`:f.contributors[0]})]},f.hole))})]})]})}function jN({computed:e,courseTees:t,setView:r}){if(!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to open the casino."})]});const s=Q.useMemo(()=>gs(e),[e]),i=[];for(let c=0;c<s;c++){let l=-1,u=[];e.forEach(d=>{const x=la(d.perHole[c],NaN);Number.isFinite(x)&&(x>l?(l=x,u=[d.name]):x===l&&u.push(d.name))}),u.length===1&&l>0&&i.push({hole:c+1,points:l,winner:u[0]})}const a=[];e.forEach(c=>{const l=en(c,t);if(!l)return;const u=l.pars||[],d=l.si||[],x=Math.round(c.startExact??c.handicap??0);c.perHole.forEach((h,p)=>{const y=Number(h)||0,w=d[p]||0;let N=0;if(w>0&&x>0){const m=Math.floor(x/18),v=x%18;N=m+(v>=w?1:0)}const f=u[p];f&&f+N+2-y===2&&a.push({name:c.name,hole:p+1})})});const o={};return i.forEach(c=>{o[c.winner]||(o[c.winner]=[]),o[c.winner].push(c)}),n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"mb-8 text-center",children:[n.jsx("h2",{className:"text-3xl font-black text-squab-900 uppercase tracking-widest drop-shadow-sm",children:" The Casino"}),n.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:"Net Skins & The 2s Club"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between border-b border-squab-100 pb-2 mb-4",children:[n.jsx("h3",{className:"font-bold text-xl text-squab-900",children:" Net Skins"}),n.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-800 border border-emerald-200 px-2 py-1 rounded",children:"Unique High Score Wins"})]}),Object.keys(o).length===0?n.jsx("div",{className:"text-center py-8 text-neutral-400 italic",children:"No skins won. Everyone tied!"}):n.jsx("div",{className:"space-y-3",children:Object.entries(o).sort((c,l)=>l[1].length-c[1].length).map(([c,l])=>n.jsxs("div",{className:"bg-emerald-50 rounded-2xl p-3 flex justify-between items-center border border-emerald-100",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"bg-white border border-emerald-200 text-emerald-800 font-bold w-8 h-8 rounded-full flex items-center justify-center shadow-sm",children:l.length}),n.jsx("span",{className:"font-semibold text-emerald-900",children:c})]}),n.jsx("div",{className:"flex gap-1 flex-wrap justify-end",children:l.map(u=>n.jsxs("span",{className:"text-xs bg-white border border-emerald-200 px-2 py-1 rounded text-emerald-800 font-mono",children:["H",u.hole," (",u.points,"pts)"]},u.hole))})]},c))})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between border-b border-squab-100 pb-2 mb-4",children:[n.jsx("h3",{className:"font-bold text-xl text-squab-900",children:" The 2s Club"}),n.jsx("span",{className:"text-xs bg-purple-100 text-purple-800 border border-purple-200 px-2 py-1 rounded",children:"Gross Score of 2"})]}),a.length===0?n.jsx("div",{className:"text-center py-8 text-neutral-400 italic",children:"No 2s recorded today."}):n.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.map((c,l)=>n.jsxs("div",{className:"bg-purple-50 p-3 rounded-2xl border border-purple-100 flex justify-between items-center shadow-sm",children:[n.jsx("span",{className:"font-semibold text-purple-900 text-sm",children:c.name}),n.jsxs("span",{className:"font-bold text-purple-600 font-mono",children:["Hole ",c.hole]})]},l))}),a.length>0&&n.jsxs("div",{className:"mt-4 p-3 bg-neutral-50 rounded-lg text-center border border-neutral-100",children:[n.jsx("div",{className:"text-xs text-neutral-500 uppercase tracking-widest",children:"Total Pot Shares"}),n.jsx("div",{className:"text-2xl font-bold text-squab-900",children:a.length})]})]})]})]})}function _N({computed:e,courseTees:t,setView:r}){if(!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to award trophies."})]});const s=Q.useMemo(()=>gs(e),[e]),i=s,c=((t.find(u=>u.gender==="M")||t[0]||{}).si||[]).findIndex(u=>u===1),l=e.map(u=>{const x=(Array.isArray(u.perHole)?u.perHole:[]).map(f=>la(f,NaN)).slice(0,s).map(f=>Number.isFinite(f)?f:0),h=[];x.includes(0)||h.push({icon:"",title:"Clean Sheet",desc:"Zero wipes (0 pts) all round."}),x.some(f=>f>=4)&&h.push({icon:"",title:"The Bandit",desc:"Scored a Net Eagle (4+ pts)."});let p=0,y=0;x.forEach(f=>{f>=3?y++:(p=Math.max(p,y),y=0)}),p=Math.max(p,y),p>=3&&h.push({icon:"",title:"He's on Fire",desc:"3+ points on 3 consecutive holes."});const w=x.slice(0,9).reduce((f,m)=>f+m,0),N=x.slice(9).reduce((f,m)=>f+m,0);return w<12&&N>=17&&h.push({icon:"",title:"Slow Starter",desc:"Woke up on the Back 9."}),c!==-1&&x[c]>=2&&h.push({icon:"",title:"The Sniper",desc:"Conquered the Stroke Index 1 hole."}),x[i-1]>=3&&h.push({icon:"",title:"Clutch Finish",desc:"Big points on the finishing hole."}),{name:u.name,badges:h}}).filter(u=>u.badges.length>0).sort((u,d)=>d.badges.length-u.badges.length);return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Et,{setView:r,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"mb-6 text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-squab-900",children:" The Trophy Room"}),n.jsx("p",{className:"text-sm text-neutral-500",children:"Honoring the heroes, the bandits, and the survivors."})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.map(u=>n.jsxs("div",{className:"border border-squab-100 rounded-2xl p-4 bg-neutral-50 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-neutral-200 pb-2",children:[n.jsx("h3",{className:"font-bold text-neutral-800",children:u.name}),n.jsxs("span",{className:"text-xs font-semibold bg-squab-100 text-squab-800 px-2 py-0.5 rounded-full",children:[u.badges.length," Award",u.badges.length!==1?"s":""]})]}),n.jsx("div",{className:"space-y-2",children:u.badges.map((d,x)=>n.jsxs("div",{className:"flex items-start gap-3 bg-white p-2 rounded-lg border border-neutral-100",children:[n.jsx("div",{className:"text-2xl",children:d.icon}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-bold text-neutral-900",children:d.title}),n.jsx("div",{className:"text-[10px] text-neutral-500 leading-tight",children:d.desc})]})]},x))})]},u.name)),l.length===0&&n.jsx("div",{className:"col-span-full text-center py-10 text-neutral-400 italic",children:"No distinct achievements earned this round. Tough crowd."})]})]})}function SN({computed:e,setView:t}){const[r,s]=Q.useState("");if(Q.useEffect(()=>{e.length&&!r&&s(e[0].name)},[e,r]),!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to find your partner."})]});const i=Q.useMemo(()=>gs(e),[e]),a=e.find(u=>u.name===r)||e[0],o=a.perHole.map(u=>Number(u)||0),c=e.filter(u=>u.name!==r).map(u=>{const d=u.perHole.map(y=>Number(y)||0);let x=0,h=0;for(let y=0;y<i;y++){const w=o[y],N=d[y];x+=Math.max(w,N),w===0&&N>=2&&h++}const p=x-a.points;return{name:u.name,total:x,synergy:p,coveredWipes:h,points:u.points}}).sort((u,d)=>d.total-u.total),l=c[0];return n.jsxs("section",{className:"content-card p-4 md:p-6",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"mb-6 border-b border-squab-100 pb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-squab-900 mb-2",children:" The Partner Simulator"}),n.jsx("p",{className:"text-sm text-neutral-500 mb-4",children:'Who complements your game? We calculated the "Better Ball" score for every possible partnership.'}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 bg-squab-50 p-4 rounded-2xl border border-squab-100",children:[n.jsxs("div",{className:"flex flex-col w-full sm:w-auto",children:[n.jsx("label",{className:"text-[10px] uppercase font-bold text-squab-600 mb-1",children:"Select Player"}),n.jsx("select",{className:"p-2 rounded-lg border border-squab-200 bg-white font-semibold text-squab-900 focus:ring-2 focus:ring-emerald-500 outline-none",value:r,onChange:u=>{const d=u.target.value;s(d),window.umami&&window.umami.track("Check Partner",{player:d})},children:e.map(u=>n.jsx("option",{value:u.name,children:u.name},u.name))})]}),n.jsx("div",{className:"hidden sm:block text-2xl text-squab-300",children:""}),n.jsxs("div",{className:"flex-1 w-full",children:[n.jsx("div",{className:"text-xs text-squab-600 font-bold uppercase mb-1",children:"Best Match"}),l?n.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg border border-squab-200 shadow-sm",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-lg text-emerald-700",children:l.name}),n.jsxs("div",{className:"text-[10px] text-neutral-500",children:["Saved you on ",l.coveredWipes," holes"]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-2xl font-black text-squab-600",children:l.total}),n.jsx("div",{className:"text-[10px] font-bold text-emerald-500 uppercase tracking-wide",children:"Combined Pts"})]})]}):n.jsx("div",{className:"text-sm text-neutral-400",children:"Not enough players"})]})]})]}),n.jsxs("div",{className:"overflow-hidden rounded-2xl border border-neutral-200",children:[n.jsxs("table",{className:"w-full text-sm text-left",children:[n.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200 text-neutral-500",children:n.jsxs("tr",{children:[n.jsx("th",{className:"p-3 font-semibold",children:"Partner"}),n.jsx("th",{className:"p-3 font-semibold",children:"Their Score"}),n.jsx("th",{className:"p-3 font-semibold text-center",children:"Synergy"}),n.jsx("th",{className:"p-3 font-semibold text-right",children:"Team Total"})]})}),n.jsx("tbody",{className:"divide-y divide-neutral-100",children:c.slice(0,10).map((u,d)=>n.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[n.jsxs("td",{className:"p-3 font-medium text-neutral-800",children:[d===0?" ":d===1?" ":d===2?" ":"",u.name]}),n.jsx("td",{className:"p-3 text-neutral-500",children:u.points}),n.jsx("td",{className:"p-3 text-center",children:n.jsxs("span",{className:"inline-block px-2 py-1 bg-emerald-100 text-emerald-700 text-xs font-bold rounded-md",children:["+",u.synergy," pts"]})}),n.jsx("td",{className:"p-3 text-right font-bold text-lg text-squab-700",children:u.total})]},u.name))})]}),n.jsx("div",{className:"bg-neutral-50 p-2 text-center text-[10px] text-neutral-400",children:"Showing Top 10 potential partners"})]})]})}function kN({computed:e,setView:t}){var p,y;const[r,s]=Q.useState(0),[i,a]=Q.useState(!1),[o,c]=Q.useState(800),l=Q.useMemo(()=>gs(e),[e]),u=Q.useMemo(()=>{if(!e.length)return[];const w=[];w.push(e.map(N=>({name:N.name,total:0,lastHolePts:0,color:"#e5e7eb"})));for(let N=0;N<l;N++){const m=w[N].map(v=>{const E=e.find(Y=>Y.name===v.name),C=Number(E.perHole[N])||0,T=v.total+C;let B="#94a3b8";return C>=3&&(B="#10b981"),C===0&&(B="#ef4444"),{name:v.name,total:T,lastHolePts:C,color:B}});m.sort((v,E)=>E.total-v.total),w.push(m)}return w},[e]);if(Q.useEffect(()=>{let w=null;return i&&r<l?w=setInterval(()=>{s(N=>N>=l?(a(!1),l):N+1)},o):r===l&&a(!1),()=>clearInterval(w)},[i,r,o]),!e.length)return n.jsxs("section",{className:"rounded-2xl p-4 bg-white border border-squab-200 shadow-sm",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsx("p",{className:"text-neutral-600",children:"Load an event to watch the replay."})]});const d=u[r]||[],x=d.slice(0,10),h=Math.max(...d.map(w=>w.total),10);return n.jsxs("section",{className:"rounded-2xl p-4 md:p-6 bg-white border border-squab-200 shadow-sm transition-all",children:[n.jsx(Et,{setView:t,hasEvent:!!(e&&e.length)}),n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between mb-6 border-b border-squab-100 pb-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-squab-900",children:" The Replay Room"}),n.jsx("p",{className:"text-sm text-neutral-500",children:"Watch the round unfold hole-by-hole."})]}),n.jsxs("div",{className:"flex items-center gap-2 bg-neutral-50 p-2 rounded-2xl border border-neutral-200",children:[n.jsx("button",{onClick:()=>{s(0),a(!0)},className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white text-neutral-700 border border-neutral-300 font-bold hover:bg-neutral-50 transition-colors",title:"Restart & Play",children:""}),n.jsx("button",{onClick:()=>a(!i),className:"w-24 h-10 flex items-center justify-center rounded-lg bg-neutral-900 text-white font-bold hover:bg-neutral-800 transition-colors shadow-sm",children:i?"PAUSE":r===l?"DONE":"PLAY "}),n.jsxs("div",{className:"flex flex-col px-2",children:[n.jsx("label",{className:"text-[9px] font-bold text-neutral-600 uppercase",children:"Speed"}),n.jsx("input",{type:"range",min:"100",max:"1500",step:"100",className:"w-20 accent-neutral-900 h-1.5 bg-neutral-200 rounded-lg appearance-none cursor-pointer",value:1600-o,onChange:w=>c(1600-Number(w.target.value))})]})]})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"flex justify-between items-end mb-2 px-1",children:[n.jsx("div",{className:"text-4xl font-black text-neutral-900",children:r===0?"START":`HOLE ${r}`}),r>0&&r<l&&n.jsx("div",{className:"animate-pulse text-xs font-bold text-emerald-600 uppercase tracking-widest",children:" Live Updates"})]}),n.jsx("div",{className:"w-full bg-neutral-100 h-2 rounded-full mb-6 overflow-hidden",children:n.jsx("div",{className:"bg-neutral-900 h-full transition-all duration-300 ease-linear",style:{width:`${r/l*100}%`}})}),n.jsx("div",{className:"space-y-2 min-h-[400px]",children:x.map((w,N)=>n.jsxs("div",{className:"relative flex items-center gap-3 transition-all duration-500 ease-in-out",style:{transform:"translateY(0px)"},children:[n.jsx("div",{className:"w-6 text-right text-xs font-bold text-neutral-400 font-mono",children:N+1}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"text-xs font-bold text-squab-900 truncate w-32",children:w.name}),r>0&&w.lastHolePts>=3&&n.jsx("span",{className:"text-[9px] bg-emerald-100 text-emerald-700 px-1 rounded animate-bounce",children:" 3pts"}),r>0&&w.lastHolePts===0&&n.jsx("span",{className:"text-[9px] bg-red-100 text-red-700 px-1 rounded",children:" Wipe"})]}),n.jsx("div",{className:"relative h-8 bg-neutral-50 rounded-r-lg w-full",children:n.jsx("div",{className:"h-full rounded-r-lg flex items-center justify-end px-2 text-white text-xs font-bold shadow-sm transition-all duration-700 ease-out",style:{width:`${Math.max(w.total/h*100,2)}%`,backgroundColor:r===0?"#cbd5e1":w.color},children:w.total})})]})]},w.name))}),r===l&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 backdrop-blur-sm z-10 rounded-2xl",children:n.jsxs("div",{className:"bg-white border-2 border-emerald-500 p-8 rounded-2xl shadow-2xl text-center transform scale-110",children:[n.jsx("div",{className:"text-6xl mb-2",children:""}),n.jsx("div",{className:"text-sm font-bold text-neutral-400 uppercase tracking-widest",children:"Winner"}),n.jsx("div",{className:"text-3xl font-black text-squab-900",children:(p=x[0])==null?void 0:p.name}),n.jsxs("div",{className:"text-xl font-bold text-squab-600",children:[(y=x[0])==null?void 0:y.total," Points"]}),n.jsx("button",{onClick:()=>{s(0),a(!0)},className:"mt-4 text-xs underline text-neutral-500 hover:text-squab-600",children:"Replay"})]})})]})]})}function pm(e,t=2){const r=e==null||e===""?NaN:Number(e);if(!Number.isFinite(r))return"";const s=Number.isFinite(t)?Math.max(0,Math.min(6,t)):2;let i;try{i=new Intl.NumberFormat(void 0,{minimumFractionDigits:s,maximumFractionDigits:s}).format(r)}catch{i=r.toFixed(s)}return r>0?`+${i}`:i}cu.createRoot(document.getElementById("root")).render(n.jsx(ue.StrictMode,{children:n.jsx(Gb,{basename:"/golf/",children:n.jsx(bN,{})})}));
